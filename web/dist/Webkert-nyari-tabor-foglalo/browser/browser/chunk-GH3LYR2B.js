import{b as Oa,l as $d}from"./chunk-BN2YJQL2.js";import{D as Md,Da as ns,Ea as tn,Ec as Je,Fa as Ye,Fb as ka,Fc as rn,Ia as Pa,Ka as nn,Pa as Ud,Wb as is,a as he,b as Ee,c as Dt,ca as Br,d as g,da as kt,ea as On,fa as Xi,g as en,ha as Ve,j as Nd,ja as Zi,ka as Qe,kb as Da,l as Vd,la as Fe,lb as Q,m as Od,na as xn,nc as Nt,o as Aa,p as ba,pa as Fd,q as Ca,qa as es,r as Sa,ra as Ld,sa as ts,tb as rs,tc as Na,ub as Pe,uc as qd,wb as Le,x as xd,xa as Ra,yc as Va,za as dt,zb as Bd}from"./chunk-4Y4LFOUG.js";var jd=()=>{};var Wd=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Sy=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],a=n[t++],u=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{let s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},ss={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],a=i+1<n.length,u=a?n[i+1]:0,l=i+2<n.length,d=l?n[i+2]:0,p=s>>2,v=(s&3)<<4|u>>4,I=(u&15)<<2|d>>6,S=d&63;l||(S=64,a||(I=64)),r.push(t[p],t[v],t[I],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Wd(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Sy(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let v=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||u==null||d==null||v==null)throw new Ma;let I=s<<2|u>>4;if(r.push(I),d!==64){let S=u<<4&240|d>>2;if(r.push(S),v!==64){let D=d<<6&192|v;r.push(D)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Ma=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},Ry=function(n){let e=Wd(n);return ss.encodeByteArray(e,!0)},$r=function(n){return Ry(n).replace(/\./g,"")},os=function(n){try{return ss.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function La(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var Py=()=>La().__FIREBASE_DEFAULTS__,Dy=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},ky=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&os(n[1]);return e&&JSON.parse(e)},as=()=>{try{return jd()||Py()||Dy()||ky()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Ua=n=>{var e,t;return(t=(e=as())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Hd=n=>{let e=Ua(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Ba=()=>{var n;return(n=as())===null||n===void 0?void 0:n.config},qa=n=>{var e;return(e=as())===null||e===void 0?void 0:e[`_${n}`]};var sn=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function on(n){return n.endsWith(".cloudworkstations.dev")}function cs(n){return g(this,null,function*(){return(yield fetch(n,{credentials:"include"})).ok})}function Kd(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[$r(JSON.stringify(t)),$r(JSON.stringify(a)),""].join(".")}var qr={};function Ny(){let n={prod:[],emulator:[]};for(let e of Object.keys(qr))qr[e]?n.emulator.push(e):n.prod.push(e);return n}function Vy(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var zd=!1;function Mn(n,e){if(typeof window>"u"||typeof document>"u"||!on(window.location.host)||qr[n]===e||qr[n]||zd)return;qr[n]=e;function t(I){return`__firebase__banner__${I}`}let r="__firebase__banner",s=Ny().prod.length>0;function a(){let I=document.getElementById(r);I&&I.remove()}function u(I){I.style.display="flex",I.style.background="#7faaf0",I.style.position="fixed",I.style.bottom="5px",I.style.left="5px",I.style.padding=".5em",I.style.borderRadius="5px",I.style.alignItems="center"}function l(I,S){I.setAttribute("width","24"),I.setAttribute("id",S),I.setAttribute("height","24"),I.setAttribute("viewBox","0 0 24 24"),I.setAttribute("fill","none"),I.style.marginLeft="-6px"}function d(){let I=document.createElement("span");return I.style.cursor="pointer",I.style.marginLeft="16px",I.style.fontSize="24px",I.innerHTML=" &times;",I.onclick=()=>{zd=!0,a()},I}function p(I,S){I.setAttribute("id",S),I.innerText="Learn more",I.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",I.setAttribute("target","__blank"),I.style.paddingLeft="5px",I.style.textDecoration="underline"}function v(){let I=Vy(r),S=t("text"),D=document.getElementById(S)||document.createElement("span"),x=t("learnmore"),k=document.getElementById(x)||document.createElement("a"),z=t("preprendIcon"),U=document.getElementById(z)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(I.created){let $=I.element;u($),p(k,x);let X=d();l(U,z),$.append(U,D,k,X),document.body.appendChild($)}s?(D.innerText="Preview backend disconnected.",U.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(U.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,D.innerText="Preview backend running in this workspace."),D.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function de(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Qd(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(de())}function Oy(){var n;let e=(n=as())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Yd(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Jd(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Xd(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Zd(){let n=de();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function ef(){return!Oy()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function jr(){try{return typeof indexedDB=="object"}catch{return!1}}function tf(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var xy="FirebaseError",Oe=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=xy,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$e.prototype.create)}},$e=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?My(s,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new Oe(i,u,r)}};function My(n,e){return n.replace(Fy,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var Fy=/\{\$([^}]+)}/g;function nf(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Xe(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],a=e[i];if(Gd(s)&&Gd(a)){if(!Xe(s,a))return!1}else if(s!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function Gd(n){return n!==null&&typeof n=="object"}function zr(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Fn(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Ln(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function rf(n,e){let t=new Fa(n,e);return t.subscribe.bind(t)}var Fa=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Ly(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=xa),i.error===void 0&&(i.error=xa),i.complete===void 0&&(i.complete=xa);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Ly(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function xa(){}var Gb=4*60*60*1e3;function ae(n){return n&&n._delegate?n._delegate:n}var Se=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var an="[DEFAULT]";var $a=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new sn;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(By(e))try{this.getOrInitializeService({instanceIdentifier:an})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=an){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return g(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=an){return this.instances.has(e)}getOptions(e=an){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(s);r===u&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Uy(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=an){return this.component?this.component.multipleInstances?e:an:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Uy(n){return n===an?void 0:n}function By(n){return n.instantiationMode==="EAGER"}var us=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new $a(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var qy=[],G=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(G||{}),$y={debug:G.DEBUG,verbose:G.VERBOSE,info:G.INFO,warn:G.WARN,error:G.ERROR,silent:G.SILENT},jy=G.INFO,zy={[G.DEBUG]:"log",[G.VERBOSE]:"log",[G.INFO]:"info",[G.WARN]:"warn",[G.ERROR]:"error"},Gy=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=zy[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Ze=class{constructor(e){this.name=e,this._logLevel=jy,this._logHandler=Gy,this._userLogHandler=null,qy.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in G))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?$y[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,G.DEBUG,...e),this._logHandler(this,G.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,G.VERBOSE,...e),this._logHandler(this,G.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,G.INFO,...e),this._logHandler(this,G.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,G.WARN,...e),this._logHandler(this,G.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,G.ERROR,...e),this._logHandler(this,G.ERROR,...e)}};var Wy=(n,e)=>e.some(t=>n instanceof t),sf,of;function Hy(){return sf||(sf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ky(){return of||(of=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var af=new WeakMap,za=new WeakMap,cf=new WeakMap,ja=new WeakMap,Wa=new WeakMap;function Qy(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(et(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&af.set(t,n)}).catch(()=>{}),Wa.set(e,n),e}function Yy(n){if(za.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});za.set(n,e)}var Ga={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return za.get(n);if(e==="objectStoreNames")return n.objectStoreNames||cf.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return et(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function uf(n){Ga=n(Ga)}function Jy(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(ls(this),e,...t);return cf.set(r,e.sort?e.sort():[e]),et(r)}:Ky().includes(n)?function(...e){return n.apply(ls(this),e),et(af.get(this))}:function(...e){return et(n.apply(ls(this),e))}}function Xy(n){return typeof n=="function"?Jy(n):(n instanceof IDBTransaction&&Yy(n),Wy(n,Hy())?new Proxy(n,Ga):n)}function et(n){if(n instanceof IDBRequest)return Qy(n);if(ja.has(n))return ja.get(n);let e=Xy(n);return e!==n&&(ja.set(n,e),Wa.set(e,n)),e}var ls=n=>Wa.get(n);function hf(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let a=indexedDB.open(n,e),u=et(a);return r&&a.addEventListener("upgradeneeded",l=>{r(et(a.result),l.oldVersion,l.newVersion,et(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),u.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var Zy=["get","getKey","getAll","getAllKeys","count"],ev=["put","add","delete","clear"],Ha=new Map;function lf(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ha.get(e))return Ha.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=ev.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Zy.includes(t)))return;let s=function(a,...u){return g(this,null,function*(){let l=this.transaction(a,i?"readwrite":"readonly"),d=l.store;return r&&(d=d.index(u.shift())),(yield Promise.all([d[t](...u),i&&l.done]))[0]})};return Ha.set(e,s),s}uf(n=>Ee(he({},n),{get:(e,t,r)=>lf(e,t)||n.get(e,t,r),has:(e,t)=>!!lf(e,t)||n.has(e,t)}));var Qa=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(tv(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function tv(n){let e=n.getComponent();return e?.type==="VERSION"}var Ya="@firebase/app",df="0.12.3";var ft=new Ze("@firebase/app"),nv="@firebase/app-compat",rv="@firebase/analytics-compat",iv="@firebase/analytics",sv="@firebase/app-check-compat",ov="@firebase/app-check",av="@firebase/auth",cv="@firebase/auth-compat",uv="@firebase/database",lv="@firebase/data-connect",hv="@firebase/database-compat",dv="@firebase/functions",fv="@firebase/functions-compat",pv="@firebase/installations",mv="@firebase/installations-compat",gv="@firebase/messaging",_v="@firebase/messaging-compat",yv="@firebase/performance",vv="@firebase/performance-compat",Iv="@firebase/remote-config",Ev="@firebase/remote-config-compat",wv="@firebase/storage",Tv="@firebase/storage-compat",Av="@firebase/firestore",bv="@firebase/vertexai",Cv="@firebase/firestore-compat",Sv="firebase",Rv="11.7.3";var Ja="[DEFAULT]",Pv={[Ya]:"fire-core",[nv]:"fire-core-compat",[iv]:"fire-analytics",[rv]:"fire-analytics-compat",[ov]:"fire-app-check",[sv]:"fire-app-check-compat",[av]:"fire-auth",[cv]:"fire-auth-compat",[uv]:"fire-rtdb",[lv]:"fire-data-connect",[hv]:"fire-rtdb-compat",[dv]:"fire-fn",[fv]:"fire-fn-compat",[pv]:"fire-iid",[mv]:"fire-iid-compat",[gv]:"fire-fcm",[_v]:"fire-fcm-compat",[yv]:"fire-perf",[vv]:"fire-perf-compat",[Iv]:"fire-rc",[Ev]:"fire-rc-compat",[wv]:"fire-gcs",[Tv]:"fire-gcs-compat",[Av]:"fire-fst",[Cv]:"fire-fst-compat",[bv]:"fire-vertex","fire-js":"fire-js",[Sv]:"fire-js-all"};var Gr=new Map,Dv=new Map,Xa=new Map;function ff(n,e){try{n.container.addComponent(e)}catch(t){ft.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function je(n){let e=n.name;if(Xa.has(e))return ft.debug(`There were multiple attempts to register component ${e}.`),!1;Xa.set(e,n);for(let t of Gr.values())ff(t,n);for(let t of Dv.values())ff(t,n);return!0}function Un(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function De(n){return n==null?!1:n.settings!==void 0}var kv={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Vt=new $e("app","Firebase",kv);var Za=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Se("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Vt.create("app-deleted",{appName:this._name})}};var Ot=Rv;function nc(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Ja,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Vt.create("bad-app-name",{appName:String(i)});if(t||(t=Ba()),!t)throw Vt.create("no-options");let s=Gr.get(i);if(s){if(Xe(t,s.options)&&Xe(r,s.config))return s;throw Vt.create("duplicate-app",{appName:i})}let a=new us(i);for(let l of Xa.values())a.addComponent(l);let u=new Za(t,r,a);return Gr.set(i,u),u}function cn(n=Ja){let e=Gr.get(n);if(!e&&n===Ja&&Ba())return nc();if(!e)throw Vt.create("no-app",{appName:n});return e}function hs(){return Array.from(Gr.values())}function ie(n,e,t){var r;let i=(r=Pv[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){let u=[`Unable to register library "${i}" with version "${e}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ft.warn(u.join(" "));return}je(new Se(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var Nv="firebase-heartbeat-database",Vv=1,Wr="firebase-heartbeat-store",Ka=null;function _f(){return Ka||(Ka=hf(Nv,Vv,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Wr)}catch(t){console.warn(t)}}}}).catch(n=>{throw Vt.create("idb-open",{originalErrorMessage:n.message})})),Ka}function Ov(n){return g(this,null,function*(){try{let t=(yield _f()).transaction(Wr),r=yield t.objectStore(Wr).get(yf(n));return yield t.done,r}catch(e){if(e instanceof Oe)ft.warn(e.message);else{let t=Vt.create("idb-get",{originalErrorMessage:e?.message});ft.warn(t.message)}}})}function pf(n,e){return g(this,null,function*(){try{let r=(yield _f()).transaction(Wr,"readwrite");yield r.objectStore(Wr).put(e,yf(n)),yield r.done}catch(t){if(t instanceof Oe)ft.warn(t.message);else{let r=Vt.create("idb-set",{originalErrorMessage:t?.message});ft.warn(r.message)}}})}function yf(n){return`${n.name}!${n.options.appId}`}var xv=1024,Mv=30,ec=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new tc(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return g(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=mf();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>Mv){let a=Lv(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ft.warn(r)}})}getHeartbeatsHeader(){return g(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=mf(),{heartbeatsToSend:r,unsentEntries:i}=Fv(this._heartbeatsCache.heartbeats),s=$r(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return ft.warn(t),""}})}};function mf(){return new Date().toISOString().substring(0,10)}function Fv(n,e=xv){let t=[],r=n.slice();for(let i of n){let s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),gf(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),gf(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var tc=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return g(this,null,function*(){return jr()?tf().then(()=>!0).catch(()=>!1):!1})}read(){return g(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield Ov(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return pf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return pf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function gf(n){return $r(JSON.stringify({version:2,heartbeats:n})).length}function Lv(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function Uv(n){je(new Se("platform-logger",e=>new Qa(e),"PRIVATE")),je(new Se("heartbeat",e=>new ec(e),"PRIVATE")),ie(Ya,df,n),ie(Ya,df,"esm2017"),ie("fire-js","")}Uv("");var vf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},If={};var pt,rc;(function(){var n;function e(w,m){function y(){}y.prototype=m.prototype,w.D=m.prototype,w.prototype=new y,w.prototype.constructor=w,w.C=function(E,T,b){for(var _=Array(arguments.length-2),ut=2;ut<arguments.length;ut++)_[ut-2]=arguments[ut];return m.prototype[T].apply(E,_)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,m,y){y||(y=0);var E=Array(16);if(typeof m=="string")for(var T=0;16>T;++T)E[T]=m.charCodeAt(y++)|m.charCodeAt(y++)<<8|m.charCodeAt(y++)<<16|m.charCodeAt(y++)<<24;else for(T=0;16>T;++T)E[T]=m[y++]|m[y++]<<8|m[y++]<<16|m[y++]<<24;m=w.g[0],y=w.g[1],T=w.g[2];var b=w.g[3],_=m+(b^y&(T^b))+E[0]+3614090360&4294967295;m=y+(_<<7&4294967295|_>>>25),_=b+(T^m&(y^T))+E[1]+3905402710&4294967295,b=m+(_<<12&4294967295|_>>>20),_=T+(y^b&(m^y))+E[2]+606105819&4294967295,T=b+(_<<17&4294967295|_>>>15),_=y+(m^T&(b^m))+E[3]+3250441966&4294967295,y=T+(_<<22&4294967295|_>>>10),_=m+(b^y&(T^b))+E[4]+4118548399&4294967295,m=y+(_<<7&4294967295|_>>>25),_=b+(T^m&(y^T))+E[5]+1200080426&4294967295,b=m+(_<<12&4294967295|_>>>20),_=T+(y^b&(m^y))+E[6]+2821735955&4294967295,T=b+(_<<17&4294967295|_>>>15),_=y+(m^T&(b^m))+E[7]+4249261313&4294967295,y=T+(_<<22&4294967295|_>>>10),_=m+(b^y&(T^b))+E[8]+1770035416&4294967295,m=y+(_<<7&4294967295|_>>>25),_=b+(T^m&(y^T))+E[9]+2336552879&4294967295,b=m+(_<<12&4294967295|_>>>20),_=T+(y^b&(m^y))+E[10]+4294925233&4294967295,T=b+(_<<17&4294967295|_>>>15),_=y+(m^T&(b^m))+E[11]+2304563134&4294967295,y=T+(_<<22&4294967295|_>>>10),_=m+(b^y&(T^b))+E[12]+1804603682&4294967295,m=y+(_<<7&4294967295|_>>>25),_=b+(T^m&(y^T))+E[13]+4254626195&4294967295,b=m+(_<<12&4294967295|_>>>20),_=T+(y^b&(m^y))+E[14]+2792965006&4294967295,T=b+(_<<17&4294967295|_>>>15),_=y+(m^T&(b^m))+E[15]+1236535329&4294967295,y=T+(_<<22&4294967295|_>>>10),_=m+(T^b&(y^T))+E[1]+4129170786&4294967295,m=y+(_<<5&4294967295|_>>>27),_=b+(y^T&(m^y))+E[6]+3225465664&4294967295,b=m+(_<<9&4294967295|_>>>23),_=T+(m^y&(b^m))+E[11]+643717713&4294967295,T=b+(_<<14&4294967295|_>>>18),_=y+(b^m&(T^b))+E[0]+3921069994&4294967295,y=T+(_<<20&4294967295|_>>>12),_=m+(T^b&(y^T))+E[5]+3593408605&4294967295,m=y+(_<<5&4294967295|_>>>27),_=b+(y^T&(m^y))+E[10]+38016083&4294967295,b=m+(_<<9&4294967295|_>>>23),_=T+(m^y&(b^m))+E[15]+3634488961&4294967295,T=b+(_<<14&4294967295|_>>>18),_=y+(b^m&(T^b))+E[4]+3889429448&4294967295,y=T+(_<<20&4294967295|_>>>12),_=m+(T^b&(y^T))+E[9]+568446438&4294967295,m=y+(_<<5&4294967295|_>>>27),_=b+(y^T&(m^y))+E[14]+3275163606&4294967295,b=m+(_<<9&4294967295|_>>>23),_=T+(m^y&(b^m))+E[3]+4107603335&4294967295,T=b+(_<<14&4294967295|_>>>18),_=y+(b^m&(T^b))+E[8]+1163531501&4294967295,y=T+(_<<20&4294967295|_>>>12),_=m+(T^b&(y^T))+E[13]+2850285829&4294967295,m=y+(_<<5&4294967295|_>>>27),_=b+(y^T&(m^y))+E[2]+4243563512&4294967295,b=m+(_<<9&4294967295|_>>>23),_=T+(m^y&(b^m))+E[7]+1735328473&4294967295,T=b+(_<<14&4294967295|_>>>18),_=y+(b^m&(T^b))+E[12]+2368359562&4294967295,y=T+(_<<20&4294967295|_>>>12),_=m+(y^T^b)+E[5]+4294588738&4294967295,m=y+(_<<4&4294967295|_>>>28),_=b+(m^y^T)+E[8]+2272392833&4294967295,b=m+(_<<11&4294967295|_>>>21),_=T+(b^m^y)+E[11]+1839030562&4294967295,T=b+(_<<16&4294967295|_>>>16),_=y+(T^b^m)+E[14]+4259657740&4294967295,y=T+(_<<23&4294967295|_>>>9),_=m+(y^T^b)+E[1]+2763975236&4294967295,m=y+(_<<4&4294967295|_>>>28),_=b+(m^y^T)+E[4]+1272893353&4294967295,b=m+(_<<11&4294967295|_>>>21),_=T+(b^m^y)+E[7]+4139469664&4294967295,T=b+(_<<16&4294967295|_>>>16),_=y+(T^b^m)+E[10]+3200236656&4294967295,y=T+(_<<23&4294967295|_>>>9),_=m+(y^T^b)+E[13]+681279174&4294967295,m=y+(_<<4&4294967295|_>>>28),_=b+(m^y^T)+E[0]+3936430074&4294967295,b=m+(_<<11&4294967295|_>>>21),_=T+(b^m^y)+E[3]+3572445317&4294967295,T=b+(_<<16&4294967295|_>>>16),_=y+(T^b^m)+E[6]+76029189&4294967295,y=T+(_<<23&4294967295|_>>>9),_=m+(y^T^b)+E[9]+3654602809&4294967295,m=y+(_<<4&4294967295|_>>>28),_=b+(m^y^T)+E[12]+3873151461&4294967295,b=m+(_<<11&4294967295|_>>>21),_=T+(b^m^y)+E[15]+530742520&4294967295,T=b+(_<<16&4294967295|_>>>16),_=y+(T^b^m)+E[2]+3299628645&4294967295,y=T+(_<<23&4294967295|_>>>9),_=m+(T^(y|~b))+E[0]+4096336452&4294967295,m=y+(_<<6&4294967295|_>>>26),_=b+(y^(m|~T))+E[7]+1126891415&4294967295,b=m+(_<<10&4294967295|_>>>22),_=T+(m^(b|~y))+E[14]+2878612391&4294967295,T=b+(_<<15&4294967295|_>>>17),_=y+(b^(T|~m))+E[5]+4237533241&4294967295,y=T+(_<<21&4294967295|_>>>11),_=m+(T^(y|~b))+E[12]+1700485571&4294967295,m=y+(_<<6&4294967295|_>>>26),_=b+(y^(m|~T))+E[3]+2399980690&4294967295,b=m+(_<<10&4294967295|_>>>22),_=T+(m^(b|~y))+E[10]+4293915773&4294967295,T=b+(_<<15&4294967295|_>>>17),_=y+(b^(T|~m))+E[1]+2240044497&4294967295,y=T+(_<<21&4294967295|_>>>11),_=m+(T^(y|~b))+E[8]+1873313359&4294967295,m=y+(_<<6&4294967295|_>>>26),_=b+(y^(m|~T))+E[15]+4264355552&4294967295,b=m+(_<<10&4294967295|_>>>22),_=T+(m^(b|~y))+E[6]+2734768916&4294967295,T=b+(_<<15&4294967295|_>>>17),_=y+(b^(T|~m))+E[13]+1309151649&4294967295,y=T+(_<<21&4294967295|_>>>11),_=m+(T^(y|~b))+E[4]+4149444226&4294967295,m=y+(_<<6&4294967295|_>>>26),_=b+(y^(m|~T))+E[11]+3174756917&4294967295,b=m+(_<<10&4294967295|_>>>22),_=T+(m^(b|~y))+E[2]+718787259&4294967295,T=b+(_<<15&4294967295|_>>>17),_=y+(b^(T|~m))+E[9]+3951481745&4294967295,w.g[0]=w.g[0]+m&4294967295,w.g[1]=w.g[1]+(T+(_<<21&4294967295|_>>>11))&4294967295,w.g[2]=w.g[2]+T&4294967295,w.g[3]=w.g[3]+b&4294967295}r.prototype.u=function(w,m){m===void 0&&(m=w.length);for(var y=m-this.blockSize,E=this.B,T=this.h,b=0;b<m;){if(T==0)for(;b<=y;)i(this,w,b),b+=this.blockSize;if(typeof w=="string"){for(;b<m;)if(E[T++]=w.charCodeAt(b++),T==this.blockSize){i(this,E),T=0;break}}else for(;b<m;)if(E[T++]=w[b++],T==this.blockSize){i(this,E),T=0;break}}this.h=T,this.o+=m},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var m=1;m<w.length-8;++m)w[m]=0;var y=8*this.o;for(m=w.length-8;m<w.length;++m)w[m]=y&255,y/=256;for(this.u(w),w=Array(16),m=y=0;4>m;++m)for(var E=0;32>E;E+=8)w[y++]=this.g[m]>>>E&255;return w};function s(w,m){var y=u;return Object.prototype.hasOwnProperty.call(y,w)?y[w]:y[w]=m(w)}function a(w,m){this.h=m;for(var y=[],E=!0,T=w.length-1;0<=T;T--){var b=w[T]|0;E&&b==m||(y[T]=b,E=!1)}this.g=y}var u={};function l(w){return-128<=w&&128>w?s(w,function(m){return new a([m|0],0>m?-1:0)}):new a([w|0],0>w?-1:0)}function d(w){if(isNaN(w)||!isFinite(w))return v;if(0>w)return k(d(-w));for(var m=[],y=1,E=0;w>=y;E++)m[E]=w/y|0,y*=4294967296;return new a(m,0)}function p(w,m){if(w.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(w.charAt(0)=="-")return k(p(w.substring(1),m));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var y=d(Math.pow(m,8)),E=v,T=0;T<w.length;T+=8){var b=Math.min(8,w.length-T),_=parseInt(w.substring(T,T+b),m);8>b?(b=d(Math.pow(m,b)),E=E.j(b).add(d(_))):(E=E.j(y),E=E.add(d(_)))}return E}var v=l(0),I=l(1),S=l(16777216);n=a.prototype,n.m=function(){if(x(this))return-k(this).m();for(var w=0,m=1,y=0;y<this.g.length;y++){var E=this.i(y);w+=(0<=E?E:4294967296+E)*m,m*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(D(this))return"0";if(x(this))return"-"+k(this).toString(w);for(var m=d(Math.pow(w,6)),y=this,E="";;){var T=X(y,m).g;y=z(y,T.j(m));var b=((0<y.g.length?y.g[0]:y.h)>>>0).toString(w);if(y=T,D(y))return b+E;for(;6>b.length;)b="0"+b;E=b+E}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function D(w){if(w.h!=0)return!1;for(var m=0;m<w.g.length;m++)if(w.g[m]!=0)return!1;return!0}function x(w){return w.h==-1}n.l=function(w){return w=z(this,w),x(w)?-1:D(w)?0:1};function k(w){for(var m=w.g.length,y=[],E=0;E<m;E++)y[E]=~w.g[E];return new a(y,~w.h).add(I)}n.abs=function(){return x(this)?k(this):this},n.add=function(w){for(var m=Math.max(this.g.length,w.g.length),y=[],E=0,T=0;T<=m;T++){var b=E+(this.i(T)&65535)+(w.i(T)&65535),_=(b>>>16)+(this.i(T)>>>16)+(w.i(T)>>>16);E=_>>>16,b&=65535,_&=65535,y[T]=_<<16|b}return new a(y,y[y.length-1]&-2147483648?-1:0)};function z(w,m){return w.add(k(m))}n.j=function(w){if(D(this)||D(w))return v;if(x(this))return x(w)?k(this).j(k(w)):k(k(this).j(w));if(x(w))return k(this.j(k(w)));if(0>this.l(S)&&0>w.l(S))return d(this.m()*w.m());for(var m=this.g.length+w.g.length,y=[],E=0;E<2*m;E++)y[E]=0;for(E=0;E<this.g.length;E++)for(var T=0;T<w.g.length;T++){var b=this.i(E)>>>16,_=this.i(E)&65535,ut=w.i(T)>>>16,Er=w.i(T)&65535;y[2*E+2*T]+=_*Er,U(y,2*E+2*T),y[2*E+2*T+1]+=b*Er,U(y,2*E+2*T+1),y[2*E+2*T+1]+=_*ut,U(y,2*E+2*T+1),y[2*E+2*T+2]+=b*ut,U(y,2*E+2*T+2)}for(E=0;E<m;E++)y[E]=y[2*E+1]<<16|y[2*E];for(E=m;E<2*m;E++)y[E]=0;return new a(y,0)};function U(w,m){for(;(w[m]&65535)!=w[m];)w[m+1]+=w[m]>>>16,w[m]&=65535,m++}function $(w,m){this.g=w,this.h=m}function X(w,m){if(D(m))throw Error("division by zero");if(D(w))return new $(v,v);if(x(w))return m=X(k(w),m),new $(k(m.g),k(m.h));if(x(m))return m=X(w,k(m)),new $(k(m.g),m.h);if(30<w.g.length){if(x(w)||x(m))throw Error("slowDivide_ only works with positive integers.");for(var y=I,E=m;0>=E.l(w);)y=Ae(y),E=Ae(E);var T=J(y,1),b=J(E,1);for(E=J(E,2),y=J(y,2);!D(E);){var _=b.add(E);0>=_.l(w)&&(T=T.add(y),b=_),E=J(E,1),y=J(y,1)}return m=z(w,T.j(m)),new $(T,m)}for(T=v;0<=w.l(m);){for(y=Math.max(1,Math.floor(w.m()/m.m())),E=Math.ceil(Math.log(y)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),b=d(y),_=b.j(m);x(_)||0<_.l(w);)y-=E,b=d(y),_=b.j(m);D(b)&&(b=I),T=T.add(b),w=z(w,_)}return new $(T,w)}n.A=function(w){return X(this,w).h},n.and=function(w){for(var m=Math.max(this.g.length,w.g.length),y=[],E=0;E<m;E++)y[E]=this.i(E)&w.i(E);return new a(y,this.h&w.h)},n.or=function(w){for(var m=Math.max(this.g.length,w.g.length),y=[],E=0;E<m;E++)y[E]=this.i(E)|w.i(E);return new a(y,this.h|w.h)},n.xor=function(w){for(var m=Math.max(this.g.length,w.g.length),y=[],E=0;E<m;E++)y[E]=this.i(E)^w.i(E);return new a(y,this.h^w.h)};function Ae(w){for(var m=w.g.length+1,y=[],E=0;E<m;E++)y[E]=w.i(E)<<1|w.i(E-1)>>>31;return new a(y,w.h)}function J(w,m){var y=m>>5;m%=32;for(var E=w.g.length-y,T=[],b=0;b<E;b++)T[b]=0<m?w.i(b+y)>>>m|w.i(b+y+1)<<32-m:w.i(b+y);return new a(T,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,rc=If.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,pt=If.Integer=a}).apply(typeof vf<"u"?vf:typeof self<"u"?self:typeof window<"u"?window:{});var ds=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},mt={};var ic,Bv,Bn,sc,Hr,fs,oc,ac,cc;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,c,h){return o==Array.prototype||o==Object.prototype||(o[c]=h.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof ds=="object"&&ds];for(var c=0;c<o.length;++c){var h=o[c];if(h&&h.Math==Math)return h}throw Error("Cannot find global object")}var r=t(this);function i(o,c){if(c)e:{var h=r;o=o.split(".");for(var f=0;f<o.length-1;f++){var A=o[f];if(!(A in h))break e;h=h[A]}o=o[o.length-1],f=h[o],c=c(f),c!=f&&c!=null&&e(h,o,{configurable:!0,writable:!0,value:c})}}function s(o,c){o instanceof String&&(o+="");var h=0,f=!1,A={next:function(){if(!f&&h<o.length){var C=h++;return{value:c(C,o[C]),done:!1}}return f=!0,{done:!0,value:void 0}}};return A[Symbol.iterator]=function(){return A},A}i("Array.prototype.values",function(o){return o||function(){return s(this,function(c,h){return h})}});var a=a||{},u=this||self;function l(o){var c=typeof o;return c=c!="object"?c:o?Array.isArray(o)?"array":c:"null",c=="array"||c=="object"&&typeof o.length=="number"}function d(o){var c=typeof o;return c=="object"&&o!=null||c=="function"}function p(o,c,h){return o.call.apply(o.bind,arguments)}function v(o,c,h){if(!o)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var A=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(A,f),o.apply(c,A)}}return function(){return o.apply(c,arguments)}}function I(o,c,h){return I=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:v,I.apply(null,arguments)}function S(o,c){var h=Array.prototype.slice.call(arguments,1);return function(){var f=h.slice();return f.push.apply(f,arguments),o.apply(this,f)}}function D(o,c){function h(){}h.prototype=c.prototype,o.aa=c.prototype,o.prototype=new h,o.prototype.constructor=o,o.Qb=function(f,A,C){for(var N=Array(arguments.length-2),Z=2;Z<arguments.length;Z++)N[Z-2]=arguments[Z];return c.prototype[A].apply(f,N)}}function x(o){let c=o.length;if(0<c){let h=Array(c);for(let f=0;f<c;f++)h[f]=o[f];return h}return[]}function k(o,c){for(let h=1;h<arguments.length;h++){let f=arguments[h];if(l(f)){let A=o.length||0,C=f.length||0;o.length=A+C;for(let N=0;N<C;N++)o[A+N]=f[N]}else o.push(f)}}class z{constructor(c,h){this.i=c,this.j=h,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function U(o){return/^[\s\xa0]*$/.test(o)}function $(){var o=u.navigator;return o&&(o=o.userAgent)?o:""}function X(o){return X[" "](o),o}X[" "]=function(){};var Ae=$().indexOf("Gecko")!=-1&&!($().toLowerCase().indexOf("webkit")!=-1&&$().indexOf("Edge")==-1)&&!($().indexOf("Trident")!=-1||$().indexOf("MSIE")!=-1)&&$().indexOf("Edge")==-1;function J(o,c,h){for(let f in o)c.call(h,o[f],f,o)}function w(o,c){for(let h in o)c.call(void 0,o[h],h,o)}function m(o){let c={};for(let h in o)c[h]=o[h];return c}let y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(o,c){let h,f;for(let A=1;A<arguments.length;A++){f=arguments[A];for(h in f)o[h]=f[h];for(let C=0;C<y.length;C++)h=y[C],Object.prototype.hasOwnProperty.call(f,h)&&(o[h]=f[h])}}function T(o){var c=1;o=o.split(":");let h=[];for(;0<c&&o.length;)h.push(o.shift()),c--;return o.length&&h.push(o.join(":")),h}function b(o){u.setTimeout(()=>{throw o},0)}function _(){var o=Zo;let c=null;return o.g&&(c=o.g,o.g=o.g.next,o.g||(o.h=null),c.next=null),c}class ut{constructor(){this.h=this.g=null}add(c,h){let f=Er.get();f.set(c,h),this.h?this.h.next=f:this.g=f,this.h=f}}var Er=new z(()=>new H_,o=>o.reset());class H_{constructor(){this.next=this.g=this.h=null}set(c,h){this.h=c,this.g=h,this.next=null}reset(){this.next=this.g=this.h=null}}let wr,Tr=!1,Zo=new ut,kh=()=>{let o=u.Promise.resolve(void 0);wr=()=>{o.then(K_)}};var K_=()=>{for(var o;o=_();){try{o.h.call(o.g)}catch(h){b(h)}var c=Er;c.j(o),100>c.h&&(c.h++,o.next=c.g,c.g=o)}Tr=!1};function Ct(){this.s=this.s,this.C=this.C}Ct.prototype.s=!1,Ct.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ct.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function _e(o,c){this.type=o,this.g=this.target=c,this.defaultPrevented=!1}_e.prototype.h=function(){this.defaultPrevented=!0};var Q_=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var o=!1,c=Object.defineProperty({},"passive",{get:function(){o=!0}});try{let h=()=>{};u.addEventListener("test",h,c),u.removeEventListener("test",h,c)}catch{}return o}();function Ar(o,c){if(_e.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var h=this.type=o.type,f=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=c,c=o.relatedTarget){if(Ae){e:{try{X(c.nodeName);var A=!0;break e}catch{}A=!1}A||(c=null)}}else h=="mouseover"?c=o.fromElement:h=="mouseout"&&(c=o.toElement);this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:Y_[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&Ar.aa.h.call(this)}}D(Ar,_e);var Y_={2:"touch",3:"pen",4:"mouse"};Ar.prototype.h=function(){Ar.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var br="closure_listenable_"+(1e6*Math.random()|0),J_=0;function X_(o,c,h,f,A){this.listener=o,this.proxy=null,this.src=c,this.type=h,this.capture=!!f,this.ha=A,this.key=++J_,this.da=this.fa=!1}function xi(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Mi(o){this.src=o,this.g={},this.h=0}Mi.prototype.add=function(o,c,h,f,A){var C=o.toString();o=this.g[C],o||(o=this.g[C]=[],this.h++);var N=ta(o,c,f,A);return-1<N?(c=o[N],h||(c.fa=!1)):(c=new X_(c,this.src,C,!!f,A),c.fa=h,o.push(c)),c};function ea(o,c){var h=c.type;if(h in o.g){var f=o.g[h],A=Array.prototype.indexOf.call(f,c,void 0),C;(C=0<=A)&&Array.prototype.splice.call(f,A,1),C&&(xi(c),o.g[h].length==0&&(delete o.g[h],o.h--))}}function ta(o,c,h,f){for(var A=0;A<o.length;++A){var C=o[A];if(!C.da&&C.listener==c&&C.capture==!!h&&C.ha==f)return A}return-1}var na="closure_lm_"+(1e6*Math.random()|0),ra={};function Nh(o,c,h,f,A){if(f&&f.once)return Oh(o,c,h,f,A);if(Array.isArray(c)){for(var C=0;C<c.length;C++)Nh(o,c[C],h,f,A);return null}return h=aa(h),o&&o[br]?o.K(c,h,d(f)?!!f.capture:!!f,A):Vh(o,c,h,!1,f,A)}function Vh(o,c,h,f,A,C){if(!c)throw Error("Invalid event type");var N=d(A)?!!A.capture:!!A,Z=sa(o);if(Z||(o[na]=Z=new Mi(o)),h=Z.add(c,h,f,N,C),h.proxy)return h;if(f=Z_(),h.proxy=f,f.src=o,f.listener=h,o.addEventListener)Q_||(A=N),A===void 0&&(A=!1),o.addEventListener(c.toString(),f,A);else if(o.attachEvent)o.attachEvent(Mh(c.toString()),f);else if(o.addListener&&o.removeListener)o.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return h}function Z_(){function o(h){return c.call(o.src,o.listener,h)}let c=ey;return o}function Oh(o,c,h,f,A){if(Array.isArray(c)){for(var C=0;C<c.length;C++)Oh(o,c[C],h,f,A);return null}return h=aa(h),o&&o[br]?o.L(c,h,d(f)?!!f.capture:!!f,A):Vh(o,c,h,!0,f,A)}function xh(o,c,h,f,A){if(Array.isArray(c))for(var C=0;C<c.length;C++)xh(o,c[C],h,f,A);else f=d(f)?!!f.capture:!!f,h=aa(h),o&&o[br]?(o=o.i,c=String(c).toString(),c in o.g&&(C=o.g[c],h=ta(C,h,f,A),-1<h&&(xi(C[h]),Array.prototype.splice.call(C,h,1),C.length==0&&(delete o.g[c],o.h--)))):o&&(o=sa(o))&&(c=o.g[c.toString()],o=-1,c&&(o=ta(c,h,f,A)),(h=-1<o?c[o]:null)&&ia(h))}function ia(o){if(typeof o!="number"&&o&&!o.da){var c=o.src;if(c&&c[br])ea(c.i,o);else{var h=o.type,f=o.proxy;c.removeEventListener?c.removeEventListener(h,f,o.capture):c.detachEvent?c.detachEvent(Mh(h),f):c.addListener&&c.removeListener&&c.removeListener(f),(h=sa(c))?(ea(h,o),h.h==0&&(h.src=null,c[na]=null)):xi(o)}}}function Mh(o){return o in ra?ra[o]:ra[o]="on"+o}function ey(o,c){if(o.da)o=!0;else{c=new Ar(c,this);var h=o.listener,f=o.ha||o.src;o.fa&&ia(o),o=h.call(f,c)}return o}function sa(o){return o=o[na],o instanceof Mi?o:null}var oa="__closure_events_fn_"+(1e9*Math.random()>>>0);function aa(o){return typeof o=="function"?o:(o[oa]||(o[oa]=function(c){return o.handleEvent(c)}),o[oa])}function ye(){Ct.call(this),this.i=new Mi(this),this.M=this,this.F=null}D(ye,Ct),ye.prototype[br]=!0,ye.prototype.removeEventListener=function(o,c,h,f){xh(this,o,c,h,f)};function be(o,c){var h,f=o.F;if(f)for(h=[];f;f=f.F)h.push(f);if(o=o.M,f=c.type||c,typeof c=="string")c=new _e(c,o);else if(c instanceof _e)c.target=c.target||o;else{var A=c;c=new _e(f,o),E(c,A)}if(A=!0,h)for(var C=h.length-1;0<=C;C--){var N=c.g=h[C];A=Fi(N,f,!0,c)&&A}if(N=c.g=o,A=Fi(N,f,!0,c)&&A,A=Fi(N,f,!1,c)&&A,h)for(C=0;C<h.length;C++)N=c.g=h[C],A=Fi(N,f,!1,c)&&A}ye.prototype.N=function(){if(ye.aa.N.call(this),this.i){var o=this.i,c;for(c in o.g){for(var h=o.g[c],f=0;f<h.length;f++)xi(h[f]);delete o.g[c],o.h--}}this.F=null},ye.prototype.K=function(o,c,h,f){return this.i.add(String(o),c,!1,h,f)},ye.prototype.L=function(o,c,h,f){return this.i.add(String(o),c,!0,h,f)};function Fi(o,c,h,f){if(c=o.i.g[String(c)],!c)return!0;c=c.concat();for(var A=!0,C=0;C<c.length;++C){var N=c[C];if(N&&!N.da&&N.capture==h){var Z=N.listener,me=N.ha||N.src;N.fa&&ea(o.i,N),A=Z.call(me,f)!==!1&&A}}return A&&!f.defaultPrevented}function Fh(o,c,h){if(typeof o=="function")h&&(o=I(o,h));else if(o&&typeof o.handleEvent=="function")o=I(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:u.setTimeout(o,c||0)}function Lh(o){o.g=Fh(()=>{o.g=null,o.i&&(o.i=!1,Lh(o))},o.l);let c=o.h;o.h=null,o.m.apply(null,c)}class ty extends Ct{constructor(c,h){super(),this.m=c,this.l=h,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Lh(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Cr(o){Ct.call(this),this.h=o,this.g={}}D(Cr,Ct);var Uh=[];function Bh(o){J(o.g,function(c,h){this.g.hasOwnProperty(h)&&ia(c)},o),o.g={}}Cr.prototype.N=function(){Cr.aa.N.call(this),Bh(this)},Cr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ca=u.JSON.stringify,ny=u.JSON.parse,ry=class{stringify(o){return u.JSON.stringify(o,void 0)}parse(o){return u.JSON.parse(o,void 0)}};function ua(){}ua.prototype.h=null;function qh(o){return o.h||(o.h=o.i())}function $h(){}var Sr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function la(){_e.call(this,"d")}D(la,_e);function ha(){_e.call(this,"c")}D(ha,_e);var Yt={},jh=null;function Li(){return jh=jh||new ye}Yt.La="serverreachability";function zh(o){_e.call(this,Yt.La,o)}D(zh,_e);function Rr(o){let c=Li();be(c,new zh(c))}Yt.STAT_EVENT="statevent";function Gh(o,c){_e.call(this,Yt.STAT_EVENT,o),this.stat=c}D(Gh,_e);function Ce(o){let c=Li();be(c,new Gh(c,o))}Yt.Ma="timingevent";function Wh(o,c){_e.call(this,Yt.Ma,o),this.size=c}D(Wh,_e);function Pr(o,c){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){o()},c)}function Dr(){this.g=!0}Dr.prototype.xa=function(){this.g=!1};function iy(o,c,h,f,A,C){o.info(function(){if(o.g)if(C)for(var N="",Z=C.split("&"),me=0;me<Z.length;me++){var K=Z[me].split("=");if(1<K.length){var ve=K[0];K=K[1];var Ie=ve.split("_");N=2<=Ie.length&&Ie[1]=="type"?N+(ve+"="+K+"&"):N+(ve+"=redacted&")}}else N=null;else N=C;return"XMLHTTP REQ ("+f+") [attempt "+A+"]: "+c+`
`+h+`
`+N})}function sy(o,c,h,f,A,C,N){o.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+A+"]: "+c+`
`+h+`
`+C+" "+N})}function Dn(o,c,h,f){o.info(function(){return"XMLHTTP TEXT ("+c+"): "+ay(o,h)+(f?" "+f:"")})}function oy(o,c){o.info(function(){return"TIMEOUT: "+c})}Dr.prototype.info=function(){};function ay(o,c){if(!o.g)return c;if(!c)return null;try{var h=JSON.parse(c);if(h){for(o=0;o<h.length;o++)if(Array.isArray(h[o])){var f=h[o];if(!(2>f.length)){var A=f[1];if(Array.isArray(A)&&!(1>A.length)){var C=A[0];if(C!="noop"&&C!="stop"&&C!="close")for(var N=1;N<A.length;N++)A[N]=""}}}}return ca(h)}catch{return c}}var Ui={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Hh={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},da;function Bi(){}D(Bi,ua),Bi.prototype.g=function(){return new XMLHttpRequest},Bi.prototype.i=function(){return{}},da=new Bi;function St(o,c,h,f){this.j=o,this.i=c,this.l=h,this.R=f||1,this.U=new Cr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Kh}function Kh(){this.i=null,this.g="",this.h=!1}var Qh={},fa={};function pa(o,c,h){o.L=1,o.v=zi(lt(c)),o.m=h,o.P=!0,Yh(o,null)}function Yh(o,c){o.F=Date.now(),qi(o),o.A=lt(o.v);var h=o.A,f=o.R;Array.isArray(f)||(f=[String(f)]),ld(h.i,"t",f),o.C=0,h=o.j.J,o.h=new Kh,o.g=Rd(o.j,h?c:null,!o.m),0<o.O&&(o.M=new ty(I(o.Y,o,o.g),o.O)),c=o.U,h=o.g,f=o.ca;var A="readystatechange";Array.isArray(A)||(A&&(Uh[0]=A.toString()),A=Uh);for(var C=0;C<A.length;C++){var N=Nh(h,A[C],f||c.handleEvent,!1,c.h||c);if(!N)break;c.g[N.key]=N}c=o.H?m(o.H):{},o.m?(o.u||(o.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,c)):(o.u="GET",o.g.ea(o.A,o.u,null,c)),Rr(),iy(o.i,o.u,o.A,o.l,o.R,o.m)}St.prototype.ca=function(o){o=o.target;let c=this.M;c&&ht(o)==3?c.j():this.Y(o)},St.prototype.Y=function(o){try{if(o==this.g)e:{let Ie=ht(this.g);var c=this.g.Ba();let Vn=this.g.Z();if(!(3>Ie)&&(Ie!=3||this.g&&(this.h.h||this.g.oa()||_d(this.g)))){this.J||Ie!=4||c==7||(c==8||0>=Vn?Rr(3):Rr(2)),ma(this);var h=this.g.Z();this.X=h;t:if(Jh(this)){var f=_d(this.g);o="";var A=f.length,C=ht(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Jt(this),kr(this);var N="";break t}this.h.i=new u.TextDecoder}for(c=0;c<A;c++)this.h.h=!0,o+=this.h.i.decode(f[c],{stream:!(C&&c==A-1)});f.length=0,this.h.g+=o,this.C=0,N=this.h.g}else N=this.g.oa();if(this.o=h==200,sy(this.i,this.u,this.A,this.l,this.R,Ie,h),this.o){if(this.T&&!this.K){t:{if(this.g){var Z,me=this.g;if((Z=me.g?me.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U(Z)){var K=Z;break t}}K=null}if(h=K)Dn(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ga(this,h);else{this.o=!1,this.s=3,Ce(12),Jt(this),kr(this);break e}}if(this.P){h=!0;let qe;for(;!this.J&&this.C<N.length;)if(qe=cy(this,N),qe==fa){Ie==4&&(this.s=4,Ce(14),h=!1),Dn(this.i,this.l,null,"[Incomplete Response]");break}else if(qe==Qh){this.s=4,Ce(15),Dn(this.i,this.l,N,"[Invalid Chunk]"),h=!1;break}else Dn(this.i,this.l,qe,null),ga(this,qe);if(Jh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ie!=4||N.length!=0||this.h.h||(this.s=1,Ce(16),h=!1),this.o=this.o&&h,!h)Dn(this.i,this.l,N,"[Invalid Chunked Response]"),Jt(this),kr(this);else if(0<N.length&&!this.W){this.W=!0;var ve=this.j;ve.g==this&&ve.ba&&!ve.M&&(ve.j.info("Great, no buffering proxy detected. Bytes received: "+N.length),wa(ve),ve.M=!0,Ce(11))}}else Dn(this.i,this.l,N,null),ga(this,N);Ie==4&&Jt(this),this.o&&!this.J&&(Ie==4?Ad(this.j,this):(this.o=!1,qi(this)))}else by(this.g),h==400&&0<N.indexOf("Unknown SID")?(this.s=3,Ce(12)):(this.s=0,Ce(13)),Jt(this),kr(this)}}}catch{}finally{}};function Jh(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function cy(o,c){var h=o.C,f=c.indexOf(`
`,h);return f==-1?fa:(h=Number(c.substring(h,f)),isNaN(h)?Qh:(f+=1,f+h>c.length?fa:(c=c.slice(f,f+h),o.C=f+h,c)))}St.prototype.cancel=function(){this.J=!0,Jt(this)};function qi(o){o.S=Date.now()+o.I,Xh(o,o.I)}function Xh(o,c){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Pr(I(o.ba,o),c)}function ma(o){o.B&&(u.clearTimeout(o.B),o.B=null)}St.prototype.ba=function(){this.B=null;let o=Date.now();0<=o-this.S?(oy(this.i,this.A),this.L!=2&&(Rr(),Ce(17)),Jt(this),this.s=2,kr(this)):Xh(this,this.S-o)};function kr(o){o.j.G==0||o.J||Ad(o.j,o)}function Jt(o){ma(o);var c=o.M;c&&typeof c.ma=="function"&&c.ma(),o.M=null,Bh(o.U),o.g&&(c=o.g,o.g=null,c.abort(),c.ma())}function ga(o,c){try{var h=o.j;if(h.G!=0&&(h.g==o||_a(h.h,o))){if(!o.K&&_a(h.h,o)&&h.G==3){try{var f=h.Da.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var A=f;if(A[0]==0){e:if(!h.u){if(h.g)if(h.g.F+3e3<o.F)Qi(h),Hi(h);else break e;Ea(h),Ce(18)}}else h.za=A[1],0<h.za-h.T&&37500>A[2]&&h.F&&h.v==0&&!h.C&&(h.C=Pr(I(h.Za,h),6e3));if(1>=td(h.h)&&h.ca){try{h.ca()}catch{}h.ca=void 0}}else Zt(h,11)}else if((o.K||h.g==o)&&Qi(h),!U(c))for(A=h.Da.g.parse(c),c=0;c<A.length;c++){let K=A[c];if(h.T=K[0],K=K[1],h.G==2)if(K[0]=="c"){h.K=K[1],h.ia=K[2];let ve=K[3];ve!=null&&(h.la=ve,h.j.info("VER="+h.la));let Ie=K[4];Ie!=null&&(h.Aa=Ie,h.j.info("SVER="+h.Aa));let Vn=K[5];Vn!=null&&typeof Vn=="number"&&0<Vn&&(f=1.5*Vn,h.L=f,h.j.info("backChannelRequestTimeoutMs_="+f)),f=h;let qe=o.g;if(qe){let Ji=qe.g?qe.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ji){var C=f.h;C.g||Ji.indexOf("spdy")==-1&&Ji.indexOf("quic")==-1&&Ji.indexOf("h2")==-1||(C.j=C.l,C.g=new Set,C.h&&(ya(C,C.h),C.h=null))}if(f.D){let Ta=qe.g?qe.g.getResponseHeader("X-HTTP-Session-Id"):null;Ta&&(f.ya=Ta,ee(f.I,f.D,Ta))}}h.G=3,h.l&&h.l.ua(),h.ba&&(h.R=Date.now()-o.F,h.j.info("Handshake RTT: "+h.R+"ms")),f=h;var N=o;if(f.qa=Sd(f,f.J?f.ia:null,f.W),N.K){nd(f.h,N);var Z=N,me=f.L;me&&(Z.I=me),Z.B&&(ma(Z),qi(Z)),f.g=N}else wd(f);0<h.i.length&&Ki(h)}else K[0]!="stop"&&K[0]!="close"||Zt(h,7);else h.G==3&&(K[0]=="stop"||K[0]=="close"?K[0]=="stop"?Zt(h,7):Ia(h):K[0]!="noop"&&h.l&&h.l.ta(K),h.v=0)}}Rr(4)}catch{}}var uy=class{constructor(o,c){this.g=o,this.map=c}};function Zh(o){this.l=o||10,u.PerformanceNavigationTiming?(o=u.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ed(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function td(o){return o.h?1:o.g?o.g.size:0}function _a(o,c){return o.h?o.h==c:o.g?o.g.has(c):!1}function ya(o,c){o.g?o.g.add(c):o.h=c}function nd(o,c){o.h&&o.h==c?o.h=null:o.g&&o.g.has(c)&&o.g.delete(c)}Zh.prototype.cancel=function(){if(this.i=rd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let o of this.g.values())o.cancel();this.g.clear()}};function rd(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let c=o.i;for(let h of o.g.values())c=c.concat(h.D);return c}return x(o.i)}function ly(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(l(o)){for(var c=[],h=o.length,f=0;f<h;f++)c.push(o[f]);return c}c=[],h=0;for(f in o)c[h++]=o[f];return c}function hy(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(l(o)||typeof o=="string"){var c=[];o=o.length;for(var h=0;h<o;h++)c.push(h);return c}c=[],h=0;for(let f in o)c[h++]=f;return c}}}function id(o,c){if(o.forEach&&typeof o.forEach=="function")o.forEach(c,void 0);else if(l(o)||typeof o=="string")Array.prototype.forEach.call(o,c,void 0);else for(var h=hy(o),f=ly(o),A=f.length,C=0;C<A;C++)c.call(void 0,f[C],h&&h[C],o)}var sd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function dy(o,c){if(o){o=o.split("&");for(var h=0;h<o.length;h++){var f=o[h].indexOf("="),A=null;if(0<=f){var C=o[h].substring(0,f);A=o[h].substring(f+1)}else C=o[h];c(C,A?decodeURIComponent(A.replace(/\+/g," ")):"")}}}function Xt(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof Xt){this.h=o.h,$i(this,o.j),this.o=o.o,this.g=o.g,ji(this,o.s),this.l=o.l;var c=o.i,h=new Or;h.i=c.i,c.g&&(h.g=new Map(c.g),h.h=c.h),od(this,h),this.m=o.m}else o&&(c=String(o).match(sd))?(this.h=!1,$i(this,c[1]||"",!0),this.o=Nr(c[2]||""),this.g=Nr(c[3]||"",!0),ji(this,c[4]),this.l=Nr(c[5]||"",!0),od(this,c[6]||"",!0),this.m=Nr(c[7]||"")):(this.h=!1,this.i=new Or(null,this.h))}Xt.prototype.toString=function(){var o=[],c=this.j;c&&o.push(Vr(c,ad,!0),":");var h=this.g;return(h||c=="file")&&(o.push("//"),(c=this.o)&&o.push(Vr(c,ad,!0),"@"),o.push(encodeURIComponent(String(h)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h=this.s,h!=null&&o.push(":",String(h))),(h=this.l)&&(this.g&&h.charAt(0)!="/"&&o.push("/"),o.push(Vr(h,h.charAt(0)=="/"?my:py,!0))),(h=this.i.toString())&&o.push("?",h),(h=this.m)&&o.push("#",Vr(h,_y)),o.join("")};function lt(o){return new Xt(o)}function $i(o,c,h){o.j=h?Nr(c,!0):c,o.j&&(o.j=o.j.replace(/:$/,""))}function ji(o,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);o.s=c}else o.s=null}function od(o,c,h){c instanceof Or?(o.i=c,yy(o.i,o.h)):(h||(c=Vr(c,gy)),o.i=new Or(c,o.h))}function ee(o,c,h){o.i.set(c,h)}function zi(o){return ee(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function Nr(o,c){return o?c?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Vr(o,c,h){return typeof o=="string"?(o=encodeURI(o).replace(c,fy),h&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function fy(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var ad=/[#\/\?@]/g,py=/[#\?:]/g,my=/[#\?]/g,gy=/[#\?@]/g,_y=/#/g;function Or(o,c){this.h=this.g=null,this.i=o||null,this.j=!!c}function Rt(o){o.g||(o.g=new Map,o.h=0,o.i&&dy(o.i,function(c,h){o.add(decodeURIComponent(c.replace(/\+/g," ")),h)}))}n=Or.prototype,n.add=function(o,c){Rt(this),this.i=null,o=kn(this,o);var h=this.g.get(o);return h||this.g.set(o,h=[]),h.push(c),this.h+=1,this};function cd(o,c){Rt(o),c=kn(o,c),o.g.has(c)&&(o.i=null,o.h-=o.g.get(c).length,o.g.delete(c))}function ud(o,c){return Rt(o),c=kn(o,c),o.g.has(c)}n.forEach=function(o,c){Rt(this),this.g.forEach(function(h,f){h.forEach(function(A){o.call(c,A,f,this)},this)},this)},n.na=function(){Rt(this);let o=Array.from(this.g.values()),c=Array.from(this.g.keys()),h=[];for(let f=0;f<c.length;f++){let A=o[f];for(let C=0;C<A.length;C++)h.push(c[f])}return h},n.V=function(o){Rt(this);let c=[];if(typeof o=="string")ud(this,o)&&(c=c.concat(this.g.get(kn(this,o))));else{o=Array.from(this.g.values());for(let h=0;h<o.length;h++)c=c.concat(o[h])}return c},n.set=function(o,c){return Rt(this),this.i=null,o=kn(this,o),ud(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[c]),this.h+=1,this},n.get=function(o,c){return o?(o=this.V(o),0<o.length?String(o[0]):c):c};function ld(o,c,h){cd(o,c),0<h.length&&(o.i=null,o.g.set(kn(o,c),x(h)),o.h+=h.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let o=[],c=Array.from(this.g.keys());for(var h=0;h<c.length;h++){var f=c[h];let C=encodeURIComponent(String(f)),N=this.V(f);for(f=0;f<N.length;f++){var A=C;N[f]!==""&&(A+="="+encodeURIComponent(String(N[f]))),o.push(A)}}return this.i=o.join("&")};function kn(o,c){return c=String(c),o.j&&(c=c.toLowerCase()),c}function yy(o,c){c&&!o.j&&(Rt(o),o.i=null,o.g.forEach(function(h,f){var A=f.toLowerCase();f!=A&&(cd(this,f),ld(this,A,h))},o)),o.j=c}function vy(o,c){let h=new Dr;if(u.Image){let f=new Image;f.onload=S(Pt,h,"TestLoadImage: loaded",!0,c,f),f.onerror=S(Pt,h,"TestLoadImage: error",!1,c,f),f.onabort=S(Pt,h,"TestLoadImage: abort",!1,c,f),f.ontimeout=S(Pt,h,"TestLoadImage: timeout",!1,c,f),u.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=o}else c(!1)}function Iy(o,c){let h=new Dr,f=new AbortController,A=setTimeout(()=>{f.abort(),Pt(h,"TestPingServer: timeout",!1,c)},1e4);fetch(o,{signal:f.signal}).then(C=>{clearTimeout(A),C.ok?Pt(h,"TestPingServer: ok",!0,c):Pt(h,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(A),Pt(h,"TestPingServer: error",!1,c)})}function Pt(o,c,h,f,A){try{A&&(A.onload=null,A.onerror=null,A.onabort=null,A.ontimeout=null),f(h)}catch{}}function Ey(){this.g=new ry}function wy(o,c,h){let f=h||"";try{id(o,function(A,C){let N=A;d(A)&&(N=ca(A)),c.push(f+C+"="+encodeURIComponent(N))})}catch(A){throw c.push(f+"type="+encodeURIComponent("_badmap")),A}}function xr(o){this.l=o.Ub||null,this.j=o.eb||!1}D(xr,ua),xr.prototype.g=function(){return new Gi(this.l,this.j)},xr.prototype.i=function(o){return function(){return o}}({});function Gi(o,c){ye.call(this),this.D=o,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}D(Gi,ye),n=Gi.prototype,n.open=function(o,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=c,this.readyState=1,Fr(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(c.body=o),(this.D||u).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Mr(this)),this.readyState=0},n.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Fr(this)),this.g&&(this.readyState=3,Fr(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;hd(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function hd(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}n.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var c=o.value?o.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!o.done}))&&(this.response=this.responseText+=c)}o.done?Mr(this):Fr(this),this.readyState==3&&hd(this)}},n.Ra=function(o){this.g&&(this.response=this.responseText=o,Mr(this))},n.Qa=function(o){this.g&&(this.response=o,Mr(this))},n.ga=function(){this.g&&Mr(this)};function Mr(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Fr(o)}n.setRequestHeader=function(o,c){this.u.append(o,c)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let o=[],c=this.h.entries();for(var h=c.next();!h.done;)h=h.value,o.push(h[0]+": "+h[1]),h=c.next();return o.join(`\r
`)};function Fr(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(Gi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function dd(o){let c="";return J(o,function(h,f){c+=f,c+=":",c+=h,c+=`\r
`}),c}function va(o,c,h){e:{for(f in h){var f=!1;break e}f=!0}f||(h=dd(h),typeof o=="string"?h!=null&&encodeURIComponent(String(h)):ee(o,c,h))}function re(o){ye.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}D(re,ye);var Ty=/^https?$/i,Ay=["POST","PUT"];n=re.prototype,n.Ha=function(o){this.J=o},n.ea=function(o,c,h,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);c=c?c.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():da.g(),this.v=this.o?qh(this.o):qh(da),this.g.onreadystatechange=I(this.Ea,this);try{this.B=!0,this.g.open(c,String(o),!0),this.B=!1}catch(C){fd(this,C);return}if(o=h||"",h=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var A in f)h.set(A,f[A]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let C of f.keys())h.set(C,f.get(C));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(h.keys()).find(C=>C.toLowerCase()=="content-type"),A=u.FormData&&o instanceof u.FormData,!(0<=Array.prototype.indexOf.call(Ay,c,void 0))||f||A||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[C,N]of h)this.g.setRequestHeader(C,N);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{gd(this),this.u=!0,this.g.send(o),this.u=!1}catch(C){fd(this,C)}};function fd(o,c){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=c,o.m=5,pd(o),Wi(o)}function pd(o){o.A||(o.A=!0,be(o,"complete"),be(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,be(this,"complete"),be(this,"abort"),Wi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Wi(this,!0)),re.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?md(this):this.bb())},n.bb=function(){md(this)};function md(o){if(o.h&&typeof a<"u"&&(!o.v[1]||ht(o)!=4||o.Z()!=2)){if(o.u&&ht(o)==4)Fh(o.Ea,0,o);else if(be(o,"readystatechange"),ht(o)==4){o.h=!1;try{let N=o.Z();e:switch(N){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var h;if(!(h=c)){var f;if(f=N===0){var A=String(o.D).match(sd)[1]||null;!A&&u.self&&u.self.location&&(A=u.self.location.protocol.slice(0,-1)),f=!Ty.test(A?A.toLowerCase():"")}h=f}if(h)be(o,"complete"),be(o,"success");else{o.m=6;try{var C=2<ht(o)?o.g.statusText:""}catch{C=""}o.l=C+" ["+o.Z()+"]",pd(o)}}finally{Wi(o)}}}}function Wi(o,c){if(o.g){gd(o);let h=o.g,f=o.v[0]?()=>{}:null;o.g=null,o.v=null,c||be(o,"ready");try{h.onreadystatechange=f}catch{}}}function gd(o){o.I&&(u.clearTimeout(o.I),o.I=null)}n.isActive=function(){return!!this.g};function ht(o){return o.g?o.g.readyState:0}n.Z=function(){try{return 2<ht(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(o){if(this.g){var c=this.g.responseText;return o&&c.indexOf(o)==0&&(c=c.substring(o.length)),ny(c)}};function _d(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function by(o){let c={};o=(o.g&&2<=ht(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<o.length;f++){if(U(o[f]))continue;var h=T(o[f]);let A=h[0];if(h=h[1],typeof h!="string")continue;h=h.trim();let C=c[A]||[];c[A]=C,C.push(h)}w(c,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Lr(o,c,h){return h&&h.internalChannelParams&&h.internalChannelParams[o]||c}function yd(o){this.Aa=0,this.i=[],this.j=new Dr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Lr("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Lr("baseRetryDelayMs",5e3,o),this.cb=Lr("retryDelaySeedMs",1e4,o),this.Wa=Lr("forwardChannelMaxRetries",2,o),this.wa=Lr("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Zh(o&&o.concurrentRequestLimit),this.Da=new Ey,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=yd.prototype,n.la=8,n.G=1,n.connect=function(o,c,h,f){Ce(0),this.W=o,this.H=c||{},h&&f!==void 0&&(this.H.OSID=h,this.H.OAID=f),this.F=this.X,this.I=Sd(this,null,this.W),Ki(this)};function Ia(o){if(vd(o),o.G==3){var c=o.U++,h=lt(o.I);if(ee(h,"SID",o.K),ee(h,"RID",c),ee(h,"TYPE","terminate"),Ur(o,h),c=new St(o,o.j,c),c.L=2,c.v=zi(lt(h)),h=!1,u.navigator&&u.navigator.sendBeacon)try{h=u.navigator.sendBeacon(c.v.toString(),"")}catch{}!h&&u.Image&&(new Image().src=c.v,h=!0),h||(c.g=Rd(c.j,null),c.g.ea(c.v)),c.F=Date.now(),qi(c)}Cd(o)}function Hi(o){o.g&&(wa(o),o.g.cancel(),o.g=null)}function vd(o){Hi(o),o.u&&(u.clearTimeout(o.u),o.u=null),Qi(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&u.clearTimeout(o.s),o.s=null)}function Ki(o){if(!ed(o.h)&&!o.s){o.s=!0;var c=o.Ga;wr||kh(),Tr||(wr(),Tr=!0),Zo.add(c,o),o.B=0}}function Cy(o,c){return td(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=c.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Pr(I(o.Ga,o,c),bd(o,o.B)),o.B++,!0)}n.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;let A=new St(this,this.j,o),C=this.o;if(this.S&&(C?(C=m(C),E(C,this.S)):C=this.S),this.m!==null||this.O||(A.H=C,C=null),this.P)e:{for(var c=0,h=0;h<this.i.length;h++){t:{var f=this.i[h];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,4096<c){c=h;break e}if(c===4096||h===this.i.length-1){c=h+1;break e}}c=1e3}else c=1e3;c=Ed(this,A,c),h=lt(this.I),ee(h,"RID",o),ee(h,"CVER",22),this.D&&ee(h,"X-HTTP-Session-Id",this.D),Ur(this,h),C&&(this.O?c="headers="+encodeURIComponent(String(dd(C)))+"&"+c:this.m&&va(h,this.m,C)),ya(this.h,A),this.Ua&&ee(h,"TYPE","init"),this.P?(ee(h,"$req",c),ee(h,"SID","null"),A.T=!0,pa(A,h,null)):pa(A,h,c),this.G=2}}else this.G==3&&(o?Id(this,o):this.i.length==0||ed(this.h)||Id(this))};function Id(o,c){var h;c?h=c.l:h=o.U++;let f=lt(o.I);ee(f,"SID",o.K),ee(f,"RID",h),ee(f,"AID",o.T),Ur(o,f),o.m&&o.o&&va(f,o.m,o.o),h=new St(o,o.j,h,o.B+1),o.m===null&&(h.H=o.o),c&&(o.i=c.D.concat(o.i)),c=Ed(o,h,1e3),h.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),ya(o.h,h),pa(h,f,c)}function Ur(o,c){o.H&&J(o.H,function(h,f){ee(c,f,h)}),o.l&&id({},function(h,f){ee(c,f,h)})}function Ed(o,c,h){h=Math.min(o.i.length,h);var f=o.l?I(o.l.Na,o.l,o):null;e:{var A=o.i;let C=-1;for(;;){let N=["count="+h];C==-1?0<h?(C=A[0].g,N.push("ofs="+C)):C=0:N.push("ofs="+C);let Z=!0;for(let me=0;me<h;me++){let K=A[me].g,ve=A[me].map;if(K-=C,0>K)C=Math.max(0,A[me].g-100),Z=!1;else try{wy(ve,N,"req"+K+"_")}catch{f&&f(ve)}}if(Z){f=N.join("&");break e}}}return o=o.i.splice(0,h),c.D=o,f}function wd(o){if(!o.g&&!o.u){o.Y=1;var c=o.Fa;wr||kh(),Tr||(wr(),Tr=!0),Zo.add(c,o),o.v=0}}function Ea(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Pr(I(o.Fa,o),bd(o,o.v)),o.v++,!0)}n.Fa=function(){if(this.u=null,Td(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Pr(I(this.ab,this),o)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ce(10),Hi(this),Td(this))};function wa(o){o.A!=null&&(u.clearTimeout(o.A),o.A=null)}function Td(o){o.g=new St(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var c=lt(o.qa);ee(c,"RID","rpc"),ee(c,"SID",o.K),ee(c,"AID",o.T),ee(c,"CI",o.F?"0":"1"),!o.F&&o.ja&&ee(c,"TO",o.ja),ee(c,"TYPE","xmlhttp"),Ur(o,c),o.m&&o.o&&va(c,o.m,o.o),o.L&&(o.g.I=o.L);var h=o.g;o=o.ia,h.L=1,h.v=zi(lt(c)),h.m=null,h.P=!0,Yh(h,o)}n.Za=function(){this.C!=null&&(this.C=null,Hi(this),Ea(this),Ce(19))};function Qi(o){o.C!=null&&(u.clearTimeout(o.C),o.C=null)}function Ad(o,c){var h=null;if(o.g==c){Qi(o),wa(o),o.g=null;var f=2}else if(_a(o.h,c))h=c.D,nd(o.h,c),f=1;else return;if(o.G!=0){if(c.o)if(f==1){h=c.m?c.m.length:0,c=Date.now()-c.F;var A=o.B;f=Li(),be(f,new Wh(f,h)),Ki(o)}else wd(o);else if(A=c.s,A==3||A==0&&0<c.X||!(f==1&&Cy(o,c)||f==2&&Ea(o)))switch(h&&0<h.length&&(c=o.h,c.i=c.i.concat(h)),A){case 1:Zt(o,5);break;case 4:Zt(o,10);break;case 3:Zt(o,6);break;default:Zt(o,2)}}}function bd(o,c){let h=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(h*=2),h*c}function Zt(o,c){if(o.j.info("Error code "+c),c==2){var h=I(o.fb,o),f=o.Xa;let A=!f;f=new Xt(f||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||$i(f,"https"),zi(f),A?vy(f.toString(),h):Iy(f.toString(),h)}else Ce(2);o.G=0,o.l&&o.l.sa(c),Cd(o),vd(o)}n.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Ce(2)):(this.j.info("Failed to ping google.com"),Ce(1))};function Cd(o){if(o.G=0,o.ka=[],o.l){let c=rd(o.h);(c.length!=0||o.i.length!=0)&&(k(o.ka,c),k(o.ka,o.i),o.h.i.length=0,x(o.i),o.i.length=0),o.l.ra()}}function Sd(o,c,h){var f=h instanceof Xt?lt(h):new Xt(h);if(f.g!="")c&&(f.g=c+"."+f.g),ji(f,f.s);else{var A=u.location;f=A.protocol,c=c?c+"."+A.hostname:A.hostname,A=+A.port;var C=new Xt(null);f&&$i(C,f),c&&(C.g=c),A&&ji(C,A),h&&(C.l=h),f=C}return h=o.D,c=o.ya,h&&c&&ee(f,h,c),ee(f,"VER",o.la),Ur(o,f),f}function Rd(o,c,h){if(c&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=o.Ca&&!o.pa?new re(new xr({eb:h})):new re(o.pa),c.Ha(o.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Pd(){}n=Pd.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Yi(){}Yi.prototype.g=function(o,c){return new Ne(o,c)};function Ne(o,c){ye.call(this),this.g=new yd(c),this.l=o,this.h=c&&c.messageUrlParams||null,o=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(o?o["X-WebChannel-Content-Type"]=c.messageContentType:o={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(o?o["X-WebChannel-Client-Profile"]=c.va:o={"X-WebChannel-Client-Profile":c.va}),this.g.S=o,(o=c&&c.Sb)&&!U(o)&&(this.g.m=o),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!U(c)&&(this.g.D=c,o=this.h,o!==null&&c in o&&(o=this.h,c in o&&delete o[c])),this.j=new Nn(this)}D(Ne,ye),Ne.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ne.prototype.close=function(){Ia(this.g)},Ne.prototype.o=function(o){var c=this.g;if(typeof o=="string"){var h={};h.__data__=o,o=h}else this.u&&(h={},h.__data__=ca(o),o=h);c.i.push(new uy(c.Ya++,o)),c.G==3&&Ki(c)},Ne.prototype.N=function(){this.g.l=null,delete this.j,Ia(this.g),delete this.g,Ne.aa.N.call(this)};function Dd(o){la.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var c=o.__sm__;if(c){e:{for(let h in c){o=h;break e}o=void 0}(this.i=o)&&(o=this.i,c=c!==null&&o in c?c[o]:void 0),this.data=c}else this.data=o}D(Dd,la);function kd(){ha.call(this),this.status=1}D(kd,ha);function Nn(o){this.g=o}D(Nn,Pd),Nn.prototype.ua=function(){be(this.g,"a")},Nn.prototype.ta=function(o){be(this.g,new Dd(o))},Nn.prototype.sa=function(o){be(this.g,new kd)},Nn.prototype.ra=function(){be(this.g,"b")},Yi.prototype.createWebChannel=Yi.prototype.g,Ne.prototype.send=Ne.prototype.o,Ne.prototype.open=Ne.prototype.m,Ne.prototype.close=Ne.prototype.close,cc=mt.createWebChannelTransport=function(){return new Yi},ac=mt.getStatEventTarget=function(){return Li()},oc=mt.Event=Yt,fs=mt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ui.NO_ERROR=0,Ui.TIMEOUT=8,Ui.HTTP_ERROR=6,Hr=mt.ErrorCode=Ui,Hh.COMPLETE="complete",sc=mt.EventType=Hh,$h.EventType=Sr,Sr.OPEN="a",Sr.CLOSE="b",Sr.ERROR="c",Sr.MESSAGE="d",ye.prototype.listen=ye.prototype.K,Bn=mt.WebChannel=$h,Bv=mt.FetchXmlHttpFactory=xr,re.prototype.listenOnce=re.prototype.L,re.prototype.getLastError=re.prototype.Ka,re.prototype.getLastErrorCode=re.prototype.Ba,re.prototype.getStatus=re.prototype.Z,re.prototype.getResponseJson=re.prototype.Oa,re.prototype.getResponseText=re.prototype.oa,re.prototype.send=re.prototype.ea,re.prototype.setWithCredentials=re.prototype.Ha,ic=mt.XhrIo=re}).apply(typeof ds<"u"?ds:typeof self<"u"?self:typeof window<"u"?window:{});var Ef="@firebase/firestore",wf="4.7.14";var fe=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};fe.UNAUTHENTICATED=new fe(null),fe.GOOGLE_CREDENTIALS=new fe("google-credentials-uid"),fe.FIRST_PARTY=new fe("first-party-uid"),fe.MOCK_USER=new fe("mock-user");var ar="11.7.3";var dn=new Ze("@firebase/firestore");function qn(){return dn.logLevel}function O(n,...e){if(dn.logLevel<=G.DEBUG){let t=e.map(Ju);dn.debug(`Firestore (${ar}): ${n}`,...t)}}function gt(n,...e){if(dn.logLevel<=G.ERROR){let t=e.map(Ju);dn.error(`Firestore (${ar}): ${n}`,...t)}}function Kn(n,...e){if(dn.logLevel<=G.WARN){let t=e.map(Ju);dn.warn(`Firestore (${ar}): ${n}`,...t)}}function Ju(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function F(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,fp(n,r,t)}function fp(n,e,t){let r=`FIRESTORE (${ar}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw gt(r),new Error(r)}function Y(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||fp(e,i,r)}function B(n,e){return n}var R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},V=class extends Oe{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ze=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Is=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},fc=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(fe.UNAUTHENTICATED))}shutdown(){}},pc=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},mc=class{constructor(e){this.t=e,this.currentUser=fe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Y(this.o===void 0,42304);let r=this.i,i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve(),s=new ze;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ze,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let l=s;e.enqueueRetryable(()=>g(this,null,function*(){yield l.promise,yield i(this.currentUser)}))},u=l=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>u(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?u(l):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ze)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Y(typeof r.accessToken=="string",31837,{l:r}),new Is(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return Y(e===null||typeof e=="string",2055,{h:e}),new fe(e)}},gc=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=fe.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},_c=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new gc(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(fe.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Es=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},yc=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,De(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Y(this.o===void 0,3512);let r=s=>{s.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.m;return this.m=s.token,O("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?i(s):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Es(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Y(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Es(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function qv(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function pp(){return new TextEncoder}var ws=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=qv(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}};function j(n,e){return n<e?-1:n>e?1:0}function vc(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return j(r,i);{let s=pp(),a=$v(s.encode(Tf(n,t)),s.encode(Tf(e,t)));return a!==0?a:j(r,i)}}t+=r>65535?2:1}return j(n.length,e.length)}function Tf(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function $v(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return j(n[t],e[t]);return j(n.length,e.length)}function Qn(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Af=-62135596800,bf=1e6,ge=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*bf);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new V(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new V(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Af)throw new V(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new V(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/bf}_compareTo(e){return this.seconds===e.seconds?j(this.nanoseconds,e.nanoseconds):j(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds-Af;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var q=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new ge(0,0))}static max(){return new n(new ge(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Cf="__name__",Ts=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&F(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&F(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return j(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):vc(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return pt.fromString(e.substring(4,e.length-2))}},ne=class n extends Ts{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new V(R.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},jv=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Me=class n extends Ts{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return jv.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Cf}static keyField(){return new n([Cf])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new V(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new V(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new V(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(s(),i++)}if(s(),a)throw new V(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var M=class n{constructor(e){this.path=e}static fromPath(e){return new n(ne.fromString(e))}static fromName(e){return new n(ne.fromString(e).popFirst(5))}static empty(){return new n(ne.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ne.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ne.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ne(e.slice()))}};var Zr=-1,Ic=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Ic.UNKNOWN_ID=-1;function zv(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=q.fromTimestamp(r===1e9?new ge(t+1,0):new ge(t,r));return new fn(i,M.empty(),e)}function Gv(n){return new fn(n.readTime,n.key,Zr)}var fn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(q.min(),M.empty(),Zr)}static max(){return new n(q.max(),M.empty(),Zr)}};function Wv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=M.comparator(n.documentKey,e.documentKey),t!==0?t:j(n.largestBatchId,e.largestBatchId))}var Hv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ec=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function cr(n){return g(this,null,function*(){if(n.code!==R.FAILED_PRECONDITION||n.message!==Hv)throw n;O("LocalStore","Unexpectedly lost primary lease")})}var P=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&F(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++s,a&&s===i&&t()},l=>r(l))}),a=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,a=new Array(s),u=0;for(let l=0;l<s;l++){let d=l;t(e[d]).next(p=>{a[d]=p,++u,u===s&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function Kv(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ur(n){return n.name==="IndexedDbTransactionError"}var Xu=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ue(i),this.ce=i=>r.writeSequenceNumber(i))}ue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ce&&this.ce(t),t}}n.le=-1;return n})(),Zu=-1;function io(n){return n==null}function ei(n){return n===0&&1/n==-1/0}function Qv(n){return typeof n=="number"&&Number.isInteger(n)&&!ei(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var mp="";function Yv(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Sf(e)),e=Jv(n.get(t),e);return Sf(e)}function Jv(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case mp:t+="";break;default:t+=s}}return t}function Sf(n){return n+mp+""}var Xv="remoteDocuments",gp="owner";var _p="mutationQueues";var yp="mutations";var vp="documentMutations",Zv="remoteDocumentsV14";var Ip="remoteDocumentGlobal";var Ep="targets";var wp="targetDocuments";var Tp="targetGlobal",Ap="collectionParents";var bp="clientMetadata";var Cp="bundles";var Sp="namedQueries";var eI="indexConfiguration";var tI="indexState";var nI="indexEntries";var Rp="documentOverlays";var rI="globals";var iI=[_p,yp,vp,Xv,Ep,gp,Tp,wp,bp,Ip,Ap,Cp,Sp],b0=[...iI,Rp],sI=[_p,yp,vp,Zv,Ep,gp,Tp,wp,bp,Ip,Ap,Cp,Sp,Rp],oI=sI,aI=[...oI,eI,tI,nI];var C0=[...aI,rI];function Rf(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Bt(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Pp(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var se=class n{constructor(e,t){this.comparator=e,this.root=t||tt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,tt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,tt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Gn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Gn(this.root,e,this.comparator,!1)}getReverseIterator(){return new Gn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Gn(this.root,e,this.comparator,!0)}},Gn=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},tt=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw F(43730,{key:this.key,value:this.value});if(this.right.isRed())throw F(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw F(27949);return e+(this.isRed()?0:1)}};tt.EMPTY=null,tt.RED=!0,tt.BLACK=!1;tt.EMPTY=new class{constructor(){this.size=0}get key(){throw F(57766)}get value(){throw F(16141)}get color(){throw F(16727)}get left(){throw F(29726)}get right(){throw F(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new tt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var pe=class n{constructor(e){this.comparator=e,this.data=new se(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new As(this.data.getIterator())}getIteratorFrom(e){return new As(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},As=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Be=class n{constructor(e){this.fields=e,e.sort(Me.comparator)}static empty(){return new n([])}unionWith(e){let t=new pe(Me.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Qn(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var bs=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Te=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new bs("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return j(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Te.EMPTY_BYTE_STRING=new Te("");var cI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _t(n){if(Y(!!n,39018),typeof n=="string"){let e=0,t=cI.exec(n);if(Y(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:te(n.seconds),nanos:te(n.nanos)}}function te(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function yt(n){return typeof n=="string"?Te.fromBase64String(n):Te.fromUint8Array(n)}var Dp="server_timestamp",kp="__type__",Np="__previous_value__",Vp="__local_write_time__";function el(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[kp])===null||t===void 0?void 0:t.stringValue)===Dp}function so(n){let e=n.mapValue.fields[Np];return el(e)?so(e):e}function ti(n){let e=_t(n.mapValue.fields[Vp].timestampValue);return new ge(e.seconds,e.nanos)}var wc=class{constructor(e,t,r,i,s,a,u,l,d,p){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=l,this.useFetchStreams=d,this.isUsingEmulator=p}},Cs="(default)",Ss=class n{constructor(e,t){this.projectId=e,this.database=t||Cs}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Cs}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var tl="__type__",Op="__max__",ps={mapValue:{fields:{__type__:{stringValue:Op}}}},nl="__vector__",Yn="value";function Mt(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?el(n)?4:Mp(n)?9007199254740991:xp(n)?10:11:F(28295,{value:n})}function st(n,e){if(n===e)return!0;let t=Mt(n);if(t!==Mt(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ti(n).isEqual(ti(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let a=_t(i.timestampValue),u=_t(s.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return yt(i.bytesValue).isEqual(yt(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return te(i.geoPointValue.latitude)===te(s.geoPointValue.latitude)&&te(i.geoPointValue.longitude)===te(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return te(i.integerValue)===te(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let a=te(i.doubleValue),u=te(s.doubleValue);return a===u?ei(a)===ei(u):isNaN(a)&&isNaN(u)}return!1}(n,e);case 9:return Qn(n.arrayValue.values||[],e.arrayValue.values||[],st);case 10:case 11:return function(i,s){let a=i.mapValue.fields||{},u=s.mapValue.fields||{};if(Rf(a)!==Rf(u))return!1;for(let l in a)if(a.hasOwnProperty(l)&&(u[l]===void 0||!st(a[l],u[l])))return!1;return!0}(n,e);default:return F(52216,{left:n})}}function ni(n,e){return(n.values||[]).find(t=>st(t,e))!==void 0}function Jn(n,e){if(n===e)return 0;let t=Mt(n),r=Mt(e);if(t!==r)return j(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return j(n.booleanValue,e.booleanValue);case 2:return function(s,a){let u=te(s.integerValue||s.doubleValue),l=te(a.integerValue||a.doubleValue);return u<l?-1:u>l?1:u===l?0:isNaN(u)?isNaN(l)?0:-1:1}(n,e);case 3:return Pf(n.timestampValue,e.timestampValue);case 4:return Pf(ti(n),ti(e));case 5:return vc(n.stringValue,e.stringValue);case 6:return function(s,a){let u=yt(s),l=yt(a);return u.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){let u=s.split("/"),l=a.split("/");for(let d=0;d<u.length&&d<l.length;d++){let p=j(u[d],l[d]);if(p!==0)return p}return j(u.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){let u=j(te(s.latitude),te(a.latitude));return u!==0?u:j(te(s.longitude),te(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Df(n.arrayValue,e.arrayValue);case 10:return function(s,a){var u,l,d,p;let v=s.fields||{},I=a.fields||{},S=(u=v[Yn])===null||u===void 0?void 0:u.arrayValue,D=(l=I[Yn])===null||l===void 0?void 0:l.arrayValue,x=j(((d=S?.values)===null||d===void 0?void 0:d.length)||0,((p=D?.values)===null||p===void 0?void 0:p.length)||0);return x!==0?x:Df(S,D)}(n.mapValue,e.mapValue);case 11:return function(s,a){if(s===ps.mapValue&&a===ps.mapValue)return 0;if(s===ps.mapValue)return 1;if(a===ps.mapValue)return-1;let u=s.fields||{},l=Object.keys(u),d=a.fields||{},p=Object.keys(d);l.sort(),p.sort();for(let v=0;v<l.length&&v<p.length;++v){let I=vc(l[v],p[v]);if(I!==0)return I;let S=Jn(u[l[v]],d[p[v]]);if(S!==0)return S}return j(l.length,p.length)}(n.mapValue,e.mapValue);default:throw F(23264,{Pe:t})}}function Pf(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return j(n,e);let t=_t(n),r=_t(e),i=j(t.seconds,r.seconds);return i!==0?i:j(t.nanos,r.nanos)}function Df(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=Jn(t[i],r[i]);if(s)return s}return j(t.length,r.length)}function Xn(n){return Tc(n)}function Tc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=_t(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return yt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return M.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=Tc(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let a of r)s?s=!1:i+=",",i+=`${a}:${Tc(t.fields[a])}`;return i+"}"}(n.mapValue):F(61005,{value:n})}function _s(n){switch(Mt(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=so(n);return e?16+_s(e):16;case 5:return 2*n.stringValue.length;case 6:return yt(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+_s(s),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return Bt(r.fields,(s,a)=>{i+=s.length+_s(a)}),i}(n.mapValue);default:throw F(13486,{value:n})}}function kf(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Ac(n){return!!n&&"integerValue"in n}function rl(n){return!!n&&"arrayValue"in n}function Nf(n){return!!n&&"nullValue"in n}function Vf(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ys(n){return!!n&&"mapValue"in n}function xp(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[tl])===null||t===void 0?void 0:t.stringValue)===nl}function Qr(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Bt(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Qr(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Qr(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Mp(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Op}var R0={mapValue:{fields:{[tl]:{stringValue:nl},[Yn]:{arrayValue:{}}}}};var xe=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ys(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Qr(t)}setAll(e){let t=Me.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=Qr(a):i.push(u.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());ys(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return st(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];ys(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Bt(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Qr(this.value))}};function Fp(n){let e=[];return Bt(n.fields,(t,r)=>{let i=new Me([t]);if(ys(r)){let s=Fp(r.mapValue).fields;if(s.length===0)e.push(i);else for(let a of s)e.push(i.child(a))}else e.push(i)}),new Be(e)}var Ge=class n{constructor(e,t,r,i,s,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,q.min(),q.min(),q.min(),xe.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,q.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,q.min(),q.min(),xe.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,q.min(),q.min(),xe.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=xe.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=xe.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Zn=class{constructor(e,t){this.position=e,this.inclusive=t}};function Of(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],a=n.position[i];if(s.field.isKeyField()?r=M.comparator(M.fromName(a.referenceValue),t.key):r=Jn(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function xf(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!st(n.position[t],e.position[t]))return!1;return!0}var pn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function uI(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Rs=class{},le=class n extends Rs{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Cc(e,t,r):t==="array-contains"?new Pc(e,r):t==="in"?new Dc(e,r):t==="not-in"?new kc(e,r):t==="array-contains-any"?new Nc(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Sc(e,r):new Rc(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Jn(t,this.value)):t!==null&&Mt(this.value)===Mt(t)&&this.matchesComparison(Jn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return F(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},We=class n extends Rs{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new n(e,t)}matches(e){return Lp(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}};function Lp(n){return n.op==="and"}function Up(n){return lI(n)&&Lp(n)}function lI(n){for(let e of n.filters)if(e instanceof We)return!1;return!0}function bc(n){if(n instanceof le)return n.field.canonicalString()+n.op.toString()+Xn(n.value);if(Up(n))return n.filters.map(e=>bc(e)).join(",");{let e=n.filters.map(t=>bc(t)).join(",");return`${n.op}(${e})`}}function Bp(n,e){return n instanceof le?function(r,i){return i instanceof le&&r.op===i.op&&r.field.isEqual(i.field)&&st(r.value,i.value)}(n,e):n instanceof We?function(r,i){return i instanceof We&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,u)=>s&&Bp(a,i.filters[u]),!0):!1}(n,e):void F(19439)}function qp(n){return n instanceof le?function(t){return`${t.field.canonicalString()} ${t.op} ${Xn(t.value)}`}(n):n instanceof We?function(t){return t.op.toString()+" {"+t.getFilters().map(qp).join(" ,")+"}"}(n):"Filter"}var Cc=class extends le{constructor(e,t,r){super(e,t,r),this.key=M.fromName(r.referenceValue)}matches(e){let t=M.comparator(e.key,this.key);return this.matchesComparison(t)}},Sc=class extends le{constructor(e,t){super(e,"in",t),this.keys=$p("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Rc=class extends le{constructor(e,t){super(e,"not-in",t),this.keys=$p("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function $p(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>M.fromName(r.referenceValue))}var Pc=class extends le{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return rl(t)&&ni(t.arrayValue,this.value)}},Dc=class extends le{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&ni(this.value.arrayValue,t)}},kc=class extends le{constructor(e,t){super(e,"not-in",t)}matches(e){if(ni(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ni(this.value.arrayValue,t)}},Nc=class extends le{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!rl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>ni(this.value.arrayValue,r))}};var Vc=class{constructor(e,t=null,r=[],i=[],s=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=u,this.Ie=null}};function Mf(n,e=null,t=[],r=[],i=null,s=null,a=null){return new Vc(n,e,t,r,i,s,a)}function il(n){let e=B(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>bc(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),io(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Xn(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Xn(r)).join(",")),e.Ie=t}return e.Ie}function sl(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!uI(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Bp(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!xf(n.startAt,e.startAt)&&xf(n.endAt,e.endAt)}function Oc(n){return M.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Ft=class{constructor(e,t=null,r=[],i=[],s=null,a="F",u=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=u,this.endAt=l,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}};function hI(n,e,t,r,i,s,a,u){return new Ft(n,e,t,r,i,s,a,u)}function ol(n){return new Ft(n)}function Ff(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function jp(n){return n.collectionGroup!==null}function Yr(n){let e=B(n);if(e.Ee===null){e.Ee=[];let t=new Set;for(let s of e.explicitOrderBy)e.Ee.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new pe(Me.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ee.push(new pn(s,r))}),t.has(Me.keyField().canonicalString())||e.Ee.push(new pn(Me.keyField(),r))}return e.Ee}function nt(n){let e=B(n);return e.de||(e.de=dI(e,Yr(n))),e.de}function dI(n,e){if(n.limitType==="F")return Mf(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new pn(i.field,s)});let t=n.endAt?new Zn(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Zn(n.startAt.position,n.startAt.inclusive):null;return Mf(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function xc(n,e){let t=n.filters.concat([e]);return new Ft(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Mc(n,e,t){return new Ft(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function oo(n,e){return sl(nt(n),nt(e))&&n.limitType===e.limitType}function zp(n){return`${il(nt(n))}|lt:${n.limitType}`}function $n(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>qp(i)).join(", ")}]`),io(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Xn(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Xn(i)).join(",")),`Target(${r})`}(nt(n))}; limitType=${n.limitType})`}function ao(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):M.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of Yr(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,u,l){let d=Of(a,u,l);return a.inclusive?d<=0:d<0}(r.startAt,Yr(r),i)||r.endAt&&!function(a,u,l){let d=Of(a,u,l);return a.inclusive?d>=0:d>0}(r.endAt,Yr(r),i))}(n,e)}function fI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Gp(n){return(e,t)=>{let r=!1;for(let i of Yr(n)){let s=pI(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function pI(n,e,t){let r=n.field.isKeyField()?M.comparator(e.key,t.key):function(s,a,u){let l=a.data.field(s),d=u.data.field(s);return l!==null&&d!==null?Jn(l,d):F(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return F(19790,{direction:n.dir})}}var vt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Bt(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return Pp(this.inner)}size(){return this.innerSize}};var mI=new se(M.comparator);function It(){return mI}var Wp=new se(M.comparator);function Kr(...n){let e=Wp;for(let t of n)e=e.insert(t.key,t);return e}function Hp(n){let e=Wp;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function un(){return Jr()}function Kp(){return Jr()}function Jr(){return new vt(n=>n.toString(),(n,e)=>n.isEqual(e))}var gI=new se(M.comparator),_I=new pe(M.comparator);function W(...n){let e=_I;for(let t of n)e=e.add(t);return e}var yI=new pe(j);function vI(){return yI}function al(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ei(e)?"-0":e}}function Qp(n){return{integerValue:""+n}}function II(n,e){return Qv(e)?Qp(e):al(n,e)}var er=class{constructor(){this._=void 0}};function EI(n,e,t){return n instanceof tr?function(i,s){let a={fields:{[kp]:{stringValue:Dp},[Vp]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&el(s)&&(s=so(s)),s&&(a.fields[Np]=s),{mapValue:a}}(t,e):n instanceof mn?Jp(n,e):n instanceof gn?Xp(n,e):function(i,s){let a=Yp(i,s),u=Lf(a)+Lf(i.Re);return Ac(a)&&Ac(i.Re)?Qp(u):al(i.serializer,u)}(n,e)}function wI(n,e,t){return n instanceof mn?Jp(n,e):n instanceof gn?Xp(n,e):t}function Yp(n,e){return n instanceof nr?function(r){return Ac(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var tr=class extends er{},mn=class extends er{constructor(e){super(),this.elements=e}};function Jp(n,e){let t=Zp(e);for(let r of n.elements)t.some(i=>st(i,r))||t.push(r);return{arrayValue:{values:t}}}var gn=class extends er{constructor(e){super(),this.elements=e}};function Xp(n,e){let t=Zp(e);for(let r of n.elements)t=t.filter(i=>!st(i,r));return{arrayValue:{values:t}}}var nr=class extends er{constructor(e,t){super(),this.serializer=e,this.Re=t}};function Lf(n){return te(n.integerValue||n.doubleValue)}function Zp(n){return rl(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function TI(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof mn&&i instanceof mn||r instanceof gn&&i instanceof gn?Qn(r.elements,i.elements,st):r instanceof nr&&i instanceof nr?st(r.Re,i.Re):r instanceof tr&&i instanceof tr}(n.transform,e.transform)}var Fc=class{constructor(e,t){this.version=e,this.transformResults=t}},rt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function vs(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var rr=class{};function em(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ri(n.key,rt.none()):new _n(n.key,n.data,rt.none());{let t=n.data,r=xe.empty(),i=new pe(Me.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new ot(n.key,r,new Be(i.toArray()),rt.none())}}function AI(n,e,t){n instanceof _n?function(i,s,a){let u=i.value.clone(),l=Bf(i.fieldTransforms,s,a.transformResults);u.setAll(l),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):n instanceof ot?function(i,s,a){if(!vs(i.precondition,s))return void s.convertToUnknownDocument(a.version);let u=Bf(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(tm(i)),l.setAll(u),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function Xr(n,e,t,r){return n instanceof _n?function(s,a,u,l){if(!vs(s.precondition,a))return u;let d=s.value.clone(),p=qf(s.fieldTransforms,l,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof ot?function(s,a,u,l){if(!vs(s.precondition,a))return u;let d=qf(s.fieldTransforms,l,a),p=a.data;return p.setAll(tm(s)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(v=>v.field))}(n,e,t,r):function(s,a,u){return vs(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(n,e,t)}function bI(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=Yp(r.transform,i||null);s!=null&&(t===null&&(t=xe.empty()),t.set(r.field,s))}return t||null}function Uf(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Qn(r,i,(s,a)=>TI(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var _n=class extends rr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},ot=class extends rr{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function tm(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Bf(n,e,t){let r=new Map;Y(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let i=0;i<t.length;i++){let s=n[i],a=s.transform,u=e.data.field(s.field);r.set(s.field,wI(a,u,t[i]))}return r}function qf(n,e,t){let r=new Map;for(let i of n){let s=i.transform,a=t.data.field(i.field);r.set(i.field,EI(s,a,e))}return r}var ri=class extends rr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Lc=class extends rr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Uc=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&AI(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Xr(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Xr(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Kp();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,u=this.applyToLocalView(a,s.mutatedFields);u=t.has(i.key)?null:u;let l=em(a,u);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(q.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),W())}isEqual(e){return this.batchId===e.batchId&&Qn(this.mutations,e.mutations,(t,r)=>Uf(t,r))&&Qn(this.baseMutations,e.baseMutations,(t,r)=>Uf(t,r))}},Bc=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Y(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let i=function(){return gI}(),s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new n(e,t,r,i)}};var qc=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var $c=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ce,H;function CI(n){switch(n){case R.OK:return F(64938);case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0;default:return F(15467,{code:n})}}function nm(n){if(n===void 0)return gt("GRPC error has no .code"),R.UNKNOWN;switch(n){case ce.OK:return R.OK;case ce.CANCELLED:return R.CANCELLED;case ce.UNKNOWN:return R.UNKNOWN;case ce.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case ce.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case ce.INTERNAL:return R.INTERNAL;case ce.UNAVAILABLE:return R.UNAVAILABLE;case ce.UNAUTHENTICATED:return R.UNAUTHENTICATED;case ce.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case ce.NOT_FOUND:return R.NOT_FOUND;case ce.ALREADY_EXISTS:return R.ALREADY_EXISTS;case ce.PERMISSION_DENIED:return R.PERMISSION_DENIED;case ce.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case ce.ABORTED:return R.ABORTED;case ce.OUT_OF_RANGE:return R.OUT_OF_RANGE;case ce.UNIMPLEMENTED:return R.UNIMPLEMENTED;case ce.DATA_LOSS:return R.DATA_LOSS;default:return F(39323,{code:n})}}(H=ce||(ce={}))[H.OK=0]="OK",H[H.CANCELLED=1]="CANCELLED",H[H.UNKNOWN=2]="UNKNOWN",H[H.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",H[H.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",H[H.NOT_FOUND=5]="NOT_FOUND",H[H.ALREADY_EXISTS=6]="ALREADY_EXISTS",H[H.PERMISSION_DENIED=7]="PERMISSION_DENIED",H[H.UNAUTHENTICATED=16]="UNAUTHENTICATED",H[H.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",H[H.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",H[H.ABORTED=10]="ABORTED",H[H.OUT_OF_RANGE=11]="OUT_OF_RANGE",H[H.UNIMPLEMENTED=12]="UNIMPLEMENTED",H[H.INTERNAL=13]="INTERNAL",H[H.UNAVAILABLE=14]="UNAVAILABLE",H[H.DATA_LOSS=15]="DATA_LOSS";var $f=null;var SI=new pt([4294967295,4294967295],0);function jf(n){let e=pp().encode(n),t=new rc;return t.update(e),new Uint8Array(t.digest())}function zf(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new pt([t,r],0),new pt([i,s],0)]}var jc=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ln(`Invalid padding: ${t}`);if(r<0)throw new ln(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ln(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ln(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=pt.fromNumber(this.pe)}we(e,t,r){let i=e.add(t.multiply(pt.fromNumber(r)));return i.compare(SI)===1&&(i=new pt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;let t=jf(e),[r,i]=zf(t);for(let s=0;s<this.hashCount;s++){let a=this.we(r,i,s);if(!this.be(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new n(s,i,t);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.pe===0)return;let t=jf(e),[r,i]=zf(t);for(let s=0;s<this.hashCount;s++){let a=this.we(r,i,s);this.Se(a)}}Se(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},ln=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Ps=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,ii.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(q.min(),i,new se(j),It(),W())}},ii=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,W(),W(),W())}};var Wn=class{constructor(e,t,r,i){this.De=e,this.removedTargetIds=t,this.key=r,this.ve=i}},Ds=class{constructor(e,t){this.targetId=e,this.Ce=t}},ks=class{constructor(e,t,r=Te.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Ns=class{constructor(){this.Fe=0,this.Me=Gf(),this.xe=Te.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=W(),t=W(),r=W();return this.Me.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:F(38017,{changeType:s})}}),new ii(this.xe,this.Oe,e,t,r)}Qe(){this.Ne=!1,this.Me=Gf()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Y(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}},zc=class{constructor(e){this.ze=e,this.je=new Map,this.He=It(),this.Je=ms(),this.Ye=ms(),this.Ze=new se(j)}Xe(e){for(let t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(let t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{let r=this.rt(t);switch(e.state){case 0:this.it(t)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(t);break;case 3:this.it(t)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),r.ke(e.resumeToken));break;default:F(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((r,i)=>{this.it(i)&&t(i)})}ot(e){let t=e.targetId,r=e.Ce.count,i=this._t(t);if(i){let s=i.target;if(Oc(s))if(r===0){let a=new M(s.path);this.tt(t,a,Ge.newNoDocument(a,q.min()))}else Y(r===1,20013,{expectedCount:r});else{let a=this.ut(t);if(a!==r){let u=this.ct(e),l=u?this.lt(u,e,a):1;if(l!==0){this.st(t);let d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,d)}$f?.ht(function(p,v,I,S,D){var x,k,z,U,$,X;let Ae={localCacheCount:p,existenceFilterCount:v.count,databaseId:I.database,projectId:I.projectId},J=v.unchangedNames;return J&&(Ae.bloomFilter={applied:D===0,hashCount:(x=J?.hashCount)!==null&&x!==void 0?x:0,bitmapLength:(U=(z=(k=J?.bits)===null||k===void 0?void 0:k.bitmap)===null||z===void 0?void 0:z.length)!==null&&U!==void 0?U:0,padding:(X=($=J?.bits)===null||$===void 0?void 0:$.padding)!==null&&X!==void 0?X:0,mightContain:w=>{var m;return(m=S?.mightContain(w))!==null&&m!==void 0&&m}}),Ae}(a,e.Ce,this.ze.Pt(),u,l))}}}}ct(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,a,u;try{a=yt(r).toUint8Array()}catch(l){if(l instanceof bs)return Kn("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{u=new jc(a,i,s)}catch(l){return Kn(l instanceof ln?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return u.pe===0?null:u}lt(e,t,r){return t.Ce.count===r-this.Tt(e,t.targetId)?0:2}Tt(e,t){let r=this.ze.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let a=this.ze.Pt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.tt(t,s,null),i++)}),i}It(e){let t=new Map;this.je.forEach((s,a)=>{let u=this._t(a);if(u){if(s.current&&Oc(u.target)){let l=new M(u.target.path);this.Et(l).has(a)||this.dt(a,l)||this.tt(a,l,Ge.newNoDocument(l,e))}s.Le&&(t.set(a,s.qe()),s.Qe())}});let r=W();this.Ye.forEach((s,a)=>{let u=!0;a.forEachWhile(l=>{let d=this._t(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.He.forEach((s,a)=>a.setReadTime(e));let i=new Ps(e,t,this.Ze,this.He,r);return this.He=It(),this.Je=ms(),this.Ye=ms(),this.Ze=new se(j),i}et(e,t){if(!this.it(e))return;let r=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,r),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,r){if(!this.it(e))return;let i=this.rt(e);this.dt(e,t)?i.$e(t,1):i.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),r&&(this.He=this.He.insert(t,r))}removeTarget(e){this.je.delete(e)}ut(e){let t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new Ns,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new pe(j),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new pe(j),this.Je=this.Je.insert(e,t)),t}it(e){let t=this._t(e)!==null;return t||O("WatchChangeAggregator","Detected inactive target",e),t}_t(e){let t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new Ns),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}};function ms(){return new se(M.comparator)}function Gf(){return new se(M.comparator)}var RI={asc:"ASCENDING",desc:"DESCENDING"},PI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},DI={and:"AND",or:"OR"},Gc=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Wc(n,e){return n.useProto3Json||io(e)?e:{value:e}}function Vs(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function rm(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function kI(n,e){return Vs(n,e.toTimestamp())}function it(n){return Y(!!n,49232),q.fromTimestamp(function(t){let r=_t(t);return new ge(r.seconds,r.nanos)}(n))}function cl(n,e){return Hc(n,e).canonicalString()}function Hc(n,e){let t=function(i){return new ne(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function im(n){let e=ne.fromString(n);return Y(um(e),10190,{key:e.toString()}),e}function Kc(n,e){return cl(n.databaseId,e.path)}function uc(n,e){let t=im(e);if(t.get(1)!==n.databaseId.projectId)throw new V(R.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new V(R.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new M(om(t))}function sm(n,e){return cl(n.databaseId,e)}function NI(n){let e=im(n);return e.length===4?ne.emptyPath():om(e)}function Qc(n){return new ne(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function om(n){return Y(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Wf(n,e,t){return{name:Kc(n,e),fields:t.value.mapValue.fields}}function VI(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:F(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,p){return d.useProto3Json?(Y(p===void 0||typeof p=="string",58123),Te.fromBase64String(p||"")):(Y(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),Te.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(d){let p=d.code===void 0?R.UNKNOWN:nm(d.code);return new V(p,d.message||"")}(a);t=new ks(r,i,s,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=uc(n,r.document.name),s=it(r.document.updateTime),a=r.document.createTime?it(r.document.createTime):q.min(),u=new xe({mapValue:{fields:r.document.fields}}),l=Ge.newFoundDocument(i,s,a,u),d=r.targetIds||[],p=r.removedTargetIds||[];t=new Wn(d,p,l.key,l)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=uc(n,r.document),s=r.readTime?it(r.readTime):q.min(),a=Ge.newNoDocument(i,s),u=r.removedTargetIds||[];t=new Wn([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=uc(n,r.document),s=r.removedTargetIds||[];t=new Wn([],s,i,null)}else{if(!("filter"in e))return F(11601,{Vt:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,a=new $c(i,s),u=r.targetId;t=new Ds(u,a)}}return t}function OI(n,e){let t;if(e instanceof _n)t={update:Wf(n,e.key,e.value)};else if(e instanceof ri)t={delete:Kc(n,e.key)};else if(e instanceof ot)t={update:Wf(n,e.key,e.data),updateMask:jI(e.fieldMask)};else{if(!(e instanceof Lc))return F(16599,{ft:e.type});t={verify:Kc(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){let u=a.transform;if(u instanceof tr)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof mn)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof gn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof nr)return{fieldPath:a.field.canonicalString(),increment:u.Re};throw F(20930,{transform:a.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:kI(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:F(27497)}(n,e.precondition)),t}function xI(n,e){return n&&n.length>0?(Y(e!==void 0,14353),n.map(t=>function(i,s){let a=i.updateTime?it(i.updateTime):it(s);return a.isEqual(q.min())&&(a=it(s)),new Fc(a,i.transformResults||[])}(t,e))):[]}function MI(n,e){return{documents:[sm(n,e.path)]}}function FI(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=sm(n,i);let s=function(d){if(d.length!==0)return cm(We.create(d,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let a=function(d){if(d.length!==0)return d.map(p=>function(I){return{field:jn(I.field),direction:BI(I.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let u=Wc(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{gt:t,parent:i}}function LI(n){let e=NI(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){Y(r===1,65062);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(v){let I=am(v);return I instanceof We&&Up(I)?I.getFilters():[I]}(t.where));let a=[];t.orderBy&&(a=function(v){return v.map(I=>function(D){return new pn(zn(D.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(D.direction))}(I))}(t.orderBy));let u=null;t.limit&&(u=function(v){let I;return I=typeof v=="object"?v.value:v,io(I)?null:I}(t.limit));let l=null;t.startAt&&(l=function(v){let I=!!v.before,S=v.values||[];return new Zn(S,I)}(t.startAt));let d=null;return t.endAt&&(d=function(v){let I=!v.before,S=v.values||[];return new Zn(S,I)}(t.endAt)),hI(e,i,a,s,u,"F",l,d)}function UI(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return F(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function am(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=zn(t.unaryFilter.field);return le.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=zn(t.unaryFilter.field);return le.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=zn(t.unaryFilter.field);return le.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=zn(t.unaryFilter.field);return le.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return F(61313);default:return F(60726)}}(n):n.fieldFilter!==void 0?function(t){return le.create(zn(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return F(58110);default:return F(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return We.create(t.compositeFilter.filters.map(r=>am(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return F(1026)}}(t.compositeFilter.op))}(n):F(30097,{filter:n})}function BI(n){return RI[n]}function qI(n){return PI[n]}function $I(n){return DI[n]}function jn(n){return{fieldPath:n.canonicalString()}}function zn(n){return Me.fromServerFormat(n.fieldPath)}function cm(n){return n instanceof le?function(t){if(t.op==="=="){if(Vf(t.value))return{unaryFilter:{field:jn(t.field),op:"IS_NAN"}};if(Nf(t.value))return{unaryFilter:{field:jn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Vf(t.value))return{unaryFilter:{field:jn(t.field),op:"IS_NOT_NAN"}};if(Nf(t.value))return{unaryFilter:{field:jn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jn(t.field),op:qI(t.op),value:t.value}}}(n):n instanceof We?function(t){let r=t.getFilters().map(i=>cm(i));return r.length===1?r[0]:{compositeFilter:{op:$I(t.op),filters:r}}}(n):F(54877,{filter:n})}function jI(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function um(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var si=class n{constructor(e,t,r,i,s=q.min(),a=q.min(),u=Te.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Yc=class{constructor(e){this.wt=e}};function zI(n){let e=LI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Mc(e,e.limit,"L"):e}var Os=class{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(te(e.integerValue));else if("doubleValue"in e){let r=te(e.doubleValue);isNaN(r)?this.Mt(t,13):(this.Mt(t,15),ei(r)?t.xt(0):t.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(t,20),typeof r=="string"&&(r=_t(r)),t.Ot(`${r.seconds||""}`),t.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(yt(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Mt(t,45),t.xt(r.latitude||0),t.xt(r.longitude||0)}else"mapValue"in e?Mp(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):xp(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):F(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){let r=e.fields||{};this.Mt(t,55);for(let i of Object.keys(r))this.Nt(i,t),this.Ct(r[i],t)}qt(e,t){var r,i;let s=e.fields||{};this.Mt(t,53);let a=Yn,u=((i=(r=s[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Mt(t,15),t.xt(te(u)),this.Nt(a,t),this.Ct(s[a],t)}$t(e,t){let r=e.values||[];this.Mt(t,50);for(let i of r)this.Ct(i,t)}kt(e,t){this.Mt(t,37),M.fromName(e).path.forEach(r=>{this.Mt(t,60),this.Kt(r,t)})}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}};Os.Wt=new Os;var Jc=class{constructor(){this.yn=new Xc}addToCollectionParentIndex(e,t){return this.yn.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this.yn.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(fn.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(fn.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}},Xc=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new pe(ne.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new pe(ne.comparator)).toArray()}};var P0=new Uint8Array(0);var Hf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},lm=41943040,Ue=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};Ue.DEFAULT_COLLECTION_PERCENTILE=10,Ue.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ue.DEFAULT=new Ue(lm,Ue.DEFAULT_COLLECTION_PERCENTILE,Ue.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ue.DISABLED=new Ue(-1,0,0);var oi=class n{constructor(e){this.nr=e}next(){return this.nr+=2,this.nr}static rr(){return new n(0)}static ir(){return new n(-1)}};var Kf="LruGarbageCollector",GI=1048576;function Qf([n,e],[t,r]){let i=j(n,t);return i===0?j(e,r):i}var Zc=class{constructor(e){this.cr=e,this.buffer=new pe(Qf),this.lr=0}hr(){return++this.lr}Pr(e){let t=[e,this.hr()];if(this.buffer.size<this.cr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();Qf(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},eu=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Tr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ir(6e4)}stop(){this.Tr&&(this.Tr.cancel(),this.Tr=null)}get started(){return this.Tr!==null}Ir(e){O(Kf,`Garbage collection scheduled in ${e}ms`),this.Tr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>g(this,null,function*(){this.Tr=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){ur(t)?O(Kf,"Ignoring IndexedDB error during garbage collection: ",t):yield cr(t)}yield this.Ir(3e5)}))}},tu=class{constructor(e,t){this.Er=e,this.params=t}calculateTargetCount(e,t){return this.Er.dr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return P.resolve(Xu.le);let r=new Zc(t);return this.Er.forEachTarget(e,i=>r.Pr(i.sequenceNumber)).next(()=>this.Er.Ar(e,i=>r.Pr(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Er.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Er.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(O("LruGarbageCollector","Garbage collection skipped; disabled"),P.resolve(Hf)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(O("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Hf):this.Rr(e,t))}getCacheSize(e){return this.Er.getCacheSize(e)}Rr(e,t){let r,i,s,a,u,l,d,p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(v=>(v>this.params.maximumSequenceNumbersToCollect?(O("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),i=this.params.maximumSequenceNumbersToCollect):i=v,a=Date.now(),this.nthSequenceNumber(e,i))).next(v=>(r=v,u=Date.now(),this.removeTargets(e,r,t))).next(v=>(s=v,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(v=>(d=Date.now(),qn()<=G.DEBUG&&O("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-p}ms
	Determined least recently used ${i} in `+(u-a)+`ms
	Removed ${s} targets in `+(l-u)+`ms
	Removed ${v} documents in `+(d-l)+`ms
Total Duration: ${d-p}ms`),P.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:v})))}};function WI(n,e){return new tu(n,e)}var nu=class{constructor(){this.changes=new vt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ge.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var ru=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var iu=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Xr(r.mutation,i,Be.empty(),ge.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,W()).next(()=>r))}getLocalViewOfDocuments(e,t,r=W()){let i=un();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=Kr();return s.forEach((u,l)=>{a=a.insert(u,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=un();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,W()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let s=It(),a=Jr(),u=function(){return Jr()}();return t.forEach((l,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof ot)?s=s.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),Xr(p.mutation,d,p.mutation.getFieldMask(),ge.now())):a.set(d.key,Be.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var v;return u.set(d,new ru(p,(v=a.get(d))!==null&&v!==void 0?v:null))}),u))}recalculateAndSaveOverlays(e,t){let r=Jr(),i=new se((a,u)=>a-u),s=W();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(l=>{let d=t.get(l);if(d===null)return;let p=r.get(l)||Be.empty();p=u.applyToLocalView(d,p),r.set(l,p);let v=(i.get(u.batchId)||W()).add(l);i=i.insert(u.batchId,v)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let l=u.getNext(),d=l.key,p=l.value,v=Kp();p.forEach(I=>{if(!s.has(I)){let S=em(t.get(I),r.get(I));S!==null&&v.set(I,S),s=s.add(I)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,v))}return P.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return M.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):jp(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):P.resolve(un()),u=Zr,l=s;return a.next(d=>P.forEach(d,(p,v)=>(u<v.largestBatchId&&(u=v.largestBatchId),s.get(p)?P.resolve():this.remoteDocumentCache.getEntry(e,p).next(I=>{l=l.insert(p,I)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,l,d,W())).next(p=>({batchId:u,changes:Hp(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new M(t)).next(r=>{let i=Kr();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,a=Kr();return this.indexManager.getCollectionParents(e,s).next(u=>P.forEach(u,l=>{let d=function(v,I){return new Ft(I,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((v,I)=>{a=a.insert(v,I)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((l,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,Ge.newInvalidDocument(p)))});let u=Kr();return a.forEach((l,d)=>{let p=s.get(l);p!==void 0&&Xr(p.mutation,d,Be.empty(),ge.now()),ao(t,d)&&(u=u.insert(l,d))}),u})}};var su=class{constructor(e){this.serializer=e,this.Fr=new Map,this.Mr=new Map}getBundleMetadata(e,t){return P.resolve(this.Fr.get(t))}saveBundleMetadata(e,t){return this.Fr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:it(i.createTime)}}(t)),P.resolve()}getNamedQuery(e,t){return P.resolve(this.Mr.get(t))}saveNamedQuery(e,t){return this.Mr.set(t.name,function(i){return{name:i.name,query:zI(i.bundledQuery),readTime:it(i.readTime)}}(t)),P.resolve()}};var ou=class{constructor(){this.overlays=new se(M.comparator),this.Or=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){let r=un();return P.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.St(e,t,s)}),P.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Or.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Or.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){let i=un(),s=t.length+1,a=new M(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let l=u.getNext().value,d=l.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return P.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new se((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=s.get(d.largestBatchId);p===null&&(p=un(),s=s.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let u=un(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return P.resolve(u)}St(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Or.get(i.largestBatchId).delete(r.key);this.Or.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new qc(t,r));let s=this.Or.get(t);s===void 0&&(s=W(),this.Or.set(t,s)),this.Or.set(t,s.add(r.key))}};var au=class{constructor(){this.sessionToken=Te.EMPTY_BYTE_STRING}getSessionToken(e){return P.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,P.resolve()}};var ai=class{constructor(){this.Nr=new pe(ue.Br),this.Lr=new pe(ue.kr)}isEmpty(){return this.Nr.isEmpty()}addReference(e,t){let r=new ue(e,t);this.Nr=this.Nr.add(r),this.Lr=this.Lr.add(r)}qr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Qr(new ue(e,t))}$r(e,t){e.forEach(r=>this.removeReference(r,t))}Ur(e){let t=new M(new ne([])),r=new ue(t,e),i=new ue(t,e+1),s=[];return this.Lr.forEachInRange([r,i],a=>{this.Qr(a),s.push(a.key)}),s}Kr(){this.Nr.forEach(e=>this.Qr(e))}Qr(e){this.Nr=this.Nr.delete(e),this.Lr=this.Lr.delete(e)}Wr(e){let t=new M(new ne([])),r=new ue(t,e),i=new ue(t,e+1),s=W();return this.Lr.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new ue(e,0),r=this.Nr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},ue=class{constructor(e,t){this.key=e,this.Gr=t}static Br(e,t){return M.comparator(e.key,t.key)||j(e.Gr,t.Gr)}static kr(e,t){return j(e.Gr,t.Gr)||M.comparator(e.key,t.key)}};var cu=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Jn=1,this.zr=new pe(ue.Br)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Jn;this.Jn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new Uc(s,t,r,i);this.mutationQueue.push(a);for(let u of i)this.zr=this.zr.add(new ue(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return P.resolve(a)}lookupMutationBatch(e,t){return P.resolve(this.jr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Hr(r),s=i<0?0:i;return P.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?Zu:this.Jn-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new ue(t,0),i=new ue(t,Number.POSITIVE_INFINITY),s=[];return this.zr.forEachInRange([r,i],a=>{let u=this.jr(a.Gr);s.push(u)}),P.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new pe(j);return t.forEach(i=>{let s=new ue(i,0),a=new ue(i,Number.POSITIVE_INFINITY);this.zr.forEachInRange([s,a],u=>{r=r.add(u.Gr)})}),P.resolve(this.Jr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;M.isDocumentKey(s)||(s=s.child(""));let a=new ue(new M(s),0),u=new pe(j);return this.zr.forEachWhile(l=>{let d=l.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(l.Gr)),!0)},a),P.resolve(this.Jr(u))}Jr(e){let t=[];return e.forEach(r=>{let i=this.jr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Y(this.Yr(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.zr;return P.forEach(t.mutations,i=>{let s=new ue(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.zr=r})}Xn(e){}containsKey(e,t){let r=new ue(t,0),i=this.zr.firstAfterOrEqual(r);return P.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}Yr(e,t){return this.Hr(e)}Hr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}jr(e){let t=this.Hr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var uu=class{constructor(e){this.Zr=e,this.docs=function(){return new se(M.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.Zr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():Ge.newInvalidDocument(t))}getEntries(e,t){let r=It();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ge.newInvalidDocument(i))}),P.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=It(),a=t.path,u=new M(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(u);for(;l.hasNext();){let{key:d,value:{document:p}}=l.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||Wv(Gv(p),r)<=0||(i.has(p.key)||ao(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return P.resolve(s)}getAllFromCollectionGroup(e,t,r,i){F(9500)}Xr(e,t){return P.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new lu(this)}getSize(e){return P.resolve(this.size)}},lu=class extends nu{constructor(e){super(),this.vr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.vr.addEntry(e,i)):this.vr.removeEntry(r)}),P.waitFor(t)}getFromCache(e,t){return this.vr.getEntry(e,t)}getAllFromCache(e,t){return this.vr.getEntries(e,t)}};var hu=class{constructor(e){this.persistence=e,this.ei=new vt(t=>il(t),sl),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.ti=0,this.ni=new ai,this.targetCount=0,this.ri=oi.rr()}forEachTarget(e,t){return this.ei.forEach((r,i)=>t(i)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.ti)}allocateTargetId(e){return this.highestTargetId=this.ri.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ti&&(this.ti=t),P.resolve()}ar(e){this.ei.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ri=new oi(t),this.highestTargetId=t),e.sequenceNumber>this.ti&&(this.ti=e.sequenceNumber)}addTargetData(e,t){return this.ar(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.ar(t),P.resolve()}removeTargetData(e,t){return this.ei.delete(t.target),this.ni.Ur(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.ei.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.ei.delete(a),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),P.waitFor(s).next(()=>i)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){let r=this.ei.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this.ni.qr(t,r),P.resolve()}removeMatchingKeys(e,t,r){this.ni.$r(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),P.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ni.Ur(t),P.resolve()}getMatchingKeysForTargetId(e,t){let r=this.ni.Wr(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this.ni.containsKey(t))}};var xs=class{constructor(e,t){this.ii={},this.overlays={},this.si=new Xu(0),this.oi=!1,this.oi=!0,this._i=new au,this.referenceDelegate=e(this),this.ai=new hu(this),this.indexManager=new Jc,this.remoteDocumentCache=function(i){return new uu(i)}(r=>this.referenceDelegate.ui(r)),this.serializer=new Yc(t),this.ci=new su(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.oi=!1,Promise.resolve()}get started(){return this.oi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ou,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ii[e.toKey()];return r||(r=new cu(t,this.referenceDelegate),this.ii[e.toKey()]=r),r}getGlobalsCache(){return this._i}getTargetCache(){return this.ai}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.ci}runTransaction(e,t,r){O("MemoryPersistence","Starting transaction:",e);let i=new du(this.si.next());return this.referenceDelegate.li(),r(i).next(s=>this.referenceDelegate.hi(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Pi(e,t){return P.or(Object.values(this.ii).map(r=>()=>r.containsKey(e,t)))}},du=class extends Ec{constructor(e){super(),this.currentSequenceNumber=e}},fu=class n{constructor(e){this.persistence=e,this.Ti=new ai,this.Ii=null}static Ei(e){return new n(e)}get di(){if(this.Ii)return this.Ii;throw F(60996)}addReference(e,t,r){return this.Ti.addReference(r,t),this.di.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.Ti.removeReference(r,t),this.di.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),P.resolve()}removeTarget(e,t){this.Ti.Ur(t.targetId).forEach(i=>this.di.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.di.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}li(){this.Ii=new Set}hi(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.di,r=>{let i=M.fromPath(r);return this.Ai(e,i).next(s=>{s||t.removeEntry(i,q.min())})}).next(()=>(this.Ii=null,t.apply(e)))}updateLimboDocument(e,t){return this.Ai(e,t).next(r=>{r?this.di.delete(t.toString()):this.di.add(t.toString())})}ui(e){return 0}Ai(e,t){return P.or([()=>P.resolve(this.Ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Pi(e,t)])}},Ms=class n{constructor(e,t){this.persistence=e,this.Ri=new vt(r=>Yv(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=WI(this,t)}static Ei(e,t){return new n(e,t)}li(){}hi(e){return P.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.Vr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Vr(e){let t=0;return this.Ar(e,r=>{t++}).next(()=>t)}Ar(e,t){return P.forEach(this.Ri,(r,i)=>this.gr(e,r,i).next(s=>s?P.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.Xr(e,a=>this.gr(e,a,t).next(u=>{u||(r++,s.removeEntry(a,q.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.Ri.set(t,e.currentSequenceNumber),P.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.Ri.set(r,e.currentSequenceNumber),P.resolve()}removeReference(e,t,r){return this.Ri.set(r,e.currentSequenceNumber),P.resolve()}updateLimboDocument(e,t){return this.Ri.set(t,e.currentSequenceNumber),P.resolve()}ui(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=_s(e.data.value)),t}gr(e,t,r){return P.or([()=>this.persistence.Pi(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.Ri.get(t);return P.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var pu=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.ls=r,this.hs=i}static Ps(e,t){let r=W(),i=W();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var mu=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var gu=class{constructor(){this.Ts=!1,this.Is=!1,this.Es=100,this.ds=function(){return ef()?8:Kv(de())>0?6:4}()}initialize(e,t){this.As=e,this.indexManager=t,this.Ts=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.Rs(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Vs(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new mu;return this.fs(e,t,a).next(u=>{if(s.result=u,this.Is)return this.gs(e,t,a,u.size)})}).next(()=>s.result)}gs(e,t,r,i){return r.documentReadCount<this.Es?(qn()<=G.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",$n(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Es,"documents"),P.resolve()):(qn()<=G.DEBUG&&O("QueryEngine","Query:",$n(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(qn()<=G.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",$n(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,nt(t))):P.resolve())}Rs(e,t){if(Ff(t))return P.resolve(null);let r=nt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Mc(t,null,"F"),r=nt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let a=W(...s);return this.As.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(l=>{let d=this.ps(t,u);return this.ys(t,d,a,l.readTime)?this.Rs(e,Mc(t,null,"F")):this.ws(e,d,t,l)}))})))}Vs(e,t,r,i){return Ff(t)||i.isEqual(q.min())?P.resolve(null):this.As.getDocuments(e,r).next(s=>{let a=this.ps(t,s);return this.ys(t,a,r,i)?P.resolve(null):(qn()<=G.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),$n(t)),this.ws(e,a,t,zv(i,Zr)).next(u=>u))})}ps(e,t){let r=new pe(Gp(e));return t.forEach((i,s)=>{ao(e,s)&&(r=r.add(s))}),r}ys(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}fs(e,t,r){return qn()<=G.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",$n(t)),this.As.getDocumentsMatchingQuery(e,t,fn.min(),r)}ws(e,t,r,i){return this.As.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var ul="LocalStore",HI=3e8,_u=class{constructor(e,t,r,i){this.persistence=e,this.bs=t,this.serializer=i,this.Ss=new se(j),this.Ds=new vt(s=>il(s),sl),this.vs=new Map,this.Cs=e.getRemoteDocumentCache(),this.ai=e.getTargetCache(),this.ci=e.getBundleCache(),this.Fs(r)}Fs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new iu(this.Cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Cs.setIndexManager(this.indexManager),this.bs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ss))}};function KI(n,e,t,r){return new _u(n,e,t,r)}function hm(n,e){return g(this,null,function*(){let t=B(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Fs(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let a=[],u=[],l=W();for(let d of i){a.push(d.batchId);for(let p of d.mutations)l=l.add(p.key)}for(let d of s){u.push(d.batchId);for(let p of d.mutations)l=l.add(p.key)}return t.localDocuments.getDocuments(r,l).next(d=>({Ms:d,removedBatchIds:a,addedBatchIds:u}))})})})}function QI(n,e){let t=B(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.Cs.newChangeBuffer({trackRemovals:!0});return function(u,l,d,p){let v=d.batch,I=v.keys(),S=P.resolve();return I.forEach(D=>{S=S.next(()=>p.getEntry(l,D)).next(x=>{let k=d.docVersions.get(D);Y(k!==null,48541),x.version.compareTo(k)<0&&(v.applyToRemoteDocument(x,d),x.isValidDocument()&&(x.setReadTime(d.commitVersion),p.addEntry(x)))})}),S.next(()=>u.mutationQueue.removeMutationBatch(l,v))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let l=W();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(l=l.add(u.batch.mutations[d].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function dm(n){let e=B(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.ai.getLastRemoteSnapshotVersion(t))}function YI(n,e){let t=B(n),r=e.snapshotVersion,i=t.Ss;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=t.Cs.newChangeBuffer({trackRemovals:!0});i=t.Ss;let u=[];e.targetChanges.forEach((p,v)=>{let I=i.get(v);if(!I)return;u.push(t.ai.removeMatchingKeys(s,p.removedDocuments,v).next(()=>t.ai.addMatchingKeys(s,p.addedDocuments,v)));let S=I.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(v)!==null?S=S.withResumeToken(Te.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):p.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(p.resumeToken,r)),i=i.insert(v,S),function(x,k,z){return x.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=HI?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0}(I,S,p)&&u.push(t.ai.updateTargetData(s,S))});let l=It(),d=W();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),u.push(JI(s,a,e.documentUpdates).next(p=>{l=p.xs,d=p.Os})),!r.isEqual(q.min())){let p=t.ai.getLastRemoteSnapshotVersion(s).next(v=>t.ai.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(p)}return P.waitFor(u).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,d)).next(()=>l)}).then(s=>(t.Ss=i,s))}function JI(n,e,t){let r=W(),i=W();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=It();return t.forEach((u,l)=>{let d=s.get(u);l.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),l.isNoDocument()&&l.version.isEqual(q.min())?(e.removeEntry(u,l.readTime),a=a.insert(u,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),a=a.insert(u,l)):O(ul,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",l.version)}),{xs:a,Os:i}})}function XI(n,e){let t=B(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Zu),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ZI(n,e){let t=B(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.ai.getTargetData(r,e).next(s=>s?(i=s,P.resolve(i)):t.ai.allocateTargetId(r).next(a=>(i=new si(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.ai.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Ss.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ss=t.Ss.insert(r.targetId,r),t.Ds.set(e,r.targetId)),r})}function yu(n,e,t){return g(this,null,function*(){let r=B(n),i=r.Ss.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!ur(a))throw a;O(ul,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ss=r.Ss.remove(e),r.Ds.delete(i.target)})}function Yf(n,e,t){let r=B(n),i=q.min(),s=W();return r.persistence.runTransaction("Execute query","readwrite",a=>function(l,d,p){let v=B(l),I=v.Ds.get(p);return I!==void 0?P.resolve(v.Ss.get(I)):v.ai.getTargetData(d,p)}(r,a,nt(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.ai.getMatchingKeysForTargetId(a,u.targetId).next(l=>{s=l})}).next(()=>r.bs.getDocumentsMatchingQuery(a,e,t?i:q.min(),t?s:W())).next(u=>(eE(r,fI(e),u),{documents:u,Ns:s})))}function eE(n,e,t){let r=n.vs.get(e)||q.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.vs.set(e,r)}var Fs=class{constructor(){this.activeTargetIds=vI()}$s(e){this.activeTargetIds=this.activeTargetIds.add(e)}Us(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Qs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var vu=class{constructor(){this.So=new Fs,this.Do={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.So.$s(e),this.Do[e]||"not-current"}updateQueryState(e,t,r){this.Do[e]=t}removeLocalQueryTarget(e){this.So.Us(e)}isLocalQueryTarget(e){return this.So.activeTargetIds.has(e)}clearQueryState(e){delete this.Do[e]}getAllActiveQueryTargets(){return this.So.activeTargetIds}isActiveQueryTarget(e){return this.So.activeTargetIds.has(e)}start(){return this.So=new Fs,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Iu=class{vo(e){}shutdown(){}};var Jf="ConnectivityMonitor",Ls=class{constructor(){this.Co=()=>this.Fo(),this.Mo=()=>this.xo(),this.Oo=[],this.No()}vo(e){this.Oo.push(e)}shutdown(){window.removeEventListener("online",this.Co),window.removeEventListener("offline",this.Mo)}No(){window.addEventListener("online",this.Co),window.addEventListener("offline",this.Mo)}Fo(){O(Jf,"Network connectivity changed: AVAILABLE");for(let e of this.Oo)e(0)}xo(){O(Jf,"Network connectivity changed: UNAVAILABLE");for(let e of this.Oo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var gs=null;function Eu(){return gs===null?gs=function(){return 268435456+Math.round(2147483648*Math.random())}():gs++,"0x"+gs.toString(16)}var lc="RestConnection",tE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},wu=class{get Bo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Lo=t+"://"+e.host,this.ko=`projects/${r}/databases/${i}`,this.qo=this.databaseId.database===Cs?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Qo(e,t,r,i,s){let a=Eu(),u=this.$o(e,t.toUriEncodedString());O(lc,`Sending RPC '${e}' ${a}:`,u,r);let l={"google-cloud-resource-prefix":this.ko,"x-goog-request-params":this.qo};this.Uo(l,i,s);let{host:d}=new URL(u),p=on(d);return this.Ko(e,u,l,r,p).then(v=>(O(lc,`Received RPC '${e}' ${a}: `,v),v),v=>{throw Kn(lc,`RPC '${e}' ${a} failed with error: `,v,"url: ",u,"request:",r),v})}Wo(e,t,r,i,s,a){return this.Qo(e,t,r,i,s)}Uo(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ar}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}$o(e,t){let r=tE[e];return`${this.Lo}/v1/${t}:${r}`}terminate(){}};var Tu=class{constructor(e){this.Go=e.Go,this.zo=e.zo}jo(e){this.Ho=e}Jo(e){this.Yo=e}Zo(e){this.Xo=e}onMessage(e){this.e_=e}close(){this.zo()}send(e){this.Go(e)}t_(){this.Ho()}n_(){this.Yo()}r_(e){this.Xo(e)}i_(e){this.e_(e)}};var we="WebChannelConnection",Au=class extends wu{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ko(e,t,r,i,s){let a=Eu();return new Promise((u,l)=>{let d=new ic;d.setWithCredentials(!0),d.listenOnce(sc.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Hr.NO_ERROR:let v=d.getResponseJson();O(we,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(v)),u(v);break;case Hr.TIMEOUT:O(we,`RPC '${e}' ${a} timed out`),l(new V(R.DEADLINE_EXCEEDED,"Request time out"));break;case Hr.HTTP_ERROR:let I=d.getStatus();if(O(we,`RPC '${e}' ${a} failed with status:`,I,"response text:",d.getResponseText()),I>0){let S=d.getResponseJson();Array.isArray(S)&&(S=S[0]);let D=S?.error;if(D&&D.status&&D.message){let x=function(z){let U=z.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf(U)>=0?U:R.UNKNOWN}(D.status);l(new V(x,D.message))}else l(new V(R.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new V(R.UNAVAILABLE,"Connection failed."));break;default:F(9055,{s_:e,streamId:a,o_:d.getLastErrorCode(),__:d.getLastError()})}}finally{O(we,`RPC '${e}' ${a} completed.`)}});let p=JSON.stringify(i);O(we,`RPC '${e}' ${a} sending request:`,i),d.send(t,"POST",p,r,15)})}a_(e,t,r){let i=Eu(),s=[this.Lo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=cc(),u=ac(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(l.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Uo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;let p=s.join("");O(we,`Creating RPC '${e}' stream ${i}: ${p}`,l);let v=a.createWebChannel(p,l),I=!1,S=!1,D=new Tu({Go:k=>{S?O(we,`Not sending because RPC '${e}' stream ${i} is closed:`,k):(I||(O(we,`Opening RPC '${e}' stream ${i} transport.`),v.open(),I=!0),O(we,`RPC '${e}' stream ${i} sending:`,k),v.send(k))},zo:()=>v.close()}),x=(k,z,U)=>{k.listen(z,$=>{try{U($)}catch(X){setTimeout(()=>{throw X},0)}})};return x(v,Bn.EventType.OPEN,()=>{S||(O(we,`RPC '${e}' stream ${i} transport opened.`),D.t_())}),x(v,Bn.EventType.CLOSE,()=>{S||(S=!0,O(we,`RPC '${e}' stream ${i} transport closed`),D.r_())}),x(v,Bn.EventType.ERROR,k=>{S||(S=!0,Kn(we,`RPC '${e}' stream ${i} transport errored. Name:`,k.name,"Message:",k.message),D.r_(new V(R.UNAVAILABLE,"The operation could not be completed")))}),x(v,Bn.EventType.MESSAGE,k=>{var z;if(!S){let U=k.data[0];Y(!!U,16349);let $=U,X=$?.error||((z=$[0])===null||z===void 0?void 0:z.error);if(X){O(we,`RPC '${e}' stream ${i} received error:`,X);let Ae=X.status,J=function(y){let E=ce[y];if(E!==void 0)return nm(E)}(Ae),w=X.message;J===void 0&&(J=R.INTERNAL,w="Unknown error status: "+Ae+" with message "+X.message),S=!0,D.r_(new V(J,w)),v.close()}else O(we,`RPC '${e}' stream ${i} received:`,U),D.i_(U)}}),x(u,oc.STAT_EVENT,k=>{k.stat===fs.PROXY?O(we,`RPC '${e}' stream ${i} detected buffering proxy`):k.stat===fs.NOPROXY&&O(we,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{D.n_()},0),D}};function hc(){return typeof document<"u"?document:null}function co(n){return new Gc(n,!0)}var Us=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.bi=e,this.timerId=t,this.u_=r,this.c_=i,this.l_=s,this.h_=0,this.P_=null,this.T_=Date.now(),this.reset()}reset(){this.h_=0}I_(){this.h_=this.l_}E_(e){this.cancel();let t=Math.floor(this.h_+this.d_()),r=Math.max(0,Date.now()-this.T_),i=Math.max(0,t-r);i>0&&O("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.h_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.P_=this.bi.enqueueAfterDelay(this.timerId,i,()=>(this.T_=Date.now(),e())),this.h_*=this.c_,this.h_<this.u_&&(this.h_=this.u_),this.h_>this.l_&&(this.h_=this.l_)}A_(){this.P_!==null&&(this.P_.skipDelay(),this.P_=null)}cancel(){this.P_!==null&&(this.P_.cancel(),this.P_=null)}d_(){return(Math.random()-.5)*this.h_}};var Xf="PersistentStream",Bs=class{constructor(e,t,r,i,s,a,u,l){this.bi=e,this.R_=r,this.V_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=l,this.state=0,this.m_=0,this.f_=null,this.g_=null,this.stream=null,this.p_=0,this.y_=new Us(e,t)}w_(){return this.state===1||this.state===5||this.b_()}b_(){return this.state===2||this.state===3}start(){this.p_=0,this.state!==4?this.auth():this.S_()}stop(){return g(this,null,function*(){this.w_()&&(yield this.close(0))})}D_(){this.state=0,this.y_.reset()}v_(){this.b_()&&this.f_===null&&(this.f_=this.bi.enqueueAfterDelay(this.R_,6e4,()=>this.C_()))}F_(e){this.M_(),this.stream.send(e)}C_(){return g(this,null,function*(){if(this.b_())return this.close(0)})}M_(){this.f_&&(this.f_.cancel(),this.f_=null)}x_(){this.g_&&(this.g_.cancel(),this.g_=null)}close(e,t){return g(this,null,function*(){this.M_(),this.x_(),this.y_.cancel(),this.m_++,e!==4?this.y_.reset():t&&t.code===R.RESOURCE_EXHAUSTED?(gt(t.toString()),gt("Using maximum backoff delay to prevent overloading the backend."),this.y_.I_()):t&&t.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.O_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Zo(t)})}O_(){}auth(){this.state=1;let e=this.N_(this.m_),t=this.m_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.m_===t&&this.B_(r,i)},r=>{e(()=>{let i=new V(R.UNKNOWN,"Fetching auth token failed: "+r.message);return this.L_(i)})})}B_(e,t){let r=this.N_(this.m_);this.stream=this.k_(e,t),this.stream.jo(()=>{r(()=>this.listener.jo())}),this.stream.Jo(()=>{r(()=>(this.state=2,this.g_=this.bi.enqueueAfterDelay(this.V_,1e4,()=>(this.b_()&&(this.state=3),Promise.resolve())),this.listener.Jo()))}),this.stream.Zo(i=>{r(()=>this.L_(i))}),this.stream.onMessage(i=>{r(()=>++this.p_==1?this.q_(i):this.onNext(i))})}S_(){this.state=5,this.y_.E_(()=>g(this,null,function*(){this.state=0,this.start()}))}L_(e){return O(Xf,`close with error: ${e}`),this.stream=null,this.close(4,e)}N_(e){return t=>{this.bi.enqueueAndForget(()=>this.m_===e?t():(O(Xf,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},bu=class extends Bs{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}k_(e,t){return this.connection.a_("Listen",e,t)}q_(e){return this.onNext(e)}onNext(e){this.y_.reset();let t=VI(this.serializer,e),r=function(s){if(!("targetChange"in s))return q.min();let a=s.targetChange;return a.targetIds&&a.targetIds.length?q.min():a.readTime?it(a.readTime):q.min()}(e);return this.listener.Q_(t,r)}U_(e){let t={};t.database=Qc(this.serializer),t.addTarget=function(s,a){let u,l=a.target;if(u=Oc(l)?{documents:MI(s,l)}:{query:FI(s,l).gt},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=rm(s,a.resumeToken);let d=Wc(s,a.expectedCount);d!==null&&(u.expectedCount=d)}else if(a.snapshotVersion.compareTo(q.min())>0){u.readTime=Vs(s,a.snapshotVersion.toTimestamp());let d=Wc(s,a.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);let r=UI(this.serializer,e);r&&(t.labels=r),this.F_(t)}K_(e){let t={};t.database=Qc(this.serializer),t.removeTarget=e,this.F_(t)}},Cu=class extends Bs{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get W_(){return this.p_>0}start(){this.lastStreamToken=void 0,super.start()}O_(){this.W_&&this.G_([])}k_(e,t){return this.connection.a_("Write",e,t)}q_(e){return Y(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Y(!e.writeResults||e.writeResults.length===0,55816),this.listener.z_()}onNext(e){Y(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.y_.reset();let t=xI(e.writeResults,e.commitTime),r=it(e.commitTime);return this.listener.j_(r,t)}H_(){let e={};e.database=Qc(this.serializer),this.F_(e)}G_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>OI(this.serializer,r))};this.F_(t)}};var Su=class{},Ru=class extends Su{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.J_=!1}Y_(){if(this.J_)throw new V(R.FAILED_PRECONDITION,"The client has already been terminated.")}Qo(e,t,r,i){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Qo(e,Hc(t,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new V(R.UNKNOWN,s.toString())})}Wo(e,t,r,i,s){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Wo(e,Hc(t,r),i,a,u,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new V(R.UNKNOWN,a.toString())})}terminate(){this.J_=!0,this.connection.terminate()}},Pu=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.Z_=0,this.X_=null,this.ea=!0}ta(){this.Z_===0&&(this.na("Unknown"),this.X_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.X_=null,this.ra("Backend didn't respond within 10 seconds."),this.na("Offline"),Promise.resolve())))}ia(e){this.state==="Online"?this.na("Unknown"):(this.Z_++,this.Z_>=1&&(this.sa(),this.ra(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.na("Offline")))}set(e){this.sa(),this.Z_=0,e==="Online"&&(this.ea=!1),this.na(e)}na(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ra(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ea?(gt(t),this.ea=!1):O("OnlineStateTracker",t)}sa(){this.X_!==null&&(this.X_.cancel(),this.X_=null)}};var yn="RemoteStore",Du=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.oa=[],this._a=new Map,this.aa=new Set,this.ua=[],this.ca=s,this.ca.vo(a=>{r.enqueueAndForget(()=>g(this,null,function*(){In(this)&&(O(yn,"Restarting streams for network reachability change."),yield function(l){return g(this,null,function*(){let d=B(l);d.aa.add(4),yield fi(d),d.la.set("Unknown"),d.aa.delete(4),yield uo(d)})}(this))}))}),this.la=new Pu(r,i)}};function uo(n){return g(this,null,function*(){if(In(n))for(let e of n.ua)yield e(!0)})}function fi(n){return g(this,null,function*(){for(let e of n.ua)yield e(!1)})}function fm(n,e){let t=B(n);t._a.has(e.targetId)||(t._a.set(e.targetId,e),fl(t)?dl(t):lr(t).b_()&&hl(t,e))}function ll(n,e){let t=B(n),r=lr(t);t._a.delete(e),r.b_()&&pm(t,e),t._a.size===0&&(r.b_()?r.v_():In(t)&&t.la.set("Unknown"))}function hl(n,e){if(n.ha.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(q.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}lr(n).U_(e)}function pm(n,e){n.ha.Ke(e),lr(n).K_(e)}function dl(n){n.ha=new zc({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n._a.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),lr(n).start(),n.la.ta()}function fl(n){return In(n)&&!lr(n).w_()&&n._a.size>0}function In(n){return B(n).aa.size===0}function mm(n){n.ha=void 0}function nE(n){return g(this,null,function*(){n.la.set("Online")})}function rE(n){return g(this,null,function*(){n._a.forEach((e,t)=>{hl(n,e)})})}function iE(n,e){return g(this,null,function*(){mm(n),fl(n)?(n.la.ia(e),dl(n)):n.la.set("Unknown")})}function sE(n,e,t){return g(this,null,function*(){if(n.la.set("Online"),e instanceof ks&&e.state===2&&e.cause)try{yield function(i,s){return g(this,null,function*(){let a=s.cause;for(let u of s.targetIds)i._a.has(u)&&(yield i.remoteSyncer.rejectListen(u,a),i._a.delete(u),i.ha.removeTarget(u))})}(n,e)}catch(r){O(yn,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield qs(n,r)}else if(e instanceof Wn?n.ha.Xe(e):e instanceof Ds?n.ha.ot(e):n.ha.nt(e),!t.isEqual(q.min()))try{let r=yield dm(n.localStore);t.compareTo(r)>=0&&(yield function(s,a){let u=s.ha.It(a);return u.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){let p=s._a.get(d);p&&s._a.set(d,p.withResumeToken(l.resumeToken,a))}}),u.targetMismatches.forEach((l,d)=>{let p=s._a.get(l);if(!p)return;s._a.set(l,p.withResumeToken(Te.EMPTY_BYTE_STRING,p.snapshotVersion)),pm(s,l);let v=new si(p.target,l,d,p.sequenceNumber);hl(s,v)}),s.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(r){O(yn,"Failed to raise snapshot:",r),yield qs(n,r)}})}function qs(n,e,t){return g(this,null,function*(){if(!ur(e))throw e;n.aa.add(1),yield fi(n),n.la.set("Offline"),t||(t=()=>dm(n.localStore)),n.asyncQueue.enqueueRetryable(()=>g(null,null,function*(){O(yn,"Retrying IndexedDB access"),yield t(),n.aa.delete(1),yield uo(n)}))})}function gm(n,e){return e().catch(t=>qs(n,t,e))}function lo(n){return g(this,null,function*(){let e=B(n),t=Lt(e),r=e.oa.length>0?e.oa[e.oa.length-1].batchId:Zu;for(;oE(e);)try{let i=yield XI(e.localStore,r);if(i===null){e.oa.length===0&&t.v_();break}r=i.batchId,aE(e,i)}catch(i){yield qs(e,i)}_m(e)&&ym(e)})}function oE(n){return In(n)&&n.oa.length<10}function aE(n,e){n.oa.push(e);let t=Lt(n);t.b_()&&t.W_&&t.G_(e.mutations)}function _m(n){return In(n)&&!Lt(n).w_()&&n.oa.length>0}function ym(n){Lt(n).start()}function cE(n){return g(this,null,function*(){Lt(n).H_()})}function uE(n){return g(this,null,function*(){let e=Lt(n);for(let t of n.oa)e.G_(t.mutations)})}function lE(n,e,t){return g(this,null,function*(){let r=n.oa.shift(),i=Bc.from(r,e,t);yield gm(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield lo(n)})}function hE(n,e){return g(this,null,function*(){e&&Lt(n).W_&&(yield function(r,i){return g(this,null,function*(){if(function(a){return CI(a)&&a!==R.ABORTED}(i.code)){let s=r.oa.shift();Lt(r).D_(),yield gm(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield lo(r)}})}(n,e)),_m(n)&&ym(n)})}function Zf(n,e){return g(this,null,function*(){let t=B(n);t.asyncQueue.verifyOperationInProgress(),O(yn,"RemoteStore received new credentials");let r=In(t);t.aa.add(3),yield fi(t),r&&t.la.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.aa.delete(3),yield uo(t)})}function dE(n,e){return g(this,null,function*(){let t=B(n);e?(t.aa.delete(2),yield uo(t)):e||(t.aa.add(2),yield fi(t),t.la.set("Unknown"))})}function lr(n){return n.Pa||(n.Pa=function(t,r,i){let s=B(t);return s.Y_(),new bu(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{jo:nE.bind(null,n),Jo:rE.bind(null,n),Zo:iE.bind(null,n),Q_:sE.bind(null,n)}),n.ua.push(e=>g(null,null,function*(){e?(n.Pa.D_(),fl(n)?dl(n):n.la.set("Unknown")):(yield n.Pa.stop(),mm(n))}))),n.Pa}function Lt(n){return n.Ta||(n.Ta=function(t,r,i){let s=B(t);return s.Y_(),new Cu(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{jo:()=>Promise.resolve(),Jo:cE.bind(null,n),Zo:hE.bind(null,n),z_:uE.bind(null,n),j_:lE.bind(null,n)}),n.ua.push(e=>g(null,null,function*(){e?(n.Ta.D_(),yield lo(n)):(yield n.Ta.stop(),n.oa.length>0&&(O(yn,`Stopping write stream with ${n.oa.length} pending writes`),n.oa=[]))}))),n.Ta}var ku=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ze,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let a=Date.now()+r,u=new n(e,t,a,i,s);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new V(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function pl(n,e){if(gt("AsyncQueue",`${e}: ${n}`),ur(n))return new V(R.UNAVAILABLE,`${e}: ${n}`);throw n}var $s=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||M.comparator(t.key,r.key):(t,r)=>M.comparator(t.key,r.key),this.keyedMap=Kr(),this.sortedSet=new se(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var js=class{constructor(){this.Ia=new se(M.comparator)}track(e){let t=e.doc.key,r=this.Ia.get(t);r?e.type!==0&&r.type===3?this.Ia=this.Ia.insert(t,e):e.type===3&&r.type!==1?this.Ia=this.Ia.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Ia=this.Ia.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Ia=this.Ia.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Ia=this.Ia.remove(t):e.type===1&&r.type===2?this.Ia=this.Ia.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Ia=this.Ia.insert(t,{type:2,doc:e.doc}):F(63341,{Vt:e,Ea:r}):this.Ia=this.Ia.insert(t,e)}da(){let e=[];return this.Ia.inorderTraversal((t,r)=>{e.push(r)}),e}},ir=class n{constructor(e,t,r,i,s,a,u,l,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){let a=[];return t.forEach(u=>{a.push({type:0,doc:u})}),new n(e,t,$s.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&oo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Nu=class{constructor(){this.Aa=void 0,this.Ra=[]}Va(){return this.Ra.some(e=>e.ma())}},Vu=class{constructor(){this.queries=ep(),this.onlineState="Unknown",this.fa=new Set}terminate(){(function(t,r){let i=B(t),s=i.queries;i.queries=ep(),s.forEach((a,u)=>{for(let l of u.Ra)l.onError(r)})})(this,new V(R.ABORTED,"Firestore shutting down"))}};function ep(){return new vt(n=>zp(n),oo)}function vm(n,e){return g(this,null,function*(){let t=B(n),r=3,i=e.query,s=t.queries.get(i);s?!s.Va()&&e.ma()&&(r=2):(s=new Nu,r=e.ma()?0:1);try{switch(r){case 0:s.Aa=yield t.onListen(i,!0);break;case 1:s.Aa=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let u=pl(a,`Initialization of query '${$n(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,s),s.Ra.push(e),e.ga(t.onlineState),s.Aa&&e.pa(s.Aa)&&ml(t)})}function Im(n,e){return g(this,null,function*(){let t=B(n),r=e.query,i=3,s=t.queries.get(r);if(s){let a=s.Ra.indexOf(e);a>=0&&(s.Ra.splice(a,1),s.Ra.length===0?i=e.ma()?0:1:!s.Va()&&e.ma()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function fE(n,e){let t=B(n),r=!1;for(let i of e){let s=i.query,a=t.queries.get(s);if(a){for(let u of a.Ra)u.pa(i)&&(r=!0);a.Aa=i}}r&&ml(t)}function pE(n,e,t){let r=B(n),i=r.queries.get(e);if(i)for(let s of i.Ra)s.onError(t);r.queries.delete(e)}function ml(n){n.fa.forEach(e=>{e.next()})}var Ou,tp;(tp=Ou||(Ou={})).ya="default",tp.Cache="cache";var zs=class{constructor(e,t,r){this.query=e,this.wa=t,this.ba=!1,this.Sa=null,this.onlineState="Unknown",this.options=r||{}}pa(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new ir(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ba?this.Da(e)&&(this.wa.next(e),t=!0):this.va(e,this.onlineState)&&(this.Ca(e),t=!0),this.Sa=e,t}onError(e){this.wa.error(e)}ga(e){this.onlineState=e;let t=!1;return this.Sa&&!this.ba&&this.va(this.Sa,e)&&(this.Ca(this.Sa),t=!0),t}va(e,t){if(!e.fromCache||!this.ma())return!0;let r=t!=="Offline";return(!this.options.Fa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Da(e){if(e.docChanges.length>0)return!0;let t=this.Sa&&this.Sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Ca(e){e=ir.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ba=!0,this.wa.next(e)}ma(){return this.options.source!==Ou.Cache}};var Gs=class{constructor(e){this.key=e}},Ws=class{constructor(e){this.key=e}},xu=class{constructor(e,t){this.query=e,this.qa=t,this.Qa=null,this.hasCachedResults=!1,this.current=!1,this.$a=W(),this.mutatedKeys=W(),this.Ua=Gp(e),this.Ka=new $s(this.Ua)}get Wa(){return this.qa}Ga(e,t){let r=t?t.za:new js,i=t?t.Ka:this.Ka,s=t?t.mutatedKeys:this.mutatedKeys,a=i,u=!1,l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,v)=>{let I=i.get(p),S=ao(this.query,v)?v:null,D=!!I&&this.mutatedKeys.has(I.key),x=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations),k=!1;I&&S?I.data.isEqual(S.data)?D!==x&&(r.track({type:3,doc:S}),k=!0):this.ja(I,S)||(r.track({type:2,doc:S}),k=!0,(l&&this.Ua(S,l)>0||d&&this.Ua(S,d)<0)&&(u=!0)):!I&&S?(r.track({type:0,doc:S}),k=!0):I&&!S&&(r.track({type:1,doc:I}),k=!0,(l||d)&&(u=!0)),k&&(S?(a=a.add(S),s=x?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{Ka:a,za:r,ys:u,mutatedKeys:s}}ja(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ka;this.Ka=e.Ka,this.mutatedKeys=e.mutatedKeys;let a=e.za.da();a.sort((p,v)=>function(S,D){let x=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return F(20277,{Vt:k})}};return x(S)-x(D)}(p.type,v.type)||this.Ua(p.doc,v.doc)),this.Ha(r),i=i!=null&&i;let u=t&&!i?this.Ja():[],l=this.$a.size===0&&this.current&&!i?1:0,d=l!==this.Qa;return this.Qa=l,a.length!==0||d?{snapshot:new ir(this.query,e.Ka,s,a,e.mutatedKeys,l===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ya:u}:{Ya:u}}ga(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ka:this.Ka,za:new js,mutatedKeys:this.mutatedKeys,ys:!1},!1)):{Ya:[]}}Za(e){return!this.qa.has(e)&&!!this.Ka.has(e)&&!this.Ka.get(e).hasLocalMutations}Ha(e){e&&(e.addedDocuments.forEach(t=>this.qa=this.qa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.qa=this.qa.delete(t)),this.current=e.current)}Ja(){if(!this.current)return[];let e=this.$a;this.$a=W(),this.Ka.forEach(r=>{this.Za(r.key)&&(this.$a=this.$a.add(r.key))});let t=[];return e.forEach(r=>{this.$a.has(r)||t.push(new Ws(r))}),this.$a.forEach(r=>{e.has(r)||t.push(new Gs(r))}),t}Xa(e){this.qa=e.Ns,this.$a=W();let t=this.Ga(e.documents);return this.applyChanges(t,!0)}eu(){return ir.fromInitialDocuments(this.query,this.Ka,this.mutatedKeys,this.Qa===0,this.hasCachedResults)}},gl="SyncEngine",Mu=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Fu=class{constructor(e){this.key=e,this.tu=!1}},Lu=class{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.nu={},this.ru=new vt(u=>zp(u),oo),this.iu=new Map,this.su=new Set,this.ou=new se(M.comparator),this._u=new Map,this.au=new ai,this.uu={},this.cu=new Map,this.lu=oi.ir(),this.onlineState="Unknown",this.hu=void 0}get isPrimaryClient(){return this.hu===!0}};function mE(n,e,t=!0){return g(this,null,function*(){let r=Cm(n),i,s=r.ru.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.eu()):i=yield Em(r,e,t,!0),i})}function gE(n,e){return g(this,null,function*(){let t=Cm(n);yield Em(t,e,!0,!1)})}function Em(n,e,t,r){return g(this,null,function*(){let i=yield ZI(n.localStore,nt(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t),u;return r&&(u=yield _E(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&fm(n.remoteStore,i),u})}function _E(n,e,t,r,i){return g(this,null,function*(){n.Pu=(v,I,S)=>function(x,k,z,U){return g(this,null,function*(){let $=k.view.Ga(z);$.ys&&($=yield Yf(x.localStore,k.query,!1).then(({documents:w})=>k.view.Ga(w,$)));let X=U&&U.targetChanges.get(k.targetId),Ae=U&&U.targetMismatches.get(k.targetId)!=null,J=k.view.applyChanges($,x.isPrimaryClient,X,Ae);return rp(x,k.targetId,J.Ya),J.snapshot})}(n,v,I,S);let s=yield Yf(n.localStore,e,!0),a=new xu(e,s.Ns),u=a.Ga(s.documents),l=ii.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(u,n.isPrimaryClient,l);rp(n,t,d.Ya);let p=new Mu(e,t,a);return n.ru.set(e,p),n.iu.has(t)?n.iu.get(t).push(e):n.iu.set(t,[e]),d.snapshot})}function yE(n,e,t){return g(this,null,function*(){let r=B(n),i=r.ru.get(e),s=r.iu.get(i.targetId);if(s.length>1)return r.iu.set(i.targetId,s.filter(a=>!oo(a,e))),void r.ru.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield yu(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&ll(r.remoteStore,i.targetId),Uu(r,i.targetId)}).catch(cr))):(Uu(r,i.targetId),yield yu(r.localStore,i.targetId,!0))})}function vE(n,e){return g(this,null,function*(){let t=B(n),r=t.ru.get(e),i=t.iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),ll(t.remoteStore,r.targetId))})}function IE(n,e,t){return g(this,null,function*(){let r=SE(n);try{let i=yield function(a,u){let l=B(a),d=ge.now(),p=u.reduce((S,D)=>S.add(D.key),W()),v,I;return l.persistence.runTransaction("Locally write mutations","readwrite",S=>{let D=It(),x=W();return l.Cs.getEntries(S,p).next(k=>{D=k,D.forEach((z,U)=>{U.isValidDocument()||(x=x.add(z))})}).next(()=>l.localDocuments.getOverlayedDocuments(S,D)).next(k=>{v=k;let z=[];for(let U of u){let $=bI(U,v.get(U.key).overlayedDocument);$!=null&&z.push(new ot(U.key,$,Fp($.value.mapValue),rt.exists(!0)))}return l.mutationQueue.addMutationBatch(S,d,z,u)}).next(k=>{I=k;let z=k.applyToLocalDocumentSet(v,x);return l.documentOverlayCache.saveOverlays(S,k.batchId,z)})}).then(()=>({batchId:I.batchId,changes:Hp(v)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,l){let d=a.uu[a.currentUser.toKey()];d||(d=new se(j)),d=d.insert(u,l),a.uu[a.currentUser.toKey()]=d}(r,i.batchId,t),yield pi(r,i.changes),yield lo(r.remoteStore)}catch(i){let s=pl(i,"Failed to persist write");t.reject(s)}})}function wm(n,e){return g(this,null,function*(){let t=B(n);try{let r=yield YI(t.localStore,e);e.targetChanges.forEach((i,s)=>{let a=t._u.get(s);a&&(Y(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.tu=!0:i.modifiedDocuments.size>0?Y(a.tu,14607):i.removedDocuments.size>0&&(Y(a.tu,42227),a.tu=!1))}),yield pi(t,r,e)}catch(r){yield cr(r)}})}function np(n,e,t){let r=B(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.ru.forEach((s,a)=>{let u=a.view.ga(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){let l=B(a);l.onlineState=u;let d=!1;l.queries.forEach((p,v)=>{for(let I of v.Ra)I.ga(u)&&(d=!0)}),d&&ml(l)}(r.eventManager,e),i.length&&r.nu.Q_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function EE(n,e,t){return g(this,null,function*(){let r=B(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r._u.get(e),s=i&&i.key;if(s){let a=new se(M.comparator);a=a.insert(s,Ge.newNoDocument(s,q.min()));let u=W().add(s),l=new Ps(q.min(),new Map,new se(j),a,u);yield wm(r,l),r.ou=r.ou.remove(s),r._u.delete(e),_l(r)}else yield yu(r.localStore,e,!1).then(()=>Uu(r,e,t)).catch(cr)})}function wE(n,e){return g(this,null,function*(){let t=B(n),r=e.batch.batchId;try{let i=yield QI(t.localStore,e);Am(t,r,null),Tm(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield pi(t,i)}catch(i){yield cr(i)}})}function TE(n,e,t){return g(this,null,function*(){let r=B(n);try{let i=yield function(a,u){let l=B(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return l.mutationQueue.lookupMutationBatch(d,u).next(v=>(Y(v!==null,37113),p=v.keys(),l.mutationQueue.removeMutationBatch(d,v))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>l.localDocuments.getDocuments(d,p))})}(r.localStore,e);Am(r,e,t),Tm(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield pi(r,i)}catch(i){yield cr(i)}})}function Tm(n,e){(n.cu.get(e)||[]).forEach(t=>{t.resolve()}),n.cu.delete(e)}function Am(n,e,t){let r=B(n),i=r.uu[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.uu[r.currentUser.toKey()]=i}}function Uu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.iu.get(e))n.ru.delete(r),t&&n.nu.Tu(r,t);n.iu.delete(e),n.isPrimaryClient&&n.au.Ur(e).forEach(r=>{n.au.containsKey(r)||bm(n,r)})}function bm(n,e){n.su.delete(e.path.canonicalString());let t=n.ou.get(e);t!==null&&(ll(n.remoteStore,t),n.ou=n.ou.remove(e),n._u.delete(t),_l(n))}function rp(n,e,t){for(let r of t)r instanceof Gs?(n.au.addReference(r.key,e),AE(n,r)):r instanceof Ws?(O(gl,"Document no longer in limbo: "+r.key),n.au.removeReference(r.key,e),n.au.containsKey(r.key)||bm(n,r.key)):F(19791,{Iu:r})}function AE(n,e){let t=e.key,r=t.path.canonicalString();n.ou.get(t)||n.su.has(r)||(O(gl,"New document in limbo: "+t),n.su.add(r),_l(n))}function _l(n){for(;n.su.size>0&&n.ou.size<n.maxConcurrentLimboResolutions;){let e=n.su.values().next().value;n.su.delete(e);let t=new M(ne.fromString(e)),r=n.lu.next();n._u.set(r,new Fu(t)),n.ou=n.ou.insert(t,r),fm(n.remoteStore,new si(nt(ol(t.path)),r,"TargetPurposeLimboResolution",Xu.le))}}function pi(n,e,t){return g(this,null,function*(){let r=B(n),i=[],s=[],a=[];r.ru.isEmpty()||(r.ru.forEach((u,l)=>{a.push(r.Pu(l,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){let v=d?!d.fromCache:(p=t?.targetChanges.get(l.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(l.targetId,v?"current":"not-current")}if(d){i.push(d);let v=pu.Ps(l.targetId,d);s.push(v)}}))}),yield Promise.all(a),r.nu.Q_(i),yield function(l,d){return g(this,null,function*(){let p=B(l);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>P.forEach(d,I=>P.forEach(I.ls,S=>p.persistence.referenceDelegate.addReference(v,I.targetId,S)).next(()=>P.forEach(I.hs,S=>p.persistence.referenceDelegate.removeReference(v,I.targetId,S)))))}catch(v){if(!ur(v))throw v;O(ul,"Failed to update sequence numbers: "+v)}for(let v of d){let I=v.targetId;if(!v.fromCache){let S=p.Ss.get(I),D=S.snapshotVersion,x=S.withLastLimboFreeSnapshotVersion(D);p.Ss=p.Ss.insert(I,x)}}})}(r.localStore,s))})}function bE(n,e){return g(this,null,function*(){let t=B(n);if(!t.currentUser.isEqual(e)){O(gl,"User change. New user:",e.toKey());let r=yield hm(t.localStore,e);t.currentUser=e,function(s,a){s.cu.forEach(u=>{u.forEach(l=>{l.reject(new V(R.CANCELLED,a))})}),s.cu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield pi(t,r.Ms)}})}function CE(n,e){let t=B(n),r=t._u.get(e);if(r&&r.tu)return W().add(r.key);{let i=W(),s=t.iu.get(e);if(!s)return i;for(let a of s){let u=t.ru.get(a);i=i.unionWith(u.view.Wa)}return i}}function Cm(n){let e=B(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=wm.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=CE.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=EE.bind(null,e),e.nu.Q_=fE.bind(null,e.eventManager),e.nu.Tu=pE.bind(null,e.eventManager),e}function SE(n){let e=B(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=wE.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=TE.bind(null,e),e}var Sm=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return g(this,null,function*(){this.serializer=co(t.databaseInfo.databaseId),this.sharedClientState=this.Au(t),this.persistence=this.Ru(t),yield this.persistence.start(),this.localStore=this.Vu(t),this.gcScheduler=this.mu(t,this.localStore),this.indexBackfillerScheduler=this.fu(t,this.localStore)})}mu(t,r){return null}fu(t,r){return null}Vu(t){return KI(this.persistence,new gu,t.initialUser,this.serializer)}Ru(t){return new xs(fu.Ei,this.serializer)}Au(t){return new vu}terminate(){return g(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),Bu=class extends Sm{constructor(e){super(),this.cacheSizeBytes=e}mu(e,t){Y(this.persistence.referenceDelegate instanceof Ms,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new eu(r,e.asyncQueue,t)}Ru(e){let t=this.cacheSizeBytes!==void 0?Ue.withCacheSize(this.cacheSizeBytes):Ue.DEFAULT;return new xs(r=>Ms.Ei(r,t),this.serializer)}};var RE=(()=>{class n{initialize(t,r){return g(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>np(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=bE.bind(null,this.syncEngine),yield dE(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new Vu}()}createDatastore(t){let r=co(t.databaseInfo.databaseId),i=function(a){return new Au(a)}(t.databaseInfo);return function(a,u,l,d){return new Ru(a,u,l,d)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,s,a,u,l){return new Du(i,s,a,u,l)}(this.localStore,this.datastore,t.asyncQueue,r=>np(this.syncEngine,r,0),function(){return Ls.C()?new Ls:new Iu}())}createSyncEngine(t,r){return function(s,a,u,l,d,p,v){let I=new Lu(s,a,u,l,d,p);return v&&(I.hu=!0),I}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return g(this,null,function*(){var t,r;yield function(s){return g(this,null,function*(){let a=B(s);O(yn,"RemoteStore shutting down."),a.aa.add(5),yield fi(a),a.ca.shutdown(),a.la.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var Hs=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.pu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.pu(this.observer.error,e):gt("Uncaught Error in snapshot listener:",e.toString()))}yu(){this.muted=!0}pu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Ut="FirestoreClient",qu=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=fe.UNAUTHENTICATED,this.clientId=ws.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,a=>g(this,null,function*(){O(Ut,"Received user=",a.uid),yield this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,a=>(O(Ut,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ze;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=pl(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function dc(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),O(Ut,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>g(null,null,function*(){r.isEqual(i)||(yield hm(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function ip(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield PE(n);O(Ut,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Zf(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Zf(e.remoteStore,i)),n._onlineComponents=e})}function PE(n){return g(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){O(Ut,"Using user provided OfflineComponentProvider");try{yield dc(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===R.FAILED_PRECONDITION||i.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Kn("Error using user provided cache. Falling back to memory cache: "+t),yield dc(n,new Sm)}}else O(Ut,"Using default OfflineComponentProvider"),yield dc(n,new Bu(void 0));return n._offlineComponents})}function Rm(n){return g(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(O(Ut,"Using user provided OnlineComponentProvider"),yield ip(n,n._uninitializedComponentsProvider._online)):(O(Ut,"Using default OnlineComponentProvider"),yield ip(n,new RE))),n._onlineComponents})}function DE(n){return Rm(n).then(e=>e.syncEngine)}function Pm(n){return g(this,null,function*(){let e=yield Rm(n),t=e.eventManager;return t.onListen=mE.bind(null,e.syncEngine),t.onUnlisten=yE.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=gE.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=vE.bind(null,e.syncEngine),t})}function kE(n,e,t={}){let r=new ze;return n.asyncQueue.enqueueAndForget(()=>g(null,null,function*(){return function(s,a,u,l,d){let p=new Hs({next:I=>{p.yu(),a.enqueueAndForget(()=>Im(s,v));let S=I.docs.has(u);!S&&I.fromCache?d.reject(new V(R.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&I.fromCache&&l&&l.source==="server"?d.reject(new V(R.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(I)},error:I=>d.reject(I)}),v=new zs(ol(u.path),p,{includeMetadataChanges:!0,Fa:!0});return vm(s,v)}(yield Pm(n),n.asyncQueue,e,t,r)})),r.promise}function NE(n,e,t={}){let r=new ze;return n.asyncQueue.enqueueAndForget(()=>g(null,null,function*(){return function(s,a,u,l,d){let p=new Hs({next:I=>{p.yu(),a.enqueueAndForget(()=>Im(s,v)),I.fromCache&&l.source==="server"?d.reject(new V(R.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(I)},error:I=>d.reject(I)}),v=new zs(u,p,{includeMetadataChanges:!0,Fa:!0});return vm(s,v)}(yield Pm(n),n.asyncQueue,e,t,r)})),r.promise}function Dm(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var sp=new Map;function km(n,e,t){if(!t)throw new V(R.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function VE(n,e,t,r){if(e===!0&&r===!0)throw new V(R.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function op(n){if(!M.isDocumentKey(n))throw new V(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function ap(n){if(M.isDocumentKey(n))throw new V(R.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ho(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":F(12329,{type:typeof n})}function He(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new V(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=ho(n);throw new V(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var Nm="firestore.googleapis.com",cp=!0,Ks=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new V(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Nm,this.ssl=cp}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:cp;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=lm;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<GI)throw new V(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}VE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Dm((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new V(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new V(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new V(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},sr=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ks({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new V(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new V(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ks(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new fc;switch(r.type){case"firstParty":return new _c(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new V(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,Mn("Firestore",this._settings.isUsingEmulator),this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return g(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=sp.get(t);r&&(O("ComponentProvider","Removing Datastore"),sp.delete(t),r.terminate())}(this),Promise.resolve()}};function Vm(n,e,t,r={}){var i;n=He(n,sr);let s=on(e),a=n._getSettings(),u=Object.assign(Object.assign({},a),{emulatorOptions:n._getEmulatorOptions()}),l=`${e}:${t}`;a.host!==Nm&&a.host!==l&&Kn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let d=Object.assign(Object.assign({},a),{host:l,ssl:s,emulatorOptions:r});if(!Xe(d,u)&&(n._setSettings(d),s&&(cs(`https://${l}`),Mn("Firestore",!0)),r.mockUserToken)){let p,v;if(typeof r.mockUserToken=="string")p=r.mockUserToken,v=fe.MOCK_USER;else{p=Kd(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let I=r.mockUserToken.sub||r.mockUserToken.user_id;if(!I)throw new V(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");v=new fe(I)}n._authCredentials=new pc(new Is(p,v))}}var vn=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Re=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},xt=class n extends vn{constructor(e,t,r){super(e,t,ol(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Re(this.firestore,null,new M(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Om(n,e,...t){if(n=ae(n),km("collection","path",e),n instanceof sr){let r=ne.fromString(e,...t);return ap(r),new xt(n,null,r)}{if(!(n instanceof Re||n instanceof xt))throw new V(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ne.fromString(e,...t));return ap(r),new xt(n.firestore,null,r)}}function yl(n,e,...t){if(n=ae(n),arguments.length===1&&(e=ws.newId()),km("doc","path",e),n instanceof sr){let r=ne.fromString(e,...t);return op(r),new Re(n,null,new M(r))}{if(!(n instanceof Re||n instanceof xt))throw new V(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ne.fromString(e,...t));return op(r),new Re(n.firestore,n instanceof xt?n.converter:null,new M(r))}}var up="AsyncQueue",Qs=class{constructor(e=Promise.resolve()){this.Qu=[],this.$u=!1,this.Uu=[],this.Ku=null,this.Wu=!1,this.Gu=!1,this.zu=[],this.y_=new Us(this,"async_queue_retry"),this.ju=()=>{let r=hc();r&&O(up,"Visibility state changed to "+r.visibilityState),this.y_.A_()},this.Hu=e;let t=hc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.ju)}get isShuttingDown(){return this.$u}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Ju(),this.Yu(e)}enterRestrictedMode(e){if(!this.$u){this.$u=!0,this.Gu=e||!1;let t=hc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.ju)}}enqueue(e){if(this.Ju(),this.$u)return new Promise(()=>{});let t=new ze;return this.Yu(()=>this.$u&&this.Gu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qu.push(e),this.Zu()))}Zu(){return g(this,null,function*(){if(this.Qu.length!==0){try{yield this.Qu[0](),this.Qu.shift(),this.y_.reset()}catch(e){if(!ur(e))throw e;O(up,"Operation failed with retryable error: "+e)}this.Qu.length>0&&this.y_.E_(()=>this.Zu())}})}Yu(e){let t=this.Hu.then(()=>(this.Wu=!0,e().catch(r=>{throw this.Ku=r,this.Wu=!1,gt("INTERNAL UNHANDLED ERROR: ",lp(r)),r}).then(r=>(this.Wu=!1,r))));return this.Hu=t,t}enqueueAfterDelay(e,t,r){this.Ju(),this.zu.indexOf(e)>-1&&(t=0);let i=ku.createAndSchedule(this,e,t,r,s=>this.Xu(s));return this.Uu.push(i),i}Ju(){this.Ku&&F(47125,{ec:lp(this.Ku)})}verifyOperationInProgress(){}tc(){return g(this,null,function*(){let e;do e=this.Hu,yield e;while(e!==this.Hu)})}nc(e){for(let t of this.Uu)if(t.timerId===e)return!0;return!1}rc(e){return this.tc().then(()=>{this.Uu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Uu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.tc()})}sc(e){this.zu.push(e)}Xu(e){let t=this.Uu.indexOf(e);this.Uu.splice(t,1)}};function lp(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var Et=class extends sr{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Qs,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return g(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Qs(e),this._firestoreClient=void 0,yield e}})}};function xm(n,e){let t=typeof n=="object"?n:cn(),r=typeof n=="string"?n:e||Cs,i=Un(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Hd("firestore");s&&Vm(i,...s)}return i}function vl(n){if(n._terminated)throw new V(R.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||OE(n),n._firestoreClient}function OE(n){var e,t,r;let i=n._freezeSettings(),s=function(u,l,d,p){return new wc(u,l,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Dm(p.experimentalLongPollingOptions),p.useFetchStreams,p.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new qu(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(u){let l=u?._online.build();return{_offline:u?._offline.build(l),_online:l}}(n._componentsProvider))}var ci=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Te.fromBase64String(e))}catch(t){throw new V(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Te.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var or=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new V(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Me(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ui=class{constructor(e){this._methodName=e}};var li=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new V(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new V(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return j(this._lat,e._lat)||j(this._long,e._long)}};var hi=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var xE=/^__.*__$/,$u=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ot(e,this.data,this.fieldMask,t,this.fieldTransforms):new _n(e,this.data,t,this.fieldTransforms)}},Ys=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ot(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function Mm(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw F(40011,{oc:n})}}var ju=class n{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this._c(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get oc(){return this.settings.oc}ac(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}uc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ac({path:r,cc:!1});return i.lc(e),i}hc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ac({path:r,cc:!1});return i._c(),i}Pc(e){return this.ac({path:void 0,cc:!0})}Tc(e){return Xs(e,this.settings.methodName,this.settings.Ic||!1,this.path,this.settings.Ec)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}_c(){if(this.path)for(let e=0;e<this.path.length;e++)this.lc(this.path.get(e))}lc(e){if(e.length===0)throw this.Tc("Document fields must not be empty");if(Mm(this.oc)&&xE.test(e))throw this.Tc('Document fields cannot begin and end with "__"')}},zu=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||co(e)}dc(e,t,r,i=!1){return new ju({oc:e,methodName:t,Ec:r,path:Me.emptyPath(),cc:!1,Ic:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function fo(n){let e=n._freezeSettings(),t=co(n._databaseId);return new zu(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Fm(n,e,t,r,i,s={}){let a=n.dc(s.merge||s.mergeFields?2:0,e,t,i);Il("Data must be an object, but it was:",a,r);let u=Lm(r,a),l,d;if(s.merge)l=new Be(a.fieldMask),d=a.fieldTransforms;else if(s.mergeFields){let p=[];for(let v of s.mergeFields){let I=Gu(e,v,t);if(!a.contains(I))throw new V(R.INVALID_ARGUMENT,`Field '${I}' is specified in your field mask but missing from your input data.`);Bm(p,I)||p.push(I)}l=new Be(p),d=a.fieldTransforms.filter(v=>l.covers(v.field))}else l=null,d=a.fieldTransforms;return new $u(new xe(u),l,d)}var Js=class n extends ui{_toFieldTransform(e){if(e.oc!==2)throw e.oc===1?e.Tc(`${this._methodName}() can only appear at the top level of your update data`):e.Tc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function ME(n,e,t,r){let i=n.dc(1,e,t);Il("Data must be an object, but it was:",i,r);let s=[],a=xe.empty();Bt(r,(l,d)=>{let p=El(e,l,t);d=ae(d);let v=i.hc(p);if(d instanceof Js)s.push(p);else{let I=mi(d,v);I!=null&&(s.push(p),a.set(p,I))}});let u=new Be(s);return new Ys(a,u,i.fieldTransforms)}function FE(n,e,t,r,i,s){let a=n.dc(1,e,t),u=[Gu(e,r,t)],l=[i];if(s.length%2!=0)throw new V(R.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let I=0;I<s.length;I+=2)u.push(Gu(e,s[I])),l.push(s[I+1]);let d=[],p=xe.empty();for(let I=u.length-1;I>=0;--I)if(!Bm(d,u[I])){let S=u[I],D=l[I];D=ae(D);let x=a.hc(S);if(D instanceof Js)d.push(S);else{let k=mi(D,x);k!=null&&(d.push(S),p.set(S,k))}}let v=new Be(d);return new Ys(p,v,a.fieldTransforms)}function LE(n,e,t,r=!1){return mi(t,n.dc(r?4:3,e))}function mi(n,e){if(Um(n=ae(n)))return Il("Unsupported field value:",e,n),Lm(n,e);if(n instanceof ui)return function(r,i){if(!Mm(i.oc))throw i.Tc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Tc(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.cc&&e.oc!==4)throw e.Tc("Nested arrays are not supported");return function(r,i){let s=[],a=0;for(let u of r){let l=mi(u,i.Pc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=ae(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return II(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=ge.fromDate(r);return{timestampValue:Vs(i.serializer,s)}}if(r instanceof ge){let s=new ge(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Vs(i.serializer,s)}}if(r instanceof li)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ci)return{bytesValue:rm(i.serializer,r._byteString)};if(r instanceof Re){let s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Tc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:cl(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof hi)return function(a,u){return{mapValue:{fields:{[tl]:{stringValue:nl},[Yn]:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw u.Tc("VectorValues must only contain numeric values.");return al(u.serializer,d)})}}}}}}(r,i);throw i.Tc(`Unsupported field value: ${ho(r)}`)}(n,e)}function Lm(n,e){let t={};return Pp(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Bt(n,(r,i)=>{let s=mi(i,e.uc(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function Um(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ge||n instanceof li||n instanceof ci||n instanceof Re||n instanceof ui||n instanceof hi)}function Il(n,e,t){if(!Um(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=ho(t);throw r==="an object"?e.Tc(n+" a custom object"):e.Tc(n+" "+r)}}function Gu(n,e,t){if((e=ae(e))instanceof or)return e._internalPath;if(typeof e=="string")return El(n,e);throw Xs("Field path arguments must be of type string or ",n,!1,void 0,t)}var UE=new RegExp("[~\\*/\\[\\]]");function El(n,e,t){if(e.search(UE)>=0)throw Xs(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new or(...e.split("."))._internalPath}catch{throw Xs(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Xs(n,e,t,r,i){let s=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new V(R.INVALID_ARGUMENT,u+n+l)}function Bm(n,e){return n.some(t=>t.isEqual(e))}var Zs=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Re(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Wu(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(po("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Wu=class extends Zs{data(){return super.data()}};function po(n,e){return typeof e=="string"?El(n,e):e instanceof or?e._internalPath:e._delegate._internalPath}function BE(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new V(R.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var di=class{},eo=class extends di{};function qm(n,e,...t){let r=[];e instanceof di&&r.push(e),r=r.concat(t),function(s){let a=s.filter(l=>l instanceof Hu).length,u=s.filter(l=>l instanceof to).length;if(a>1||a>0&&u>0)throw new V(R.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var to=class n extends eo{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return zm(e._query,t),new vn(e.firestore,e.converter,xc(e._query,t))}_parse(e){let t=fo(e.firestore);return function(s,a,u,l,d,p,v){let I;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new V(R.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){dp(v,p);let D=[];for(let x of v)D.push(hp(l,s,x));I={arrayValue:{values:D}}}else I=hp(l,s,v)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||dp(v,p),I=LE(u,a,v,p==="in"||p==="not-in");return le.create(d,p,I)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function $m(n,e,t){let r=e,i=po("where",n);return to._create(i,r,t)}var Hu=class n extends di{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:We.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i,u=s.getFlattenedFilters();for(let l of u)zm(a,l),a=xc(a,l)}(e._query,t),new vn(e.firestore,e.converter,xc(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Ku=class n extends eo{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,a){if(i.startAt!==null)throw new V(R.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new V(R.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new pn(s,a)}(e._query,this._field,this._direction);return new vn(e.firestore,e.converter,function(i,s){let a=i.explicitOrderBy.concat([s]);return new Ft(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function jm(n,e="asc"){let t=e,r=po("orderBy",n);return Ku._create(r,t)}function hp(n,e,t){if(typeof(t=ae(t))=="string"){if(t==="")throw new V(R.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!jp(e)&&t.indexOf("/")!==-1)throw new V(R.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(ne.fromString(t));if(!M.isDocumentKey(r))throw new V(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return kf(n,new M(r))}if(t instanceof Re)return kf(n,t._key);throw new V(R.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ho(t)}.`)}function dp(n,e){if(!Array.isArray(n)||n.length===0)throw new V(R.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function zm(n,e){let t=function(i,s){for(let a of i)for(let u of a.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new V(R.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new V(R.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Qu=class{convertValue(e,t="none"){switch(Mt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return te(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(yt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw F(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Bt(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[Yn].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>te(a.doubleValue));return new hi(s)}convertGeoPoint(e){return new li(te(e.latitude),te(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=so(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(ti(e));default:return null}}convertTimestamp(e){let t=_t(e);return new ge(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ne.fromString(e);Y(um(r),9688,{name:e});let i=new Ss(r.get(1),r.get(3)),s=new M(r.popFirst(5));return i.isEqual(t)||gt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function Gm(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var hn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},no=class extends Zs{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Hn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(po("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Hn=class extends no{data(e={}){return super.data(e)}},Yu=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new hn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Hn(this._firestore,this._userDataWriter,r.key,r,new hn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new V(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{let l=new Hn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new hn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{let l=new Hn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new hn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return u.type!==0&&(d=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),p=a.indexOf(u.doc.key)),{type:qE(u.type),doc:l,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function qE(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return F(61501,{type:n})}}function Wm(n){n=He(n,Re);let e=He(n.firestore,Et);return kE(vl(e),n._key).then(t=>$E(e,n,t))}var ro=class extends Qu{constructor(e){super(),this.firestore=e}convertBytes(e){return new ci(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Re(this.firestore,null,t)}};function Hm(n){n=He(n,vn);let e=He(n.firestore,Et),t=vl(e),r=new ro(e);return BE(n._query),NE(t,n._query).then(i=>new Yu(e,r,n,i))}function Km(n,e,t){n=He(n,Re);let r=He(n.firestore,Et),i=Gm(n.converter,e,t);return mo(r,[Fm(fo(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,rt.none())])}function Qm(n,e,t,...r){n=He(n,Re);let i=He(n.firestore,Et),s=fo(i),a;return a=typeof(e=ae(e))=="string"||e instanceof or?FE(s,"updateDoc",n._key,e,t,r):ME(s,"updateDoc",n._key,e),mo(i,[a.toMutation(n._key,rt.exists(!0))])}function Ym(n){return mo(He(n.firestore,Et),[new ri(n._key,rt.none())])}function Jm(n,e){let t=He(n.firestore,Et),r=yl(n),i=Gm(n.converter,e);return mo(t,[Fm(fo(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,rt.exists(!1))]).then(()=>r)}function mo(n,e){return function(r,i){let s=new ze;return r.asyncQueue.enqueueAndForget(()=>g(null,null,function*(){return IE(yield DE(r),i,s)})),s.promise}(vl(n),e)}function $E(n,e,t){let r=t.docs.get(e._key),i=new ro(n);return new no(n,i,e._key,r,new hn(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){ar=i})(Ot),je(new Se("firestore",(r,{instanceIdentifier:i,options:s})=>{let a=r.getProvider("app").getImmediate(),u=new Et(new mc(r.getProvider("auth-internal")),new yc(a,r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new V(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ss(d.options.projectId,p)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),ie(Ef,wf,e),ie(Ef,wf,"esm2017")})();var jE="firebase",zE="11.7.3";ie(jE,zE,"app");function wl(n){n===void 0&&(Ld(wl),n=Qe(dt));let e=n.get(ns);return t=>new en(r=>{let i=e.add(),s=!1;function a(){s||(i(),s=!0)}let u=t.subscribe({next:l=>{r.next(l),a()},complete:()=>{r.complete(),a()},error:l=>{r.error(l),a()}});return u.add(()=>{r.unsubscribe(),a()}),u})}var qt=new Na("ANGULARFIRE2_VERSION");function gi(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(a=>a.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var dr=(n,e)=>{let t=e?[e]:hs(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},hr=function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n}(hr||{}),Xm=Va()&&typeof Zone<"u"?hr.WARN:hr.SILENT;var go=class{zone;delegate;constructor(e,t=Od){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(a){i?i.runGuarded(()=>{e.apply(this,[a])}):e.apply(this,[a])};return this.delegate.schedule(s,t,r)}},$t=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=Qe(Ye);this.outsideAngular=t.runOutsideAngular(()=>new go(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new go(typeof Zone>"u"?void 0:Zone.current,Vd))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=On({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Zm=!1;function GE(n,e){!Zm&&(Xm>hr.SILENT||Va())&&(Zm=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),Xm>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function WE(n){let e=Qe(Ye,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function En(n){let e=Qe(Ye,{optional:!0});return e?e.run(()=>n()):n()}var HE=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),es(t,()=>En(()=>n.apply(void 0,r)))),oe=(n,e,t)=>(t||=e?hr.WARN:hr.VERBOSE,function(){let r,i=arguments,s,a,u;try{s=Qe($t),a=Qe(ns),u=Qe(Fd)}catch{return GE(n,t),n.apply(this,i)}for(let d=0;d<arguments.length;d++)typeof i[d]=="function"&&(e&&(r||=En(()=>a.add())),i[d]=HE(i[d],r,u));let l=WE(()=>n.apply(this,i));return e?l instanceof en?l.pipe(Ca(s.outsideAngular),ba(s.insideAngular),wl(u)):l instanceof Promise?En(()=>new Promise((d,p)=>{a.run(()=>l).then(v=>es(u,()=>En(()=>d(v))),v=>es(u,()=>En(()=>p(v))))})):typeof l=="function"&&r?function(){return setTimeout(r,0),l.apply(this,arguments)}:En(()=>l):l instanceof en?l.pipe(Ca(s.outsideAngular),ba(s.insideAngular)):En(()=>l)});var wt=class{constructor(e){return e}},wn=class{constructor(){return hs()}};function KE(n){return n&&n.length===1?n[0]:new wt(cn())}var Tl=new Ve("angularfire2._apps"),QE={provide:wt,useFactory:KE,deps:[[new Fe,Tl]]},YE={provide:wn,deps:[[new Fe,Tl]]};function JE(n){return(e,t)=>{let r=t.get(Ud);ie("angularfire",qt.full,"core"),ie("angularfire",qt.full,"app"),ie("angular",qd.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new wt(i)}}function lC(n,...e){return xn([QE,YE,{provide:Tl,useFactory:JE(n),multi:!0,deps:[Ye,dt,$t,...e]}])}var hC=oe(nc,!0);var XE=new Map,ZE={activated:!1,tokenObservers:[]},ew={initialized:!1,enabled:!1};function Ke(n){return XE.get(n)||Object.assign({},ZE)}function ig(){return ew}var tw="https://content-firebaseappcheck.googleapis.com/v1";var nw="exchangeDebugToken",tg={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},IC=24*60*60*1e3;var Cl=class{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return g(this,null,function*(){this.stop();try{this.pending=new sn,this.pending.promise.catch(t=>{}),yield rw(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new sn,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function rw(n){return new Promise(e=>{setTimeout(e,n)})}var iw={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},jt=new $e("appCheck","AppCheck",iw);function sg(n){if(!Ke(n).activated)throw jt.create("use-before-activation",{appName:n.name})}function og(r,i){return g(this,arguments,function*({url:n,body:e},t){let s={"Content-Type":"application/json"},a=t.getImmediate({optional:!0});if(a){let S=yield a.getHeartbeatsHeader();S&&(s["X-Firebase-Client"]=S)}let u={method:"POST",body:JSON.stringify(e),headers:s},l;try{l=yield fetch(n,u)}catch(S){throw jt.create("fetch-network-error",{originalErrorMessage:S?.message})}if(l.status!==200)throw jt.create("fetch-status-error",{httpStatus:l.status});let d;try{d=yield l.json()}catch(S){throw jt.create("fetch-parse-error",{originalErrorMessage:S?.message})}let p=d.ttl.match(/^([\d.]+)(s)$/);if(!p||!p[2]||isNaN(Number(p[1])))throw jt.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${d.ttl}`});let v=Number(p[1])*1e3,I=Date.now();return{token:d.token,expireTimeMillis:I+v,issuedAtTimeMillis:I}})}function ag(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${tw}/projects/${t}/apps/${r}:${nw}?key=${i}`,body:{debug_token:e}}}var sw="firebase-app-check-database",ow=1,Sl="firebase-app-check-store";var _o=null;function aw(){return _o||(_o=new Promise((n,e)=>{try{let t=indexedDB.open(sw,ow);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(jt.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Sl,{keyPath:"compositeKey"})}}}catch(t){e(jt.create("storage-open",{originalErrorMessage:t?.message}))}}),_o)}function cw(n,e){return uw(lw(n),e)}function uw(n,e){return g(this,null,function*(){let r=(yield aw()).transaction(Sl,"readwrite"),s=r.objectStore(Sl).put({compositeKey:n,value:e});return new Promise((a,u)=>{s.onsuccess=l=>{a()},r.onerror=l=>{var d;u(jt.create("storage-set",{originalErrorMessage:(d=l.target.error)===null||d===void 0?void 0:d.message}))}})})}function lw(n){return`${n.options.appId}-${n.name}`}var _i=new Ze("@firebase/app-check");function Al(n,e){return jr()?cw(n,e).catch(t=>{_i.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function cg(){return ig().enabled}function ug(){return g(this,null,function*(){let n=ig();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var hw={error:"UNKNOWN_ERROR"};function dw(n){return ss.encodeString(JSON.stringify(n),!1)}function Rl(n,e=!1,t=!1){return g(this,null,function*(){let r=n.app;sg(r);let i=Ke(r),s=i.token,a;if(s&&!yi(s)&&(i.token=void 0,s=void 0),!s){let d=yield i.cachedTokenPromise;d&&(yi(d)?s=d:yield Al(r,void 0))}if(!e&&s&&yi(s))return{token:s.token};let u=!1;if(cg())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=og(ag(r,yield ug()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),u=!0);let d=yield i.exchangeTokenPromise;return yield Al(r,d),i.token=d,{token:d.token}}catch(d){return d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?_i.warn(d.message):t&&_i.error(d),bl(d)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),u=!0),s=yield Ke(r).exchangeTokenPromise}catch(d){d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?_i.warn(d.message):t&&_i.error(d),a=d}let l;return s?a?yi(s)?l={token:s.token,internalError:a}:l=bl(a):(l={token:s.token},i.token=s,yield Al(r,s)):l=bl(a),u&&gw(r,l),l})}function fw(n){return g(this,null,function*(){let e=n.app;sg(e);let{provider:t}=Ke(e);if(cg()){let r=yield ug(),{token:i}=yield og(ag(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function pw(n,e,t,r){let{app:i}=n,s=Ke(i),a={next:t,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,a],s.token&&yi(s.token)){let u=s.token;Promise.resolve().then(()=>{t({token:u.token}),ng(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>ng(n))}function lg(n,e){let t=Ke(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function ng(n){let{app:e}=n,t=Ke(e),r=t.tokenRefresher;r||(r=mw(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function mw(n){let{app:e}=n;return new Cl(()=>g(null,null,function*(){let t=Ke(e),r;if(t.token?r=yield Rl(n,!0):r=yield Rl(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=Ke(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},tg.RETRIAL_MIN_WAIT,tg.RETRIAL_MAX_WAIT)}function gw(n,e){let t=Ke(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function yi(n){return n.expireTimeMillis-Date.now()>0}function bl(n){return{token:dw(hw),error:n}}var Pl=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Ke(this.app);for(let t of e)lg(this.app,t.next);return Promise.resolve()}};function _w(n,e){return new Pl(n,e)}function yw(n){return{getToken:e=>Rl(n,e),getLimitedUseToken:()=>fw(n),addTokenListener:e=>pw(n,"INTERNAL",e),removeTokenListener:e=>lg(n.app,e)}}var vw="@firebase/app-check",Iw="0.9.3";var Ew="app-check",rg="app-check-internal";function ww(){je(new Se(Ew,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return _w(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(rg).initialize()})),je(new Se(rg,n=>{let e=n.getProvider("app-check").getImmediate();return yw(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),ie(vw,Iw)}ww();var Tw="app-check";var fr=class{constructor(){return dr(Tw)}};var Aw=["localhost","0.0.0.0","127.0.0.1"],VC=typeof window<"u"&&Aw.includes(window.location.hostname);function Cg(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Sg=Cg,Rg=new $e("auth","Firebase",Cg());var To=new Ze("@firebase/auth");function bw(n,...e){To.logLevel<=G.WARN&&To.warn(`Auth (${Ot}): ${n}`,...e)}function vo(n,...e){To.logLevel<=G.ERROR&&To.error(`Auth (${Ot}): ${n}`,...e)}function ct(n,...e){throw eh(n,...e)}function Tn(n,...e){return eh(n,...e)}function Pg(n,e,t){let r=Object.assign(Object.assign({},Sg()),{[e]:t});return new $e("auth","Firebase",r).create(e,{appName:n.name})}function bt(n){return Pg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function eh(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Rg.create(n,...e)}function L(n,e,...t){if(!n)throw eh(e,...t)}function Tt(n){let e="INTERNAL ASSERTION FAILED: "+n;throw vo(e),new Error(e)}function Wt(n,e){n||Tt(e)}function Vl(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Cw(){return hg()==="http:"||hg()==="https:"}function hg(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function Sw(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Cw()||Jd()||"connection"in navigator)?navigator.onLine:!0}function Rw(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var An=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Wt(t>e,"Short delay should be less than long delay!"),this.isMobile=Qd()||Xd()}get(){return Sw()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function th(n,e){Wt(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Ao=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Tt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Tt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Tt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var Pw={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var Dw=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],kw=new An(3e4,6e4);function Ht(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function Kt(s,a,u,l){return g(this,arguments,function*(n,e,t,r,i={}){return Dg(n,i,()=>g(null,null,function*(){let d={},p={};r&&(e==="GET"?p=r:d={body:JSON.stringify(r)});let v=zr(Object.assign({key:n.config.apiKey},p)).slice(1),I=yield n._getAdditionalHeaders();I["Content-Type"]="application/json",n.languageCode&&(I["X-Firebase-Locale"]=n.languageCode);let S=Object.assign({method:e,headers:I},d);return Yd()||(S.referrerPolicy="no-referrer"),n.emulatorConfig&&on(n.emulatorConfig.host)&&(S.credentials="include"),Ao.fetch()(yield kg(n,n.config.apiHost,t,v),S)}))})}function Dg(n,e,t){return g(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},Pw),e);try{let i=new Ol(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield s.json();if("needConfirmation"in a)throw yo(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{let u=s.ok?a.errorMessage:a.error.message,[l,d]=u.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw yo(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw yo(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw yo(n,"user-disabled",a);let p=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Pg(n,p,d);ct(n,p)}}catch(i){if(i instanceof Oe)throw i;ct(n,"network-request-failed",{message:String(i)})}})}function Si(s,a,u,l){return g(this,arguments,function*(n,e,t,r,i={}){let d=yield Kt(n,e,t,r,i);return"mfaPendingCredential"in d&&ct(n,"multi-factor-auth-required",{_serverResponse:d}),d})}function kg(n,e,t,r){return g(this,null,function*(){let i=`${e}${t}?${r}`,s=n,a=s.config.emulator?th(n.config,i):`${n.config.apiScheme}://${i}`;return Dw.includes(t)&&(yield s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a})}function Nw(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var Ol=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Tn(this.auth,"network-request-failed")),kw.get())})}};function yo(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Tn(n,e,r);return i.customData._tokenResponse=t,i}function dg(n){return n!==void 0&&n.enterprise!==void 0}var xl=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Nw(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}};function Vw(n,e){return g(this,null,function*(){return Kt(n,"GET","/v2/recaptchaConfig",Ht(n,e))})}function Ow(n,e){return g(this,null,function*(){return Kt(n,"POST","/v1/accounts:delete",e)})}function bo(n,e){return g(this,null,function*(){return Kt(n,"POST","/v1/accounts:lookup",e)})}function Ii(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function nh(n,e=!1){return g(this,null,function*(){let t=ae(n),r=yield t.getIdToken(e),i=rh(r);L(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:Ii(Dl(i.auth_time)),issuedAtTime:Ii(Dl(i.iat)),expirationTime:Ii(Dl(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function Dl(n){return Number(n)*1e3}function rh(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return vo("JWT malformed, contained fewer than 3 sections"),null;try{let i=os(t);return i?JSON.parse(i):(vo("Failed to decode base64 JWT payload"),null)}catch(i){return vo("Caught error parsing JWT payload as JSON",i?.toString()),null}}function fg(n){let e=rh(n);return L(e,"internal-error"),L(typeof e.exp<"u","internal-error"),L(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function wi(n,e,t=!1){return g(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Oe&&xw(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function xw({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Ml=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>g(this,null,function*(){yield this.iteration()}),t)}iteration(){return g(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Ti=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ii(this.lastLoginAt),this.creationTime=Ii(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Co(n){return g(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield wi(n,bo(t,{idToken:r}));L(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Ng(s.providerUserInfo):[],u=Mw(n.providerData,a),l=n.isAnonymous,d=!(n.email&&s.passwordHash)&&!u?.length,p=l?d:!1,v={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:u,metadata:new Ti(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,v)})}function ih(n){return g(this,null,function*(){let e=ae(n);yield Co(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function Mw(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Ng(n){return n.map(e=>{var{providerId:t}=e,r=Aa(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function Fw(n,e){return g(this,null,function*(){let t=yield Dg(n,{},()=>g(null,null,function*(){let r=zr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=yield kg(n,i,"/v1/token",`key=${s}`),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",Ao.fetch()(a,{method:"POST",headers:u,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function Lw(n,e){return g(this,null,function*(){return Kt(n,"POST","/v2/accounts:revokeToken",Ht(n,e))})}var Ei=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){L(e.idToken,"internal-error"),L(typeof e.idToken<"u","internal-error"),L(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):fg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){L(e.length!==0,"internal-error");let t=fg(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return g(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(L(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return g(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield Fw(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new n;return r&&(L(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(L(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(L(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Tt("not implemented")}};function zt(n,e){L(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Gt=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Aa(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Ml(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ti(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return g(this,null,function*(){let t=yield wi(this,this.stsTokenManager.getToken(this.auth,e));return L(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return nh(this,e)}reload(){return ih(this)}_assign(e){this!==e&&(L(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){L(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return g(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Co(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return g(this,null,function*(){if(De(this.auth.app))return Promise.reject(bt(this.auth));let e=yield this.getIdToken();return yield wi(this,Ow(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,a,u,l,d,p;let v=(r=t.displayName)!==null&&r!==void 0?r:void 0,I=(i=t.email)!==null&&i!==void 0?i:void 0,S=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,D=(a=t.photoURL)!==null&&a!==void 0?a:void 0,x=(u=t.tenantId)!==null&&u!==void 0?u:void 0,k=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,z=(d=t.createdAt)!==null&&d!==void 0?d:void 0,U=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:$,emailVerified:X,isAnonymous:Ae,providerData:J,stsTokenManager:w}=t;L($&&w,e,"internal-error");let m=Ei.fromJSON(this.name,w);L(typeof $=="string",e,"internal-error"),zt(v,e.name),zt(I,e.name),L(typeof X=="boolean",e,"internal-error"),L(typeof Ae=="boolean",e,"internal-error"),zt(S,e.name),zt(D,e.name),zt(x,e.name),zt(k,e.name),zt(z,e.name),zt(U,e.name);let y=new n({uid:$,auth:e,email:I,emailVerified:X,displayName:v,isAnonymous:Ae,photoURL:D,phoneNumber:S,tenantId:x,stsTokenManager:m,createdAt:z,lastLoginAt:U});return J&&Array.isArray(J)&&(y.providerData=J.map(E=>Object.assign({},E))),k&&(y._redirectEventId=k),y}static _fromIdTokenResponse(e,t,r=!1){return g(this,null,function*(){let i=new Ei;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Co(s),s})}static _fromGetAccountInfoResponse(e,t,r){return g(this,null,function*(){let i=t.users[0];L(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?Ng(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,u=new Ei;u.updateFromIdToken(r);let l=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Ti(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,d),l})}};var pg=new Map;function At(n){Wt(n instanceof Function,"Expected a class definition");let e=pg.get(n);return e?(Wt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,pg.set(n,e),e)}var Uw=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return g(this,null,function*(){return!0})}_set(t,r){return g(this,null,function*(){this.storage[t]=r})}_get(t){return g(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return g(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Fl=Uw;function Io(n,e,t){return`firebase:${n}:${e}:${t}`}var So=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Io(this.userKey,i.apiKey,s),this.fullPersistenceKey=Io("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return g(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=yield bo(this.auth,{idToken:e}).catch(()=>{});return t?Gt._fromGetAccountInfoResponse(this.auth,t,e):null}return Gt._fromJSON(this.auth,e)})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return g(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return g(this,null,function*(){if(!t.length)return new n(At(Fl),e,r);let i=(yield Promise.all(t.map(d=>g(null,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),s=i[0]||At(Fl),a=Io(r,e.config.apiKey,e.name),u=null;for(let d of t)try{let p=yield d._get(a);if(p){let v;if(typeof p=="string"){let I=yield bo(e,{idToken:p}).catch(()=>{});if(!I)break;v=yield Gt._fromGetAccountInfoResponse(e,I,p)}else v=Gt._fromJSON(e,p);d!==s&&(u=v),s=d;break}}catch{}let l=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new n(s,e,r):(s=l[0],u&&(yield s._set(a,u.toJSON())),yield Promise.all(t.map(d=>g(null,null,function*(){if(d!==s)try{yield d._remove(a)}catch{}}))),new n(s,e,r))})}};function mg(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Mg(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Vg(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Lg(e))return"Blackberry";if(Ug(e))return"Webos";if(Og(e))return"Safari";if((e.includes("chrome/")||xg(e))&&!e.includes("edge/"))return"Chrome";if(Fg(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Vg(n=de()){return/firefox\//i.test(n)}function Og(n=de()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function xg(n=de()){return/crios\//i.test(n)}function Mg(n=de()){return/iemobile/i.test(n)}function Fg(n=de()){return/android/i.test(n)}function Lg(n=de()){return/blackberry/i.test(n)}function Ug(n=de()){return/webos/i.test(n)}function sh(n=de()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Bw(n=de()){var e;return sh(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function qw(){return Zd()&&document.documentMode===10}function Bg(n=de()){return sh(n)||Fg(n)||Ug(n)||Lg(n)||/windows phone/i.test(n)||Mg(n)}function qg(n,e=[]){let t;switch(n){case"Browser":t=mg(de());break;case"Worker":t=`${mg(de())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ot}/${r}`}var Ll=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((a,u)=>{try{let l=e(s);a(l)}catch(l){u(l)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return g(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function $w(t){return g(this,arguments,function*(n,e={}){return Kt(n,"GET","/v2/passwordPolicy",Ht(n,e))})}var jw=6,Ul=class{constructor(e){var t,r,i,s;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:jw,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,a,u;let l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(u=l.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),l}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Bl=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ro(this),this.idTokenSubscription=new Ro(this),this.beforeStateQueue=new Ll(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Rg,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=At(t)),this._initializationPromise=this.queue(()=>g(this,null,function*(){var r,i,s;if(!this._deleted&&(this.persistenceManager=yield So.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return g(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return g(this,null,function*(){try{let t=yield bo(this,{idToken:e}),r=yield Gt._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return g(this,null,function*(){var t;if(De(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i?._redirectEventId,l=yield this.tryRedirectSignIn(e);(!a||a===u)&&l?.user&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return L(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return g(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return g(this,null,function*(){try{yield Co(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=Rw()}_delete(){return g(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return g(this,null,function*(){if(De(this.app))return Promise.reject(bt(this));let t=e?ae(e):null;return t&&L(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return g(this,null,function*(){if(!this._deleted)return e&&L(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>g(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return g(this,null,function*(){return De(this.app)?Promise.reject(bt(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return De(this.app)?Promise.reject(bt(this)):this.queue(()=>g(this,null,function*(){yield this.assertedPersistence.setPersistence(At(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return g(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return g(this,null,function*(){let e=yield $w(this),t=new Ul(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new $e("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return g(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield Lw(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return g(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return g(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&At(e)||this._popupRedirectResolver;L(t,this,"argument-error"),this.redirectPersistenceManager=yield So.create(this,[At(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return g(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>g(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return g(this,null,function*(){if(e===this.currentUser)return this.queue(()=>g(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(L(u,this,"internal-error"),u.then(()=>{a||s(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{let l=e.addObserver(t);return()=>{a=!0,l()}}}directlySetCurrentUser(e){return g(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return L(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=qg(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return g(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return g(this,null,function*(){var e;if(De(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&bw(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Cn(n){return ae(n)}var Ro=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=rf(t=>this.observer=t)}get next(){return L(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var xo={loadJS(){return g(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function zw(n){xo=n}function $g(n){return xo.loadJS(n)}function Gw(){return xo.recaptchaEnterpriseScript}function Ww(){return xo.gapiScript}function jg(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var ql=class{constructor(){this.enterprise=new $l}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}},$l=class{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}};var Hw="recaptcha-enterprise",zg="NO_RECAPTCHA",jl=class{constructor(e){this.type=Hw,this.auth=Cn(e)}verify(e="verify",t=!1){return g(this,null,function*(){function r(s){return g(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((a,u)=>g(null,null,function*(){Vw(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{let d=new xl(l);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,a(d.siteKey)}}).catch(l=>{u(l)})}))})}function i(s,a,u){let l=window.grecaptcha;dg(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(d=>{a(d)}).catch(()=>{a(zg)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new ql().execute("siteKey",{action:"verify"}):new Promise((s,a)=>{r(this.auth).then(u=>{if(!t&&dg(window.grecaptcha))i(u,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=Gw();l.length!==0&&(l+=u),$g(l).then(()=>{i(u,s,a)}).catch(d=>{a(d)})}}).catch(u=>{a(u)})})})}};function vi(n,e,t,r=!1,i=!1){return g(this,null,function*(){let s=new jl(n),a;if(i)a=zg;else try{a=yield s.verify(t)}catch{a=yield s.verify(t,!0)}let u=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){let l=u.phoneEnrollmentInfo.phoneNumber,d=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:d,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){let l=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return r?Object.assign(u,{captchaResp:a}):Object.assign(u,{captchaResponse:a}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u})}function zl(n,e,t,r,i){return g(this,null,function*(){var s,a;if(i==="EMAIL_PASSWORD_PROVIDER")if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let u=yield vi(n,e,t,t==="getOobCode");return r(n,u)}else return r(n,e).catch(u=>g(null,null,function*(){if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let l=yield vi(n,e,t,t==="getOobCode");return r(n,l)}else return Promise.reject(u)}));else if(i==="PHONE_PROVIDER")if(!((a=n._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("PHONE_PROVIDER")){let u=yield vi(n,e,t);return r(n,u).catch(l=>g(null,null,function*(){var d;if(((d=n._getRecaptchaConfig())===null||d===void 0?void 0:d.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(l.code==="auth/missing-recaptcha-token"||l.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);let p=yield vi(n,e,t,!1,!0);return r(n,p)}return Promise.reject(l)}))}else{let u=yield vi(n,e,t,!1,!0);return r(n,u)}else return Promise.reject(i+" provider is not supported.")})}function oh(n,e){let t=Un(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(Xe(s,e??{}))return i;ct(i,"already-initialized")}return t.initialize({options:e})}function Kw(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(At);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function ah(n,e,t){let r=Cn(n);L(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=Gg(e),{host:a,port:u}=Qw(e),l=u===null?"":`:${u}`,d={url:`${s}//${a}${l}/`},p=Object.freeze({host:a,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){L(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),L(Xe(d,r.config.emulator)&&Xe(p,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=p,r.settings.appVerificationDisabledForTesting=!0,on(a)?(Mn("Auth",!0),cs(`${s}//${a}${l}`)):i||Yw()}function Gg(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Qw(n){let e=Gg(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:gg(r.substr(s.length+1))}}else{let[s,a]=r.split(":");return{host:s,port:gg(a)}}}function gg(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function Yw(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Ai=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Tt("not implemented")}_getIdTokenResponse(e){return Tt("not implemented")}_linkToIdToken(e,t){return Tt("not implemented")}_getReauthenticationResolver(e){return Tt("not implemented")}};function Jw(n,e){return g(this,null,function*(){return Kt(n,"POST","/v1/accounts:signUp",e)})}function Xw(n,e){return g(this,null,function*(){return Si(n,"POST","/v1/accounts:signInWithPassword",Ht(n,e))})}function Zw(n,e){return g(this,null,function*(){return Si(n,"POST","/v1/accounts:signInWithEmailLink",Ht(n,e))})}function eT(n,e){return g(this,null,function*(){return Si(n,"POST","/v1/accounts:signInWithEmailLink",Ht(n,e))})}var bi=class n extends Ai{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return g(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return zl(e,t,"signInWithPassword",Xw,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Zw(e,{email:this._email,oobCode:this._password});default:ct(e,"internal-error")}})}_linkToIdToken(e,t){return g(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return zl(e,r,"signUpPassword",Jw,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return eT(e,{idToken:t,email:this._email,oobCode:this._password});default:ct(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function kl(n,e){return g(this,null,function*(){return Si(n,"POST","/v1/accounts:signInWithIdp",Ht(n,e))})}function tT(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function nT(n){let e=Fn(Ln(n)).link,t=e?Fn(Ln(e)).deep_link_id:null,r=Fn(Ln(n)).deep_link_id;return(r?Fn(Ln(r)).link:null)||r||t||e||n}var Po=class n{constructor(e){var t,r,i,s,a,u;let l=Fn(Ln(e)),d=(t=l.apiKey)!==null&&t!==void 0?t:null,p=(r=l.oobCode)!==null&&r!==void 0?r:null,v=tT((i=l.mode)!==null&&i!==void 0?i:null);L(d&&p&&v,"argument-error"),this.apiKey=d,this.operation=v,this.code=p,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=l.lang)!==null&&a!==void 0?a:null,this.tenantId=(u=l.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){let t=nT(e);try{return new n(t)}catch{return null}}};var Wg=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return bi._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=Po.parseLink(r);return L(i,"argument-error"),bi._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Do=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Gl=class extends Do{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};function rT(n,e){return g(this,null,function*(){return Si(n,"POST","/v1/accounts:signUp",Ht(n,e))})}var pr=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return g(this,null,function*(){let s=yield Gt._fromIdTokenResponse(e,r,i),a=_g(r);return new n({user:s,providerId:a,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return g(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=_g(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function _g(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var Wl=class n extends Oe{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function Hg(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Wl._fromErrorAndOperation(n,s,e,r):s})}function iT(n,e,t=!1){return g(this,null,function*(){let r=yield wi(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return pr._forOperation(n,"link",r)})}function sT(n,e,t=!1){return g(this,null,function*(){let{auth:r}=n;if(De(r.app))return Promise.reject(bt(r));let i="reauthenticate";try{let s=yield wi(n,Hg(r,i,e,n),t);L(s.idToken,r,"internal-error");let a=rh(s.idToken);L(a,r,"internal-error");let{sub:u}=a;return L(n.uid===u,r,"user-mismatch"),pr._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&ct(r,"user-mismatch"),s}})}function Kg(n,e,t=!1){return g(this,null,function*(){if(De(n.app))return Promise.reject(bt(n));let r="signIn",i=yield Hg(n,r,e),s=yield pr._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function ch(n,e){return g(this,null,function*(){return Kg(Cn(n),e)})}function Qg(n){return g(this,null,function*(){let e=Cn(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function uh(n,e,t){return g(this,null,function*(){if(De(n.app))return Promise.reject(bt(n));let r=Cn(n),a=yield zl(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",rT,"EMAIL_PASSWORD_PROVIDER").catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&Qg(n),l}),u=yield pr._fromIdTokenResponse(r,"signIn",a);return yield r._updateCurrentUser(u.user),u})}function lh(n,e,t){return De(n.app)?Promise.reject(bt(n)):ch(ae(n),Wg.credential(e,t)).catch(r=>g(null,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&Qg(n),r}))}function Mo(n,e,t,r){return ae(n).onIdTokenChanged(e,t,r)}function hh(n,e,t){return ae(n).beforeAuthStateChanged(e,t)}function Fo(n,e,t,r){return ae(n).onAuthStateChanged(e,t,r)}function dh(n){return ae(n).signOut()}var ko="__sak";var No=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ko,"1"),this.storage.removeItem(ko),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var oT=1e3,aT=10,cT=(()=>{class n extends No{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Bg(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((u,l,d)=>{this.notifyListeners(u,d)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let u=this.storage.getItem(i);!r&&this.localCache[i]===u||this.notifyListeners(i,u)},a=this.storage.getItem(i);qw()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,aT):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},oT)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return g(this,null,function*(){yield Dt(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return g(this,null,function*(){let r=yield Dt(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return g(this,null,function*(){yield Dt(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),Yg=cT;var uT=(()=>{class n extends No{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),fh=uT;function lT(n){return Promise.all(n.map(e=>g(null,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var hT=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return g(this,null,function*(){let r=t,{eventId:i,eventType:s,data:a}=r.data,u=this.handlersMap[s];if(!u?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let l=Array.from(u).map(p=>g(this,null,function*(){return p(r.origin,a)})),d=yield lT(l);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:d})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function Jg(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var Hl=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return g(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((u,l)=>{let d=Jg("",20);i.port1.start();let p=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(v){let I=v;if(I.data.eventId===d)switch(I.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(I.data.response);break;default:clearTimeout(p),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}};function at(){return window}function dT(n){at().location.href=n}function Xg(){return typeof at().WorkerGlobalScope<"u"&&typeof at().importScripts=="function"}function fT(){return g(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function pT(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function mT(){return Xg()?self:null}var Zg="firebaseLocalStorageDb",gT=1,Vo="firebaseLocalStorage",e_="fbase_key",bn=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Lo(n,e){return n.transaction([Vo],e?"readwrite":"readonly").objectStore(Vo)}function _T(){let n=indexedDB.deleteDatabase(Zg);return new bn(n).toPromise()}function Kl(){let n=indexedDB.open(Zg,gT);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Vo,{keyPath:e_})}catch(i){t(i)}}),n.addEventListener("success",()=>g(null,null,function*(){let r=n.result;r.objectStoreNames.contains(Vo)?e(r):(r.close(),yield _T(),e(yield Kl()))}))})}function yg(n,e,t){return g(this,null,function*(){let r=Lo(n,!0).put({[e_]:e,value:t});return new bn(r).toPromise()})}function yT(n,e){return g(this,null,function*(){let t=Lo(n,!1).get(e),r=yield new bn(t).toPromise();return r===void 0?null:r.value})}function vg(n,e){let t=Lo(n,!0).delete(e);return new bn(t).toPromise()}var vT=800,IT=3,ET=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return g(this,null,function*(){return this.db?this.db:(this.db=yield Kl(),this.db)})}_withRetries(t){return g(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>IT)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return g(this,null,function*(){return Xg()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return g(this,null,function*(){this.receiver=hT._getInstance(mT()),this.receiver._subscribe("keyChanged",(t,r)=>g(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>g(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return g(this,null,function*(){var t,r;if(this.activeServiceWorker=yield fT(),!this.activeServiceWorker)return;this.sender=new Hl(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return g(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||pT()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return g(this,null,function*(){try{if(!indexedDB)return!1;let t=yield Kl();return yield yg(t,ko,"1"),yield vg(t,ko),!0}catch{}return!1})}_withPendingWrite(t){return g(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(i=>yg(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return g(this,null,function*(){let r=yield this._withRetries(i=>yT(i,t));return this.localCache[t]=r,r})}_remove(t){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(r=>vg(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return g(this,null,function*(){let t=yield this._withRetries(s=>{let a=Lo(s,!1).getAll();return new bn(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:a}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>g(this,null,function*(){return this._poll()}),vT)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),t_=ET;var qC=jg("rcb"),$C=new An(3e4,6e4);function wT(n,e){return e?At(e):(L(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Ci=class extends Ai{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return kl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return kl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return kl(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function TT(n){return Kg(n.auth,new Ci(n),n.bypassAuthState)}function AT(n){let{auth:e,user:t}=n;return L(t,e,"internal-error"),sT(t,new Ci(n),n.bypassAuthState)}function bT(n){return g(this,null,function*(){let{auth:e,user:t}=n;return L(t,e,"internal-error"),iT(t,new Ci(n),n.bypassAuthState)})}var Ql=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>g(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return g(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:u}=e;if(a){this.reject(a);return}let l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(u)(l))}catch(d){this.reject(d)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return TT;case"linkViaPopup":case"linkViaRedirect":return bT;case"reauthViaPopup":case"reauthViaRedirect":return AT;default:ct(this.auth,"internal-error")}}resolve(e){Wt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Wt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var jC=new An(2e3,1e4);var CT="pendingRedirect",Eo=new Map,Yl=class n extends Ql{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return g(this,null,function*(){let e=Eo.get(this.auth._key());if(!e){try{let r=(yield ST(this.resolver,this.auth))?yield Dt(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Eo.set(this.auth._key(),e)}return this.bypassAuthState||Eo.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return g(this,null,function*(){if(e.type==="signInViaRedirect")return Dt(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Dt(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return g(this,null,function*(){})}cleanUp(){}};function ST(n,e){return g(this,null,function*(){let t=DT(e),r=PT(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function RT(n,e){Eo.set(n._key(),e)}function PT(n){return At(n._redirectPersistence)}function DT(n){return Io(CT,n.config.apiKey,n.name)}function kT(n,e,t=!1){return g(this,null,function*(){if(De(n.app))return Promise.reject(bt(n));let r=Cn(n),i=wT(r,e),a=yield new Yl(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,e)),a})}var NT=10*60*1e3,Jl=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!VT(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!n_(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Tn(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=NT&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ig(e))}saveEventToCache(e){this.cachedEventUids.add(Ig(e)),this.lastProcessedEventTime=Date.now()}};function Ig(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function n_({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function VT(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return n_(n);default:return!1}}function OT(t){return g(this,arguments,function*(n,e={}){return Kt(n,"GET","/v1/projects",e)})}var xT=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,MT=/^https?/;function FT(n){return g(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield OT(n);for(let t of e)try{if(LT(t))return}catch{}ct(n,"unauthorized-domain")})}function LT(n){let e=Vl(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!MT.test(t))return!1;if(xT.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var UT=new An(3e4,6e4);function Eg(){let n=at().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function BT(n){return new Promise((e,t)=>{var r,i,s;function a(){Eg(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Eg(),t(Tn(n,"network-request-failed"))},timeout:UT.get()})}if(!((i=(r=at().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=at().gapi)===null||s===void 0)&&s.load)a();else{let u=jg("iframefcb");return at()[u]=()=>{gapi.load?a():t(Tn(n,"network-request-failed"))},$g(`${Ww()}?onload=${u}`).catch(l=>t(l))}}).catch(e=>{throw wo=null,e})}var wo=null;function qT(n){return wo=wo||BT(n),wo}var $T=new An(5e3,15e3),jT="__/auth/iframe",zT="emulator/auth/iframe",GT={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},WT=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function HT(n){let e=n.config;L(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?th(e,zT):`https://${n.config.authDomain}/${jT}`,r={apiKey:e.apiKey,appName:n.name,v:Ot},i=WT.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${zr(r).slice(1)}`}function KT(n){return g(this,null,function*(){let e=yield qT(n),t=at().gapi;return L(t,n,"internal-error"),e.open({where:document.body,url:HT(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:GT,dontclear:!0},r=>new Promise((i,s)=>g(null,null,function*(){yield r.restyle({setHideOnLeave:!1});let a=Tn(n,"network-request-failed"),u=at().setTimeout(()=>{s(a)},$T.get());function l(){at().clearTimeout(u),i(r)}r.ping(l).then(l,()=>{s(a)})})))})}var QT={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},YT=500,JT=600,XT="_blank",ZT="http://localhost",Oo=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function eA(n,e,t,r=YT,i=JT){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",l=Object.assign(Object.assign({},QT),{width:r.toString(),height:i.toString(),top:s,left:a}),d=de().toLowerCase();t&&(u=xg(d)?XT:t),Vg(d)&&(e=e||ZT,l.scrollbars="yes");let p=Object.entries(l).reduce((I,[S,D])=>`${I}${S}=${D},`,"");if(Bw(d)&&u!=="_self")return tA(e||"",u),new Oo(null);let v=window.open(e||"",u,p);L(v,n,"popup-blocked");try{v.focus()}catch{}return new Oo(v)}function tA(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var nA="__/auth/handler",rA="emulator/auth/handler",iA=encodeURIComponent("fac");function wg(n,e,t,r,i,s){return g(this,null,function*(){L(n.config.authDomain,n,"auth-domain-config-required"),L(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Ot,eventId:i};if(e instanceof Do){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",nf(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[p,v]of Object.entries(s||{}))a[p]=v}if(e instanceof Gl){let p=e.getScopes().filter(v=>v!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);let u=a;for(let p of Object.keys(u))u[p]===void 0&&delete u[p];let l=yield n._getAppCheckToken(),d=l?`#${iA}=${encodeURIComponent(l)}`:"";return`${sA(n)}?${zr(u).slice(1)}${d}`})}function sA({config:n}){return n.emulator?th(n,rA):`https://${n.authDomain}/${nA}`}var Nl="webStorageSupport",Xl=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=fh,this._completeRedirectFn=kT,this._overrideRedirectResult=RT}_openPopup(e,t,r,i){return g(this,null,function*(){var s;Wt((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let a=yield wg(e,t,r,Vl(),i);return eA(e,a,Jg())})}_openRedirect(e,t,r,i){return g(this,null,function*(){yield this._originValidation(e);let s=yield wg(e,t,r,Vl(),i);return dT(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Wt(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return g(this,null,function*(){let t=yield KT(e),r=new Jl(e);return t.register("authEvent",i=>(L(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Nl,{type:Nl},i=>{var s;let a=(s=i?.[0])===null||s===void 0?void 0:s[Nl];a!==void 0&&t(!!a),ct(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=FT(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Bg()||Og()||sh()}},r_=Xl;var Tg="@firebase/auth",Ag="1.10.4";var Zl=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return g(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){L(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function oA(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function aA(n){je(new Se("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;L(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let l={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:qg(n)},d=new Bl(r,i,s,l);return Kw(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),je(new Se("auth-internal",e=>{let t=Cn(e.getProvider("auth").getImmediate());return(r=>new Zl(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ie(Tg,Ag,oA(n)),ie(Tg,Ag,"esm2017")}var cA=5*60,uA=qa("authIdTokenMaxAge")||cA,bg=null,lA=n=>e=>g(null,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>uA)return;let i=t?.token;bg!==i&&(bg=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function ph(n=cn()){let e=Un(n,"auth");if(e.isInitialized())return e.getImmediate();let t=oh(n,{popupRedirectResolver:r_,persistence:[t_,Yg,fh]}),r=qa("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let a=lA(s.toString());hh(t,a,()=>a(t.currentUser)),Mo(t,u=>a(u))}}let i=Ua("auth");return i?ah(t,`http://${i}`):Mn("Auth",!1),t}function hA(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}zw({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=Tn("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",hA().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});aA("Browser");function s_(n){return new en(function(e){var t=Fo(n,e.next.bind(e),e.error.bind(e),e.complete.bind(e));return{unsubscribe:t}})}var o_="auth",Sn=class{constructor(e){return e}},Ri=class{constructor(){return dr(o_)}};var mh=new Ve("angularfire2.auth-instances");function XA(n,e){let t=gi(o_,n,e);return t&&new Sn(t)}function ZA(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Sn(r)}}var eb={provide:Ri,deps:[[new Fe,mh]]},tb={provide:Sn,useFactory:XA,deps:[[new Fe,mh],wt]};function MS(n,...e){return ie("angularfire",qt.full,"auth"),xn([tb,eb,{provide:mh,useFactory:ZA(n),multi:!0,deps:[Ye,dt,$t,wn,[new Fe,fr],...e]}])}var a_=oe(s_,!0);var c_=oe(uh,!0,2);var FS=oe(ph,!0);var u_=oe(lh,!0,2);var l_=oe(dh,!0,2);var Rn=class{constructor(e){return e}},h_="firestore",gh=class{constructor(){return dr(h_)}};var _h=new Ve("angularfire2.firestore-instances");function rb(n,e){let t=gi(h_,n,e);return t&&new Rn(t)}function ib(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Rn(r)}}var sb={provide:gh,deps:[[new Fe,_h]]},ob={provide:Rn,useFactory:rb,deps:[[new Fe,_h],wt]};function LR(n,...e){return ie("angularfire",qt.full,"fst"),xn([ob,sb,{provide:_h,useFactory:ib(n),multi:!0,deps:[Ye,dt,$t,wn,[new Fe,Ri],[new Fe,fr],...e]}])}var UR=oe(Jm,!0,2);var d_=oe(Om,!0,2);var BR=oe(Ym,!0,2);var f_=oe(yl,!0,2);var qR=oe(Wm,!0);var $R=oe(Hm,!0);var jR=oe(xm,!0);var zR=oe(jm,!0,2),GR=oe(qm,!0,2);var p_=oe(Km,!0,2);var WR=oe(Qm,!0,2);var HR=oe($m,!0,2);var m_=class n{constructor(e,t,r){this.auth=e;this.firestore=t;this.router=r;this.currentUser=a_(this.auth)}currentUser;signIn(e,t){return u_(this.auth,e,t)}signOut(){return localStorage.setItem("isLoggedIn","false"),l_(this.auth).then(()=>{this.router.navigateByUrl("/home")})}signUp(e,t,r){return g(this,null,function*(){try{let i=yield c_(this.auth,e,t);return yield this.createUserData(i.user.uid,Ee(he({},r),{id:i.user.uid,email:e,camps:[]})),i}catch(i){throw console.error("Hiba a regisztr\xE1ci\xF3 sor\xE1n:",i),i}})}createUserData(e,t){return g(this,null,function*(){let r=f_(d_(this.firestore,"Users"),e);return p_(r,t)})}isLoggedIn(){return this.currentUser}updateLoginStatus(e){localStorage.setItem("isLoggedIn",e?"true":"false")}static \u0275fac=function(t){return new(t||n)(Zi(Sn),Zi(Rn),Zi($d))};static \u0275prov=On({token:n,factory:n.\u0275fac,providedIn:"root"})};var T_=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,r){this._renderer=t,this._elementRef=r}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(r){return new(r||n)(Q(Da),Q(Pa))};static \u0275dir=Pe({type:n})}return n})(),cb=(()=>{class n extends T_{static \u0275fac=(()=>{let t;return function(i){return(t||(t=Ra(n)))(i||n)}})();static \u0275dir=Pe({type:n,features:[Le]})}return n})(),Eh=new Ve("");var ub={provide:Eh,useExisting:kt(()=>A_),multi:!0};function lb(){let n=Oa()?Oa().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var hb=new Ve(""),A_=(()=>{class n extends T_{_compositionMode;_composing=!1;constructor(t,r,i){super(t,r),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!lb())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(r){return new(r||n)(Q(Da),Q(Pa),Q(hb,8))};static \u0275dir=Pe({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&is("input",function(a){return i._handleInput(a.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(a){return i._compositionEnd(a.target.value)})},standalone:!1,features:[Nt([ub]),Le]})}return n})();function wh(n){return n==null||Th(n)===0}function Th(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var vr=new Ve(""),Ir=new Ve(""),db=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,g_=class{static min(e){return fb(e)}static max(e){return pb(e)}static required(e){return mb(e)}static requiredTrue(e){return gb(e)}static email(e){return _b(e)}static minLength(e){return yb(e)}static maxLength(e){return vb(e)}static pattern(e){return Ib(e)}static nullValidator(e){return b_()}static compose(e){return k_(e)}static composeAsync(e){return N_(e)}};function fb(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function pb(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function mb(n){return wh(n.value)?{required:!0}:null}function gb(n){return n.value===!0?null:{required:!0}}function _b(n){return wh(n.value)||db.test(n.value)?null:{email:!0}}function yb(n){return e=>{let t=e.value?.length??Th(e.value);return t===null||t===0?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}function vb(n){return e=>{let t=e.value?.length??Th(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function Ib(n){if(!n)return b_;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(wh(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function b_(n){return null}function C_(n){return n!=null}function S_(n){return Bd(n)?Sa(n):n}function R_(n){let e={};return n.forEach(t=>{e=t!=null?he(he({},e),t):e}),Object.keys(e).length===0?null:e}function P_(n,e){return e.map(t=>t(n))}function Eb(n){return!n.validate}function D_(n){return n.map(e=>Eb(e)?e:t=>e.validate(t))}function k_(n){if(!n)return null;let e=n.filter(C_);return e.length==0?null:function(t){return R_(P_(t,e))}}function Ah(n){return n!=null?k_(D_(n)):null}function N_(n){if(!n)return null;let e=n.filter(C_);return e.length==0?null:function(t){let r=P_(t,e).map(S_);return Md(r).pipe(xd(R_))}}function bh(n){return n!=null?N_(D_(n)):null}function __(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function V_(n){return n._rawValidators}function O_(n){return n._rawAsyncValidators}function yh(n){return n?Array.isArray(n)?n:[n]:[]}function qo(n,e){return Array.isArray(n)?n.includes(e):n===e}function y_(n,e){let t=yh(e);return yh(n).forEach(i=>{qo(t,i)||t.push(i)}),t}function v_(n,e){return yh(e).filter(t=>!qo(n,t))}var $o=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Ah(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=bh(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},ke=class extends $o{name;get formDirective(){return null}get path(){return null}},Pn=class extends $o{_parent=null;name=null;valueAccessor=null},jo=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},wb={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},wP=Ee(he({},wb),{"[class.ng-submitted]":"isSubmitted"}),TP=(()=>{class n extends jo{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(Q(Pn,2))};static \u0275dir=Pe({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&ka("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[Le]})}return n})(),AP=(()=>{class n extends jo{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(Q(ke,10))};static \u0275dir=Pe({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&ka("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},standalone:!1,features:[Le]})}return n})();var Pi="VALID",Uo="INVALID",mr="PENDING",Di="DISABLED",Qt=class{},zo=class extends Qt{value;source;constructor(e,t){super(),this.value=e,this.source=t}},Ni=class extends Qt{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},Vi=class extends Qt{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},gr=class extends Qt{status;source;constructor(e,t){super(),this.status=e,this.source=t}},Go=class extends Qt{source;constructor(e){super(),this.source=e}},Wo=class extends Qt{source;constructor(e){super(),this.source=e}};function Ch(n){return(Jo(n)?n.validators:n)||null}function Tb(n){return Array.isArray(n)?Ah(n):n||null}function Sh(n,e){return(Jo(e)?e.asyncValidators:n)||null}function Ab(n){return Array.isArray(n)?bh(n):n||null}function Jo(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function x_(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new Br(1e3,"");if(!r[t])throw new Br(1001,"")}function M_(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new Br(1002,"")})}var _r=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return Je(this.statusReactive)}set status(e){Je(()=>this.statusReactive.set(e))}_status=rn(()=>this.statusReactive());statusReactive=nn(void 0);get valid(){return this.status===Pi}get invalid(){return this.status===Uo}get pending(){return this.status==mr}get disabled(){return this.status===Di}get enabled(){return this.status!==Di}errors;get pristine(){return Je(this.pristineReactive)}set pristine(e){Je(()=>this.pristineReactive.set(e))}_pristine=rn(()=>this.pristineReactive());pristineReactive=nn(!0);get dirty(){return!this.pristine}get touched(){return Je(this.touchedReactive)}set touched(e){Je(()=>this.touchedReactive.set(e))}_touched=rn(()=>this.touchedReactive());touchedReactive=nn(!1);get untouched(){return!this.touched}_events=new Nd;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(y_(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(y_(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(v_(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(v_(e,this._rawAsyncValidators))}hasValidator(e){return qo(this._rawValidators,e)}hasAsyncValidator(e){return qo(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(Ee(he({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Vi(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new Vi(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(Ee(he({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Ni(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new Ni(!0,r))}markAsPending(e={}){this.status=mr;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new gr(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(Ee(he({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Di,this.errors=null,this._forEachChild(i=>{i.disable(Ee(he({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new zo(this.value,r)),this._events.next(new gr(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Ee(he({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Pi,this._forEachChild(r=>{r.enable(Ee(he({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Ee(he({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Pi||this.status===mr)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new zo(this.value,t)),this._events.next(new gr(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(Ee(he({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Di:Pi}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=mr,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=S_(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new gr(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new tn,this.statusChanges=new tn}_calculateStatus(){return this._allControlsDisabled()?Di:this.errors?Uo:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(mr)?mr:this._anyControlsHaveStatus(Uo)?Uo:Pi}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new Ni(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Vi(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Jo(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=Tb(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=Ab(this._rawAsyncValidators)}},yr=class extends _r{constructor(e,t,r){super(Ch(t),Sh(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){M_(this,!0,e),Object.keys(e).forEach(r=>{x_(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,s)=>{r=t(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var vh=class extends yr{};var Oi=new Ve("",{providedIn:"root",factory:()=>Xo}),Xo="always";function Rh(n,e){return[...e.path,n]}function Ho(n,e,t=Xo){Ph(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),Cb(n,e),Rb(n,e),Sb(n,e),bb(n,e)}function Ko(n,e,t=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),Yo(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function Qo(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function bb(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Ph(n,e){let t=V_(n);e.validator!==null?n.setValidators(__(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=O_(n);e.asyncValidator!==null?n.setAsyncValidators(__(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();Qo(e._rawValidators,i),Qo(e._rawAsyncValidators,i)}function Yo(n,e){let t=!1;if(n!==null){if(e.validator!==null){let i=V_(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(a=>a!==e.validator);s.length!==i.length&&(t=!0,n.setValidators(s))}}if(e.asyncValidator!==null){let i=O_(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(a=>a!==e.asyncValidator);s.length!==i.length&&(t=!0,n.setAsyncValidators(s))}}}let r=()=>{};return Qo(e._rawValidators,r),Qo(e._rawAsyncValidators,r),t}function Cb(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&F_(n,e)})}function Sb(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&F_(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function F_(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function Rb(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function L_(n,e){n==null,Ph(n,e)}function Pb(n,e){return Yo(n,e)}function U_(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function Db(n){return Object.getPrototypeOf(n.constructor)===cb}function B_(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function q_(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(s=>{s.constructor===A_?t=s:Db(s)?r=s:i=s}),i||r||t||null}function kb(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var Nb={provide:ke,useExisting:kt(()=>Vb)},ki=Promise.resolve(),Vb=(()=>{class n extends ke{callSetDisabledState;get submitted(){return Je(this.submittedReactive)}_submitted=rn(()=>this.submittedReactive());submittedReactive=nn(!1);_directives=new Set;form;ngSubmit=new tn;options;constructor(t,r,i){super(),this.callSetDisabledState=i,this.form=new yr({},Ah(t),bh(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){ki.then(()=>{let r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),Ho(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){ki.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){ki.then(()=>{let r=this._findContainer(t.path),i=new yr({});L_(i,t),r.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){ki.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){ki.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),B_(this.form,this._directives),this.ngSubmit.emit(t),this.form._events.next(new Go(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1),this.form._events.next(new Wo(this.form))}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static \u0275fac=function(r){return new(r||n)(Q(vr,10),Q(Ir,10),Q(Oi,8))};static \u0275dir=Pe({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,i){r&1&&is("submit",function(a){return i.onSubmit(a)})("reset",function(){return i.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Nt([Nb]),Le]})}return n})();function I_(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function E_(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Bo=class extends _r{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,r){super(Ch(t),Sh(r,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Jo(t)&&(t.nonNullable||t.initialValueIsDefault)&&(E_(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){I_(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){I_(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){E_(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var Ob=n=>n instanceof Bo,xb=(()=>{class n extends ke{_parent;ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return Rh(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Ra(n)))(i||n)}})();static \u0275dir=Pe({type:n,standalone:!1,features:[Le]})}return n})();var CP=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=Pe({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})();var Dh=new Ve(""),Mb={provide:Pn,useExisting:kt(()=>Fb)},Fb=(()=>{class n extends Pn{_ngModelWarningConfig;callSetDisabledState;viewModel;form;set isDisabled(t){}model;update=new tn;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,r,i,s,a){super(),this._ngModelWarningConfig=s,this.callSetDisabledState=a,this._setValidators(t),this._setAsyncValidators(r),this.valueAccessor=q_(this,i)}ngOnChanges(t){if(this._isControlChanged(t)){let r=t.form.previousValue;r&&Ko(r,this,!1),Ho(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}U_(t,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&Ko(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_isControlChanged(t){return t.hasOwnProperty("form")}static \u0275fac=function(r){return new(r||n)(Q(vr,10),Q(Ir,10),Q(Eh,10),Q(Dh,8),Q(Oi,8))};static \u0275dir=Pe({type:n,selectors:[["","formControl",""]],inputs:{form:[0,"formControl","form"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],standalone:!1,features:[Nt([Mb]),Le,ts]})}return n})(),Lb={provide:ke,useExisting:kt(()=>$_)},$_=(()=>{class n extends ke{callSetDisabledState;get submitted(){return Je(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=rn(()=>this._submittedReactive());_submittedReactive=nn(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new tn;constructor(t,r,i){super(),this.callSetDisabledState=i,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Yo(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let r=this.form.get(t.path);return Ho(r,t,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){Ko(t.control||null,t,!1),kb(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this._submittedReactive.set(!0),B_(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new Go(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this._submittedReactive.set(!1),this.form._events.next(new Wo(this.form))}_updateDomValue(){this.directives.forEach(t=>{let r=t.control,i=this.form.get(t.path);r!==i&&(Ko(r||null,t),Ob(i)&&(Ho(i,t,this.callSetDisabledState),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let r=this.form.get(t.path);L_(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let r=this.form.get(t.path);r&&Pb(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Ph(this.form,this),this._oldForm&&Yo(this._oldForm,this)}static \u0275fac=function(r){return new(r||n)(Q(vr,10),Q(Ir,10),Q(Oi,8))};static \u0275dir=Pe({type:n,selectors:[["","formGroup",""]],hostBindings:function(r,i){r&1&&is("submit",function(a){return i.onSubmit(a)})("reset",function(){return i.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Nt([Lb]),Le,ts]})}return n})(),Ub={provide:ke,useExisting:kt(()=>j_)},j_=(()=>{class n extends xb{name=null;constructor(t,r,i){super(),this._parent=t,this._setValidators(r),this._setAsyncValidators(i)}_checkParentType(){G_(this._parent)}static \u0275fac=function(r){return new(r||n)(Q(ke,13),Q(vr,10),Q(Ir,10))};static \u0275dir=Pe({type:n,selectors:[["","formGroupName",""]],inputs:{name:[0,"formGroupName","name"]},standalone:!1,features:[Nt([Ub]),Le]})}return n})(),Bb={provide:ke,useExisting:kt(()=>z_)},z_=(()=>{class n extends ke{_parent;name=null;constructor(t,r,i){super(),this._parent=t,this._setValidators(r),this._setAsyncValidators(i)}ngOnInit(){G_(this._parent),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective?.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return Rh(this.name==null?this.name:this.name.toString(),this._parent)}static \u0275fac=function(r){return new(r||n)(Q(ke,13),Q(vr,10),Q(Ir,10))};static \u0275dir=Pe({type:n,selectors:[["","formArrayName",""]],inputs:{name:[0,"formArrayName","name"]},standalone:!1,features:[Nt([Bb]),Le]})}return n})();function G_(n){return!(n instanceof j_)&&!(n instanceof $_)&&!(n instanceof z_)}var qb={provide:Pn,useExisting:kt(()=>$b)},$b=(()=>{class n extends Pn{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new tn;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,r,i,s,a){super(),this._ngModelWarningConfig=a,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=q_(this,s)}ngOnChanges(t){this._added||this._setUpControl(),U_(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return Rh(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(r){return new(r||n)(Q(ke,13),Q(vr,10),Q(Ir,10),Q(Eh,10),Q(Dh,8))};static \u0275dir=Pe({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Nt([qb]),Le,ts]})}return n})();var W_=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=rs({type:n});static \u0275inj=Xi({})}return n})(),Ih=class extends _r{constructor(e,t,r){super(Ch(t),Sh(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){M_(this,!1,e),e.forEach((r,i)=>{x_(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,r)=>r._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function w_(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var SP=(()=>{class n{useNonNullable=!1;get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,r=null){let i=this._reduceControls(t),s={};return w_(r)?s=r:r!==null&&(s.validators=r.validator,s.asyncValidators=r.asyncValidator),new yr(i,s)}record(t,r=null){let i=this._reduceControls(t);return new vh(i,r)}control(t,r,i){let s={};return this.useNonNullable?(w_(r)?s=r:(s.validators=r,s.asyncValidators=i),new Bo(t,Ee(he({},s),{nonNullable:!0}))):new Bo(t,r,i)}array(t,r,i){let s=t.map(a=>this._createControl(a));return new Ih(s,r,i)}_reduceControls(t){let r={};return Object.keys(t).forEach(i=>{r[i]=this._createControl(t[i])}),r}_createControl(t){if(t instanceof Bo)return t;if(t instanceof _r)return t;if(Array.isArray(t)){let r=t[0],i=t.length>1?t[1]:null,s=t.length>2?t[2]:null;return this.control(r,i,s)}else return this.control(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=On({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var RP=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Oi,useValue:t.callSetDisabledState??Xo}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=rs({type:n});static \u0275inj=Xi({imports:[W_]})}return n})(),PP=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Dh,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:Oi,useValue:t.callSetDisabledState??Xo}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=rs({type:n});static \u0275inj=Xi({imports:[W_]})}return n})();export{lC as a,hC as b,MS as c,FS as d,Om as e,qm as f,$m as g,Hm as h,Rn as i,LR as j,UR as k,d_ as l,BR as m,f_ as n,qR as o,$R as p,jR as q,zR as r,GR as s,WR as t,HR as u,m_ as v,Eh as w,A_ as x,vr as y,g_ as z,Pn as A,TP as B,AP as C,yr as D,Vb as E,Bo as F,CP as G,Fb as H,$_ as I,j_ as J,$b as K,SP as L,RP as M,PP as N};
